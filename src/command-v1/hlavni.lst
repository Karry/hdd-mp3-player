MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;   HLAVNI SOUBOR 
                      00002 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00003 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00004 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00005 ;  displej k MP3 PREPRCAVACi
                      00006 ; ================
                      00007 ; 
                      00008 ; prosinec 2005 - brezen 2006 Boga
                      00009 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00010 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00011 
                      00012 
                      00013 ;**********************************************************
                      00014 ;   VERZE 0.3
                      00015 ;**********************************************************
                      00016         LIST            p=PIC16f877,C=132,n=60
2007   3F3A           00017         __CONFIG        _WDT_OFF & _HS_OSC & _PWRTE_OFF & _BODEN_OFF & _LVP_OFF 
                      00018                         ; LVP_OFF = RB3 jako digitalni I/O
                      00019         errorlevel -302 ; vypnuti Message [302]: Register in operand not in bank 0.
                      00020         errorlevel -306 ; vypnuti Message[306] : Crossing page boundary -- ensure page bits are set.
                      00021                                                 ; ! zjednoduseni vypisu, ale riziko prehlednuti chyby
                      00022 ;**********************************************************
                      00023         include "eeprom.inc"    ; definice blbosti kolem procesoru
                      00001         ; znak0 = 40h   á
                      00002         ; znak1 = 48h   í
                      00003         ; znak2 = 50h   e s hackem
                      00004         ; znak3 = 58h   š
                      00005         ; znak4 = 60h   c s hackem
                      00006         ; znak5 = 68h   r s hackem
                      00007         ; znak6 = 70h   z s hackem
                      00008         ; znak7 = 78h   ý
                      00009 
                      00010 ; prevodni tabulka pro vypisovani na LCD
                      00011 ; snaky s diakritikou se prevadeji na nediakriticke 
                      00012 ; (krome 8 uzivatelsky definovanych v LCD)
                      00013 ; .0    -> h'FF'        / konec retezce
                      00014 ; .193  -> h'00'        / velke A s carkou
                      00015 ; .225  -> h'00'        / male a s carkou
                      00016 
2100                  00017         org     0x2100          ; tabulka v pameti EEPROM (256 bytu)
2100   00FF 0001 0002 00018         de      0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07
       0003 0004 0005 
       0006 0007 
2108   0008 0009 000A 00019         de      0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F
       000B 000C 000D 
       000E 000F 
2110   0010 0011 0012 00020         de      0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17
       0013 0014 0015 
       0016 0017 
2118   0018 0019 001A 00021         de      0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F
       001B 001C 001D 
       001E 001F 
2120   0020 0021 0022 00022         de      0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27
       0023 0024 0025 
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       0026 0027 
2128   0028 0029 002A 00023         de      0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F
       002B 002C 002D 
       002E 002F 
2130   0030 0031 0032 00024         de      0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37
       0033 0034 0035 
       0036 0037 
2138   0038 0039 003A 00025         de      0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F
       003B 003C 003D 
       003E 003F 
                      00026 
2140   0040 0041 0042 00027         de      0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47
       0043 0044 0045 
       0046 0047 
2148   0048 0049 004A 00028         de      0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F
       004B 004C 004D 
       004E 004F 
2150   0050 0051 0052 00029         de      0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57
       0053 0054 0055 
       0056 0057 
2158   0058 0059 005A 00030         de      0x58, 0x59, 0x5A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F
       005B 005C 005D 
       005E 005F 
2160   0060 0061 0062 00031         de      0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67
       0063 0064 0065 
       0066 0067 
2168   0068 0069 006A 00032         de      0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F
       006B 006C 006D 
       006E 006F 
2170   0070 0071 0072 00033         de      0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77
       0073 0074 0075 
       0076 0077 
2178   0078 0079 007A 00034         de      0x78, 0x79, 0x7A, 0x7B, 0x7C, 0x7D, 0xDE, 0x7F
       007B 007C 007D 
       00DE 007F 
                      00035 
2180   0080 0081 0082 00036         de      0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87
       0083 0084 0085 
       0086 0087 
2188   0088 0089 0003 00037         de      0x88, 0x89, 0x03, 0x8B, 0x8C, 0x8D, 0x06, 0x8F
       008B 008C 008D 
       0006 008F 
2190   0090 0091 0092 00038         de      0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97
       0093 0094 0095 
       0096 0097 
2198   0098 0099 0003 00039         de      0x98, 0x99, 0x03, 0x9B, 0x9C, 0x9D, 0x06, 0x9F
       009B 009C 009D 
       0006 009F 
21A0   00A0 00A1 00A2 00040         de      0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7
       00A3 00A4 00A5 
       00A6 00A7 
21A8   00A8 00A9 00AA 00041         de      0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF
       00AB 00AC 00AD 
       00AE 00AF 
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

21B0   00B0 00B1 00B2 00042         de      0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7
       00B3 00B4 00B5 
       00B6 00B7 
21B8   00B8 00B9 00BA 00043         de      0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF
       00BB 00BC 00BD 
       00BE 00BF 
                      00044 
21C0   00C0 0000 00C2 00045         de      0xC0, 0x00, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7
       00C3 00C4 00C5 
       00C6 00C7 
21C8   0004 0045 00CA 00046         de      0x04, 'E' , 0xCA, 0xCB, 0x02, 0x01, 0xCE, 'D' 
       00CB 0002 0001 
       00CE 0044 
21D0   00D0 00D1 004E 00047         de      0xD0, 0xD1, 'N' , 'O' , 0xD4, 0xD5, 0xD6, 0xD7
       004F 00D4 00D5 
       00D6 00D7 
21D8   0005 0055 0055 00048         de      0x05, 'U' , 'U' , 0xDB, 0xDC, 0x07, 0xDE, 0xDF
       00DB 00DC 0007 
       00DE 00DF 
21E0   00E0 0000 00E2 00049         de      0xE0, 0x00, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7
       00E3 00E4 00E5 
       00E6 00E7 
21E8   0004 0065 00EA 00050         de      0x04, 'e' , 0xEA, 0xEB, 0x02, 0x01, 0xEE, 'd' 
       00EB 0002 0001 
       00EE 0064 
21F0   00F0 00F1 006E 00051         de      0xF0, 0xF1, 'n' , 'o' , 0xF4, 0xF5, 0xF6, 0xF7
       006F 00F4 00F5 
       00F6 00F7 
21F8   0005 0075 0075 00052         de      0x05, 'u' , 'u' , 0xFB, 0xFC, 0x07, 0xFE, 0xFF
       00FB 00FC 0007 
       00FE 00FF 
                      00024         include "P16F877A.inc"  ; definice blbosti kolem procesoru
                      00001         LIST
                      00002 ; P16F877A.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
                      00398         LIST
                      00025         include "displej.inc"   ; definice promennych, konstant a portu
                      00001 ; roznmisteni pameti:
                      00002 ;       0. banka -> funkcni promenne
                      00003 ;       1. banka -> nic
                      00004 ;       2. banka -> buffer2 (na dlouha jmena souboru pri prehravani)
                      00005 ;       3. banka -> buffer1 (na dlouha jmena adresaru pri prehravani,
                      00006 ;                                               jmena oddilu a jine veci...)
                      00007 ;XXXXXXXXXXXXXXXX DEFINICE VLASTNICH PROMENNYCH
                      00008 ; pomocne promenne (pro casove smycky a jine kokotiny...)
  00000020            00009 TMP0                    equ 0X020
  00000021            00010 TMP1                    equ 0X021
  00000023            00011 TMP2                    equ 0X023
  00000024            00012 TMP3                    equ 0X024
  00000025            00013 TMP4                    equ 0X025
  00000026            00014 TMP5                    equ 0X026
                      00015 ; stavove promenne (zda se neco prehrava, zda je nactena FATka a podobne...)
  00000027            00016 AKTUAL_HLAS             equ 0x027       ; aktualni hlasitost prehravace (255 je maximalni hlasitost)
  00000028            00017 STAV                    equ 0x028       ; stav prehravace
                      00018                 ; 7. bit = 1 => je nactena FATka
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00019                 ; 6. bit = 1 => doslo k preruseni od TMR1 (kazdych 5ms) tento bit pouzivat pouze v TEST_
                            TLAC
                      00020                 ; 5:4   => nastaveni podsviceni
                      00021                 ;       00      - podsviceni vypnuto
                      00022                 ;       01      - podsviceni zapnuto porad
                      00023                 ;       11      - podsviceni blika 50Hz
                      00024                 ; 3. bit = 1 => pri zmene hlasitosti se vypise hlasitost na LCD (v menu je tedy dobre te
                            nto bit vynulovat)
                      00025                 ; 2. bit = 1 => je zobrazen odehrany cas mp3 (kvuli tomu, aby mohl cas pri pauze blikat)
  00000029            00026 PREH_STAV0              equ 0x029       ; stav prehravani (vis. dokumentace komunikace)
  0000002A            00027 PREH_STAV1              equ 0x02A
                      00028 
  0000002B            00029 PREH_ADR_CL1    equ 0X02B
  0000002C            00030 PREH_ADR_CL2    equ 0X02C
  0000002D            00031 PREH_ADR_CL3    equ 0X02D
  0000002E            00032 PREH_ADR_CL4    equ 0X02E
  0000002F            00033 PREH_SOUB_1             equ 0X02F
  00000030            00034 PREH_SOUB_2             equ 0X030       ; adresa souboru, ktery prave hraje
                      00035 
  00000031            00036 CASOVAC                 equ 0X031       ; tento registr se kazdych 5ms dekrementuje 
                      00037                                                         ; (kdyz dosahne hodnoty 0, derkementovani presta
                            ne)
                      00038 
  00000032            00039 VTERINY1                equ 0X032
  00000033            00040 VTERINY2                equ 0X033
  00000034            00041 MINUTY1                 equ 0X034
  00000035            00042 MINUTY2                 equ 0X035       ; odehrany cas mp3
                      00043 
  00000036            00044 COUNTER                 equ 0X036
  00000037            00045 PRETECENI               equ 0X037
  00000038            00046 VYSLEDEK1               equ 0X038
  00000039            00047 VYSLEDEK2               equ 0X039
                      00048 
  0000003A            00049 EKVALIZER               equ 0x03A
                      00050 ;                               equ 0x03B
                      00051 ;                               equ 0x03C
                      00052 ;                               equ 0x03D
                      00053 ;                               equ 0x03E
                      00054 ;                               equ 0x03F
                      00055 
  00000040            00056 POMOCNA1                equ 0X040
  00000041            00057 POMOCNA2                equ 0X041       ; REGISTRY PRO ARITMETICKE OPERACE
                      00058 
  00000042            00059 ZAC_ZOB_SOUB    equ 0x042
  00000043            00060 ZAC_ZOB_ADR             equ 0x043       ; od kolikateho znaku se zobrazuji rolovane nazvy
                      00061 
  00000044            00062 TLACITKA                equ 0x044       
                      00063                 ; aby drzeni tlacitka nebylo brano jako nekolik stisku je stav tlacitek 
                      00064                 ; testovan pomoci tohoto registru. O nastaveni jeho bitu se stara podprogram TEST_TLAC. 
                      00065                 ; (ktery take resi tlac. hlasitosti) Obsluha tlacitek je pak provadena podle situace.
                      00066                 ; bity museji byt mazany po obslouzeni
                      00067                 ; 7. bit - play
                      00068                 ; 6. bit - stop
                      00069                 ; 5. bit - previjeni dopredu
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00070                 ; 4. bit - previjeni dozadu
                      00071                 ; 3. bit - [nepouzit]
                      00072                 ; 2. bit - menu
                      00073                 ; 1. bit - menu up
                      00074                 ; 0. bit - menu down
  00000045            00075 TLACITKA_PRED   equ 0x045       ; stav tlacitek pri predchozim testovanim. 
                      00076                                                         ; pokud nekter bit vynulujeme, muze byt podrzeni
                             tlacitka brano 
                      00077                                                         ; jako nekolik stisku
                      00078 
                      00079 ; registry pro uchovavani informaci pri prochazeni slozkami
  00000046            00080 PROCHAZENY_ADR1 equ 0x046
  00000047            00081 PROCHAZENY_ADR2 equ 0x047
  00000048            00082 PROCHAZENY_ADR3 equ 0x048
  00000049            00083 PROCHAZENY_ADR4 equ 0x049
                      00084 
  0000004A            00085 AKTUALNI_ZAZNAM1 equ 0x04A
  0000004B            00086 AKTUALNI_ZAZNAM2 equ 0x04B
                      00087 
  0000004C            00088 ZPUSOB                  equ 0x04C               ; 0 - hledame dolu
                      00089                                                                 ; 1 - hledame nahoru
                      00090 ;                               equ 0x04D
                      00091 ;                               equ 0x04E
                      00092 ;                               equ 0x04F
                      00093 
  00000050            00094 ZAZNAM1_TYP             equ 0x050               ; poloha techto registru se nemi menit !!!!!!
  00000051            00095 ZAZNAM1_CL1             equ 0x051               ; je k nim pristupovano pres neprime adresovani
  00000052            00096 ZAZNAM1_CL2             equ 0x052
  00000053            00097 ZAZNAM1_CL3             equ 0x053
  00000054            00098 ZAZNAM1_CL4             equ 0x054
  00000055            00099 ZAZNAM1_CIS1    equ 0x055
  00000056            00100 ZAZNAM1_CIS2    equ 0x056
                      00101 ;                               equ 0x057
                      00102 
  00000058            00103 ZAZNAM2_TYP             equ 0x058
  00000059            00104 ZAZNAM2_CL1             equ 0x059
  0000005A            00105 ZAZNAM2_CL2             equ 0x05A
  0000005B            00106 ZAZNAM2_CL3             equ 0x05B
  0000005C            00107 ZAZNAM2_CL4             equ 0x05C
  0000005D            00108 ZAZNAM2_CIS1    equ 0x05D
  0000005E            00109 ZAZNAM2_CIS2    equ 0x05E
                      00110 ;                               equ 0x05F
                      00111 
  00000060            00112 ZAZNAM3_TYP             equ 0x060
  00000061            00113 ZAZNAM3_CL1             equ 0x061
  00000062            00114 ZAZNAM3_CL2             equ 0x062
  00000063            00115 ZAZNAM3_CL3             equ 0x063
  00000064            00116 ZAZNAM3_CL4             equ 0x064
  00000065            00117 ZAZNAM3_CIS1    equ 0x065
  00000066            00118 ZAZNAM3_CIS2    equ 0x066
                      00119 
  00000067            00120 ADRESAR1                equ 0x067
  00000068            00121 ADRESAR2                equ 0x068
  00000069            00122 ADRESAR3                equ 0x069
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000006A            00123 ADRESAR4                equ 0x06A
  0000006B            00124 ZAZNAM1                 equ 0x06B
  0000006C            00125 ZAZNAM2                 equ 0x06C
  0000006D            00126 AUDATA1                 equ 0x06D
  0000006E            00127 AUDATA2                 equ 0x06E
                      00128 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00129 ; registry pro potreby preruseni
  00000070            00130 TEMP_WORKING    equ 0x070
  00000071            00131 TEMP_STATUS             equ 0x071
  00000072            00132 TEMP_FSR                equ 0x072
  00000073            00133 TEMP_PCLATH             equ 0x073
                      00134 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00135 ;DEFINICE BITÙ K DISPLEJI A TLACITEK
                      00136 #DEFINE LCD_RS                  PORTB,2
                      00137 #DEFINE LCD_RW                  PORTB,1
                      00138 #DEFINE LCD_ENABLE              PORTB,0
                      00139 #DEFINE LCD_PODSVICENI  PORTC,5
                      00140 #DEFINE TL_PODSVICENI   PORTC,4
                      00141 #DEFINE TL_PLAY                 PORTA,1
                      00142 #DEFINE TL_STOP                 PORTA,2
                      00143 #DEFINE TL_DOPREDU              PORTA,3
                      00144 #DEFINE TL_DOZADU               PORTA,0
                      00145 #DEFINE TL_VOLUME_UP    PORTA,4
                      00146 #DEFINE TL_VOLUME_DOWN  PORTA,5
                      00147 #DEFINE TL_MENU                 PORTE,1
                      00148 #DEFINE TL_MENU_UP              PORTE,0
                      00149 #DEFINE TL_MENU_DOWN    PORTE,2
                      00150 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00151 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00152 ; MAKRA
                      00153 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00154 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00155 BANK_0  macro                                   ; prepnuti do banky 0 v pameti dat
                      00156                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
                      00157                 bcf     STATUS,RP0    
                      00158                 endm
                      00159 BANK_1  macro                                   ; prepnuti do banky 1 v pameti dat
                      00160                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
                      00161                 bsf     STATUS,RP0    
                      00162                 endm
                      00163 BANK_2  macro                                   ; prepnuti do banky 2 v pameti dat
                      00164                 bsf     STATUS,RP1              ; BANK2  RP1:RP0 = 10
                      00165                 bcf     STATUS,RP0    
                      00166                 endm
                      00167 BANK_3  macro                                   ; prepnuti do banky 3 v pameti dat
                      00168                 bsf     STATUS,RP1              ; BANK3  RP1:RP0 = 11
                      00169                 bsf     STATUS,RP0    
                      00170                 endm
                      00171 ; INDF_BANK_x slouzi k prepinani bank pro neprime adresovani pomoci INDF a FSR
                      00172 INDF_BANK_0     macro               
                      00173                         bcf STATUS,IRP    
                      00174                         endm
                      00175 INDF_BANK_1     macro               
                      00176                         bcf STATUS,IRP    
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00177                         endm
                      00178 INDF_BANK_2     macro             
                      00179                         bsf STATUS,IRP    
                      00180                         endm
                      00181 INDF_BANK_3     macro             
                      00182                         bsf STATUS,IRP    
                      00183                         endm
                      00184 ;**********************************************************
                      00185 PROG_PAGE_0     macro             
                      00186                         bcf PCLATH,3
                      00187                         bcf PCLATH,4
                      00188                         endm
                      00189 PROG_PAGE_1     macro             
                      00190                         bsf PCLATH,3
                      00191                         bcf PCLATH,4
                      00192                         endm
                      00193 PROG_PAGE_2     macro             
                      00194                         bcf PCLATH,3
                      00195                         bsf PCLATH,4
                      00196                         endm
                      00197 PROG_PAGE_3     macro             
                      00198                         bsf PCLATH,3
                      00199                         bsf PCLATH,4
                      00200                         endm
                      00201 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00026 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00027 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00028 ; PROGRAM
                      00029 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00030 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00031 ;**********************************************************
0010                  00032  org 0x0010
                      00033         include "lcd.asm"               ; podprogramy pro praci s LCD
                      00001 ;*******************************************************************************************************
                            *************
                      00002 ; RUTINY PRO PRACI S LCD
                      00003 ;*******************************************************************************************************
                            *************
0010                  00004 INIT_LCD
0010   21A0           00005         call ZPOZ_20MS
0011   2025           00006         call INIT8B
0012   21A0           00007         call ZPOZ_20MS
0013   2025           00008         call INIT8B
0014   21A0           00009         call ZPOZ_20MS
0015   2025           00010         call INIT8B
0016   21A0           00011         call ZPOZ_20MS
0017   2025           00012         call INIT8B
0018   21A0           00013         call ZPOZ_20MS
0019   2025           00014         call INIT8B
                      00015 
001A   203E           00016         call CZ_INI
                      00017 
001B   3006           00018         movlw b'00000110' 
001C   208B           00019         call ZAPISI
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001D   3001           00020         movlw b'00000001' 
001E   208B           00021         call ZAPISI
001F   218A           00022         CALL ZPOZ_2MS
0020   0008           00023         return
                      00024 ;*******************************************************************************************************
                            *************
0021                  00025 SMAZ_LCD
0021   3001           00026         movlw b'00000001' 
0022   208B           00027         call ZAPISI
0023   218A           00028         CALL ZPOZ_2MS
0024   0008           00029         return
                      00030 ;*******************************************************************************************************
                            *************
0025                  00031 INIT8B: 
0025   3038           00032         movlw   b'00111000'     ; 8 - bit
0026   208B           00033         call    ZAPISI
0027   300F           00034         movlw   b'00001111'     ; LCD on, kurzor on, blik 
0028   300C           00035         movlw   b'00001100'     ; LCD on, kurzor off,no blik 
0029   208B           00036         call    ZAPISI
002A   0008           00037         return
                      00038 ;*******************************************************************************************************
                            *************
002B                  00039 LCD_SMAZ_RADEK
002B   3014           00040         movlw .20
002C   00A1           00041         movwf TMP1
002D   3020           00042         movlw ' '
002E   20A8           00043         call ZAPISD
002F   0BA1           00044         decfsz TMP1,f
0030   282D           00045         goto $-3        
0031   0008           00046         return
                      00047 ;*******************************************************************************************************
                            *************
0032                  00048 LCD_1RADEK
0032   3080           00049         movlw h'80'             ; adresa 00h - 0
0033   208B           00050         call ZAPISI
0034   0008           00051         return
                      00052 ;*******************************************************************************************************
                            *************
0035                  00053 LCD_2RADEK
0035   30AA           00054         movlw h'AA'             ; adresa 2Ah - 42
0036   208B           00055         call ZAPISI
0037   0008           00056         return
                      00057 ;**********************************************************
0038                  00058 LCD_3RADEK
0038   3094           00059         movlw h'94'             ; adresa 10h - 16
0039   208B           00060         call ZAPISI
003A   0008           00061         return
                      00062 ;**********************************************************
003B                  00063 LCD_4RADEK
003B   30D4           00064         movlw h'd4'             ; adresa 50h - 80
003C   208B           00065         call ZAPISI
003D   0008           00066         return
                      00067 ;**********************************************************
003E                  00068 CZ_INI  
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003E   01A4           00069         clrf    TMP3            ; cislo bytu, ktery jsme naplnily do uzivatelske pameti LCD
003F   3040           00070         movlw   0x40            ; prvni adresa znaku v LCD displeji
0040   208B           00071         call    ZAPISI
0041                  00072 CZ_INI_2        
0041   0824           00073         movf    TMP3,W
0042   204A           00074         call    TAB_CZ
0043   20A8           00075         call    ZAPISD
0044   0AA4           00076         incf    TMP3,F
0045   3040           00077         movlw   0x40            ; až ADRESA dosáhne 40h tak je konec
0046   0224           00078         subwf   TMP3,W
0047   1D03           00079         btfss   STATUS,Z
0048   2841           00080         goto    CZ_INI_2
                      00081 
0049   0008           00082         return
                      00083 ;**********************************************************
004A                  00084 TAB_CZ  
004A   0782           00085         addwf   PCL,F           ; definování ceských znaku pro LCD
                      00086 
                      00087         ; znak0 = 40h   á
004B   3402           00088         retlw   0x02    ; '      X '
004C   3404           00089         retlw   0x04    ; '     X  '
004D   341E           00090         retlw   0x1E    ; '   XXXX '
004E   3401           00091         retlw   0x01    ; '       X'
004F   340F           00092         retlw   0x0F    ; '    XXXX'
0050   3411           00093         retlw   0x11    ; '   X   X'
0051   340F           00094         retlw   0x0F    ; '    XXXX'
0052   3400           00095         retlw   0x00    ; '        '
                      00096         
                      00097         ; znak1 = 48h   í
0053   3402           00098         retlw   0x02    ; '      X '
0054   3404           00099         retlw   0x04    ; '     X  '
0055   340C           00100         retlw   0x0C    ; '    XX  '
0056   3404           00101         retlw   0x04    ; '     X  '
0057   3404           00102         retlw   0x04    ; '     X  '
0058   3404           00103         retlw   0x04    ; '     X  '
0059   340E           00104         retlw   0x0E    ; '    XXX '
005A   3400           00105         retlw   0x00    ; '        '
                      00106 
                      00107         ; znak2 = 50h   e s hackem
005B   340A           00108         retlw   0x0A    ; '    X X '
005C   3404           00109         retlw   0x04    ; '     X  '
005D   340E           00110         retlw   0x0E    ; '    XXX '
005E   3411           00111         retlw   0x11    ; '   X   X'
005F   341F           00112         retlw   0x1F    ; '   XXXXX'
0060   3410           00113         retlw   0x10    ; '   X    '
0061   340E           00114         retlw   0x0E    ; '    XXX '
0062   3400           00115         retlw   0x00    ; '        '
                      00116 
                      00117         ; znak3 = 58h   š
0063   340A           00118         retlw   0x0A    ; '    X X '
0064   3404           00119         retlw   0x04    ; '     X  '
0065   340E           00120         retlw   0x0E    ; '    XXX '
0066   3410           00121         retlw   0x10    ; '   X    '
0067   340E           00122         retlw   0x0E    ; '    XXX '
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0068   3401           00123         retlw   0x01    ; '       X'
0069   341E           00124         retlw   0x1E    ; '   XXXX '
006A   3400           00125         retlw   0x00    ; '        '
                      00126 
                      00127         ; znak4 = 60h   c s hackem
006B   340A           00128         retlw   0x0A    ; '    X X '
006C   3404           00129         retlw   0x04    ; '     X  '
006D   340E           00130         retlw   0x0E    ; '    XXX '
006E   3410           00131         retlw   0x10    ; '   X    '
006F   3410           00132         retlw   0x10    ; '   X    '
0070   3411           00133         retlw   0x11    ; '   X   X'
0071   340E           00134         retlw   0x0E    ; '    XXX '
0072   3400           00135         retlw   0x00    ; '        '
                      00136 
                      00137         ; znak5 = 68h   r s hackem
0073   340A           00138         retlw   0x0A    ; '    X X '
0074   3404           00139         retlw   0x04    ; '     X  '
0075   3416           00140         retlw   0x16    ; '   X XX '
0076   3419           00141         retlw   0x19    ; '   XX  X'
0077   3410           00142         retlw   0x10    ; '   X    '
0078   3410           00143         retlw   0x10    ; '   X    '
0079   3410           00144         retlw   0x10    ; '   X    '
007A   3400           00145         retlw   0x00    ; '        '
                      00146 
                      00147         ; znak6 = 70h   z s hackem
007B   340A           00148         retlw   0x0A    ; '    X X '
007C   3404           00149         retlw   0x04    ; '     X  '
007D   341F           00150         retlw   0x1F    ; '   XXXXX'
007E   3402           00151         retlw   0x02    ; '      X '
007F   3404           00152         retlw   0x04    ; '     X  '
0080   3408           00153         retlw   0x08    ; '    X   '
0081   341F           00154         retlw   0x1F    ; '   XXXXX'
0082   3400           00155         retlw   0x00    ; '        '
                      00156 
                      00157         ; znak7 = 78h   ý
0083   3402           00158         retlw   0x02    ; '      X '
0084   3404           00159         retlw   0x04    ; '     X  '
0085   3411           00160         retlw   0x11    ; '   X   X'
0086   3411           00161         retlw   0x11    ; '   X   X'
0087   340F           00162         retlw   0x0F    ; '    XXXX'
0088   3401           00163         retlw   0x01    ; '       X'
0089   340E           00164         retlw   0x0E    ; '    XXX '
008A   3400           00165         retlw   0x00    ; '        '
                      00166 ;************************************************
008B                  00167 ZAPISI  
                      00168         ; krystal 20MHz => instrukce = 200ns
008B   1106           00169         BCF LCD_RS                      ; RS na  RB2 je 0 - instrukce
008C   1086           00170         BCF LCD_RW                      ; R/W na RB1 je 0 - zapis
008D   0000           00171         nop                                     ; Tas min 140ns
008E   0088           00172         MOVWF   PORTD
008F   0000           00173         nop
0090   0000           00174         nop
0091   0000           00175         nop
0092   0000           00176         nop
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0093   0000           00177         nop
0094   0000           00178         nop
0095   0000           00179         nop
0096   0000           00180         nop
0097   0000           00181         nop
0098   0000           00182         nop
0099   1406           00183         BSF LCD_ENABLE
009A   0000           00184         NOP
009B   0000           00185         NOP
009C   0000           00186         nop
009D   0000           00187         nop
009E   0000           00188         NOP                                     ; ENABLE slespon 450ns v log1
009F   1006           00189         bcf LCD_ENABLE
00A0   0000           00190         NOP
00A1   0000           00191         NOP
00A2   0000           00192         nop
00A3   0000           00193         nop
00A4   0000           00194         NOP
00A5   1406           00195         bsf LCD_ENABLE
                      00196 
00A6   21B2           00197         CALL ZPOZ_50US      ; zpozdeni 50 uS na vykonani instrukce
00A7   0008           00198         RETURN
                      00199 ;**********************************************************
00A8                  00200 ZAPISD  
                      00201         ; krystal 20MHz => instrukce = 200ns
00A8   1506           00202         BSF LCD_RS                      ; RS na  RB2 je 1 - DATA
00A9   1086           00203         BCF LCD_RW                      ; R/W na RB1 je 0 - zapis
00AA   0000           00204         nop                                     ; Tas min 140ns
00AB   0088           00205         MOVWF   PORTD
00AC   0000           00206         nop
00AD   0000           00207         nop
00AE   0000           00208         nop
00AF   0000           00209         nop
00B0   0000           00210         nop
00B1   0000           00211         nop
00B2   0000           00212         nop
00B3   0000           00213         nop
00B4   0000           00214         nop
00B5   0000           00215         nop
00B6   1406           00216         BSF LCD_ENABLE
00B7   0000           00217         NOP
00B8   0000           00218         NOP
00B9   0000           00219         nop
00BA   0000           00220         nop
00BB   0000           00221         NOP                                     ; ENABLE slespon 450ns v log1
00BC   1006           00222         bcf LCD_ENABLE
00BD   0000           00223         NOP
00BE   0000           00224         NOP
00BF   0000           00225         nop
00C0   0000           00226         nop
00C1   0000           00227         NOP
                      00228         ;bsf LCD_ENABLE
                      00229 
00C2   21B2           00230         CALL ZPOZ_50US      ; zpozdeni 50 uS na zapis data
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C3   0008           00231         RETURN
                      00232 ;**********************************************************
                      00034         include "displej.asm"   ; hlavni programova smycka
                      00001         ; znak0 = 40h   á
                      00002         ; znak1 = 48h   í
                      00003         ; znak2 = 50h   e s hackem
                      00004         ; znak3 = 58h   š
                      00005         ; znak4 = 60h   c s hackem
                      00006         ; znak5 = 68h   r s hackem
                      00007         ; znak6 = 70h   z s hackem
                      00008         ; znak7 = 78h   ý
00C4                  00009 START
00C4   2106           00010         CALL INIT_CONFIG        ; nakonfiguruje preruseni, USART, pull ups...
00C5   20F7           00011         call INIT_PORT          ; konfigurace vstupu a vystupu (trisy)
00C6   2010           00012         call INIT_LCD           ; init LCD displeje (vcetne definovani 8 ceskych znaku)
                      00013 
00C7   081A           00014         movfw RCREG                     ; 
00C8   081A           00015         movfw RCREG                     ; vyprazdnime buffer usartu (po zapnuti obcas prijme nejakou blb
                            ost)
                      00016 
00C9   2210           00017         call HLASKA_PREPRCAVAC
00CA   223A           00018         call HLASKA_AUTORI
00CB   217D           00019         call ZPOZ_1S
00CC   217D           00020         call ZPOZ_1S
00CD   2021           00021         call SMAZ_LCD
00CE   2210           00022         call HLASKA_PREPRCAVAC
00CF   225E           00023         call HLASKA_DISK
00D0   230D           00024         call JMENODISKU
00D1   217D           00025         call ZPOZ_1S
                      00026 
00D2   21C7           00027         call NACTIODDILY
00D3   0825           00028         movfw TMP4
00D4   3C01           00029         sublw .1
00D5   1903           00030         btfsc STATUS,Z
00D6   28DA           00031         goto $+4
00D7   2510           00032         call VYBER_ODDILU
00D8   17A8           00033         bsf STAV,7
00D9   28E0           00034         goto ODDIL_JE_NACTEN
00DA   21ED           00035         CALL NASTAVODDIL                        ; pokud je na disku pouze jeden oddil, nastavime ten prv
                            ni
00DB   1BA8           00036         BTFSC STAV,7
00DC   28E0           00037         goto ODDIL_JE_NACTEN
00DD   22F0           00038         CALL HLASKA_CHYBAODDILU
00DE   0000           00039         nop
00DF   28DE           00040         goto $-1
00E0                  00041 ODDIL_JE_NACTEN
00E0   24FC           00042         call ZAKLADNI_NASTAVENI  
                      00043 
                      00044         INDF_BANK_3
00E1   1783               M                         bsf STATUS,IRP    
00E2   3091           00045         movlw 0x91
00E3   0084           00046         movwf FSR
00E4   3052           00047         movlw 'R'
00E5   0080           00048         movwf INDF
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00E6   0A84           00049         incf FSR,f
00E7   304F           00050         movlw 'O'
00E8   0080           00051         movwf INDF
00E9   0A84           00052         incf FSR,f
00EA   304F           00053         movlw 'O'
00EB   0080           00054         movwf INDF
00EC   0A84           00055         incf FSR,f
00ED   3054           00056         movlw 'T'
00EE   0080           00057         movwf INDF
00EF   0A84           00058         incf FSR,f
00F0   30FF           00059         movlw h'FF'
00F1   0080           00060         movwf INDF
                      00061         ; nastaveni jmena zakladniho adresare
00F2   01AB           00062         clrf PREH_ADR_CL1
00F3   01AC           00063         clrf PREH_ADR_CL2
00F4   01AD           00064         clrf PREH_ADR_CL3
00F5   01AE           00065         clrf PREH_ADR_CL4
                      00066 
00F6   2D8F           00067         goto PRUZKUMNIK
                      00068 
                      00069 ;       nop
                      00070 ;       goto $-1
                      00071 ;;;;;;;;;;;;;;;;;;;;;;;;;
                      00072 ;       movlw h'80'             ; prikaz pro prime hrani mp3
                      00073 ;       CALL WR_USART
                      00074 ;       movlw h'02'
                      00075 ;       CALL WR_USART
                      00076 ;       movlw h'00'
                      00077 ;       CALL WR_USART
                      00078 ;       movlw h'00'
                      00079 ;       CALL WR_USART
                      00080 ;       movlw h'00'
                      00081 ;       CALL WR_USART
                      00082 ;       movlw h'48'
                      00083 ;       CALL WR_USART
                      00084 ;       movlw h'00'
                      00085 ;       CALL WR_USART
                      00086 ;       CALL RD_USART
                      00087 ;;;;;;;;;;;;;;;;;;;;;;;;;
                      00088 ;       goto PREHRAVANI
                      00089 ;*******************************************************************************************************
                            *************
                      00090 ; CEKACI SMYCKY
                      00091 ;       call ZPOZ_1S
                      00092 ;       call ZPOZ_300MS
                      00093 ;       call ZPOZ_100US
                      00094 ;       call ZPOZ_10US
                      00095 ;*******************************************************************************************************
                            *************
00F7                  00096 INIT_PORT
                      00097         BANK_1
00F7   1303               M                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
00F8   1683               M                 bsf     STATUS,RP0    
00F9   30FF           00098         MOVLW 0xff
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00FA   0085           00099         MOVWF TRISA
00FB   30F8           00100         MOVLW B'11111000'
00FC   0086           00101     MOVWF TRISB
00FD   30CF           00102         MOVLW B'11001111'
00FE   0087           00103         MOVWF TRISC
00FF   3000           00104         MOVLW B'00000000'
0100   0088           00105         MOVWF TRISD
0101   3003           00106         MOVLW 0x03
0102   0089           00107         MOVWF TRISE
                      00108         BANK_0
0103   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
0104   1283               M                 bcf     STATUS,RP0    
0105   0008           00109         RETURN
                      00110 ;**********************************************************
0106                  00111 INIT_CONFIG     ; nakonfiguruje preruseni, WDT, USART, pull ups....
0106   3001           00112         MOVLW b'00000001'       ; 
0107   0090           00113         MOVWF T1CON                     ; 
                      00114 
0108   30FF           00115         movlw h'FF'
0109   008F           00116         movwf TMR1H
010A   018E           00117         clrf TMR1L
                      00118 
                      00119         BANK_1
010B   1303               M                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
010C   1683               M                 bsf     STATUS,RP0    
010D   140C           00120         BSF PIE1, TMR1IE        ; Enable Timer1 interrupt
010E   178B           00121         BSF INTCON,GIE
010F   170B           00122         BSF INTCON,PEIE
                      00123         BANK_0
0110   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
0111   1283               M                 bcf     STATUS,RP0    
                      00124 
                      00125 
                      00126         BANK_1
0112   1303               M                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
0113   1683               M                 bsf     STATUS,RP0    
0114   30C7           00127         MOVLW b'11000111'       ; ...pull up a podobny koniny
                      00128                 ; PORTB Pull-up Enable bit              1 = pull up enabled
                      00129                 ; Interrupt Edge Select bit             1 = interrupt on rising edge of RB0/INT pin
                      00130                 ; TMR0 Clock Source Select bit  0 = Internal instruction cycle clock (CLKO)
                      00131                 ; TMR0 Source Edge Select bit   0 = Increment on low-to-high transition on RA4/T0CKI pin
                      00132                 ; Prescaler Assignment bit              0 = Prescaler is assigned to the Timer0 module
                      00133                 ; PS2:PS0: Prescaler Rate Select bits   111 = TMR0 Rate 1 : 256; WDT Rate 1 : 128
0115   0081           00134         MOVWF OPTION_REG
                      00135         
                      00136 ;       MOVLW b'00100000'       ; povolime preruseni od USARTu (kdyz neco dostanem)
                      00137 ;       MOVLW b'00000000'       ; povolime preruseni od USARTu (kdyz neco dostanem)
                      00138 ;       MOVWF PIE1      
                      00139 ;       MOVLW b'00000000'       ; ostatni vnejsi preruseni vymaskujeme
                      00140 ;       MOVWF PIE2                      
                      00141 
                      00142 ;       MOVLW b'11000000'       ; povolime preruseni na vnejsi zarizeni (USART)                         
                      00143 ;       MOVWF INTCON
                      00144 
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0116   3026           00145         MOVLW b'00100110'       ;konfigurace USARTu (asynchronni, 8bit, bez parity, rychle - (BRGH = 1))
0117   0098           00146         MOVWF TXSTA
                      00147         BANK_0
0118   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
0119   1283               M                 bcf     STATUS,RP0    
011A   3090           00148         MOVLW b'10010000'       ;zapnu USART
011B   0098           00149         MOVWF RCSTA
                      00150         BANK_1
011C   1303               M                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
011D   1683               M                 bsf     STATUS,RP0    
011E   3081           00151         MOVLW .129              ; Fosc = 20 MHz, BRGH=1 => rychlost = 9615 bps
                      00152         ;MOVLW .103                     ; Fosc = 16 MHz, BRGH=1 => rychlost = 9615 bps
011F   0099           00153         MOVWF SPBRG     
                      00154 
0120   3007           00155         MOVLW b'00000111'
0121   009F           00156         MOVWF ADCON1            ; vsechny vstupy (RA,RE) jako digitalni
                      00157         BANK_0  
0122   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
0123   1283               M                 bcf     STATUS,RP0    
0124   019F           00158         CLRF ADCON0                     ; pro jistotu (vypneme A/D prevodniky)
                      00159 
0125   30BE           00160         movlw h'BE'
0126   00A7           00161         movwf AKTUAL_HLAS
0127   1628           00162         bsf STAV,4
0128   12A8           00163         bcf STAV,5                      ; zapneme podsviceni
0129   01BA           00164         clrf EKVALIZER          ; vypneme ekvalizer
012A   0008           00165         RETURN
                      00166 ;**********************************************************
                      00167 ;**********************************************************
012B                  00168 INTERRUPT                                       ; sem se skace po zavolani preruseni (uz jsou vyreseny u
                            lohy dulezitych registru)
                      00169 ;       movlw 0xC1
                      00170 ;       movwf TMR1L
                      00171 ;       MOVLW 0x3C
                      00172 ;       MOVWF TMR1H             ; 10ms
012B   3069           00173         movlw 0x69
012C   008E           00174         movwf TMR1L
012D   309E           00175         MOVLW 0x9e
012E   008F           00176         MOVWF TMR1H             ; 5ms
012F   100C           00177         BCF PIR1, TMR1IF        ; Clear interrupt flag  
                      00178         ; timto zapisem dosahnu preruseni presne kazdych 5ms (pri Fosc = 20MHz)
                      00179 
0130   0831           00180         movfw CASOVAC
0131   39FF           00181         andlw h'FF'
0132   1D03           00182         btfss STATUS,Z
0133   03B1           00183         decf CASOVAC,f
                      00184 
0134   1728           00185         bsf STAV,6
                      00186 
                      00187 
                      00188 ;----------------------------------------------------------
                      00189 ; testy tlacitek
0135   1C85           00190         btfss TL_PLAY
0136   293A           00191         goto $+4
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0137   1BC5           00192         btfsc TLACITKA_PRED,7
0138   293A           00193         goto $+2
0139   17C4           00194         bsf TLACITKA,7
                      00195 
013A   1D05           00196         btfss TL_STOP
013B   293F           00197         goto $+4
013C   1B45           00198         btfsc TLACITKA_PRED,6
013D   293F           00199         goto $+2
013E   1744           00200         bsf TLACITKA,6
                      00201 
013F   1D85           00202         btfss TL_DOPREDU
0140   2944           00203         goto $+4
0141   1AC5           00204         btfsc TLACITKA_PRED,5
0142   2944           00205         goto $+2
0143   16C4           00206         bsf TLACITKA,5
                      00207 
0144   1C05           00208         btfss TL_DOZADU
0145   2949           00209         goto $+4
0146   1A45           00210         btfsc TLACITKA_PRED,4
0147   2949           00211         goto $+2
0148   1644           00212         bsf TLACITKA,4
                      00213 
0149   1C89           00214         btfss TL_MENU
014A   294E           00215         goto $+4
014B   1945           00216         btfsc TLACITKA_PRED,2
014C   294E           00217         goto $+2
014D   1544           00218         bsf TLACITKA,2
                      00219 
014E   1C09           00220         btfss TL_MENU_UP
014F   2953           00221         goto $+4
0150   18C5           00222         btfsc TLACITKA_PRED,1
0151   2953           00223         goto $+2
0152   14C4           00224         bsf TLACITKA,1
                      00225 
0153   1D09           00226         btfss TL_MENU_DOWN
0154   2958           00227         goto $+4
0155   1845           00228         btfsc TLACITKA_PRED,0
0156   2958           00229         goto $+2
0157   1444           00230         bsf TLACITKA,0
                      00231 
0158   01C5           00232         clrf TLACITKA_PRED
0159   1885           00233         btfsc TL_PLAY
015A   17C5           00234         bsf TLACITKA_PRED,7
015B   1905           00235         btfsc TL_STOP
015C   1745           00236         bsf TLACITKA_PRED,6
015D   1985           00237         btfsc TL_DOPREDU
015E   16C5           00238         bsf TLACITKA_PRED,5
015F   1805           00239         btfsc TL_DOZADU
0160   1645           00240         bsf TLACITKA_PRED,4
0161   1889           00241         btfsc TL_MENU
0162   1545           00242         bsf TLACITKA_PRED,2
0163   1809           00243         btfsc TL_MENU_UP
0164   14C5           00244         bsf TLACITKA_PRED,1
0165   1909           00245         btfsc TL_MENU_DOWN
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0166   1445           00246         bsf TLACITKA_PRED,0
                      00247 ;----------------------------------------------------------
                      00248 
0167   1E28           00249         btfss STAV,4
0168   296D           00250         goto INTERRUPT_PODSV_OFF
0169                  00251 INTERRUPT_PODSV_ON
0169   1AA8           00252         btfsc STAV,5
016A   296F           00253         goto INTERRUPT_PODSV_BLIK
016B   1687           00254         bsf LCD_PODSVICENI
016C   2975           00255         goto END_OF_INTERRUPT
016D                  00256 INTERRUPT_PODSV_OFF
016D   1287           00257         bcf LCD_PODSVICENI
016E   2975           00258         goto END_OF_INTERRUPT
016F                  00259 INTERRUPT_PODSV_BLIK
016F   1E87           00260         btfss LCD_PODSVICENI
0170   2973           00261         goto $+3
0171   1287           00262         bcf LCD_PODSVICENI
0172   2974           00263         goto $+2
0173   1687           00264         bsf LCD_PODSVICENI      
                      00265         
0174   2975           00266         goto END_OF_INTERRUPT   ; koncime...
0175                  00267 END_OF_INTERRUPT                        ; sem skocime kdyz mame vsechny veci kolem preruseni vyrizeny
0175   0873           00268         movfw TEMP_PCLATH
0176   008A           00269         MOVWF PCLATH
0177   0872           00270         movfw TEMP_FSR
0178   0084           00271         MOVWF FSR
0179   0871           00272         movfw TEMP_STATUS
017A   0083           00273         MOVWF STATUS
017B   0870           00274         movfw TEMP_WORKING
017C   0009           00275         retfie
                      00276 ;**********************************************************
017D                  00277 ZPOZ_1S ;Delay 4999999 cycles
017D   301A           00278         MOVLW 0x1A  ;26 DEC
017E   00A3           00279         MOVWF TMP2
017F   305E           00280         MOVLW 0x5E  ;94 DEC
0180   00A1           00281         MOVWF TMP1
0181   306E           00282         MOVLW 0x6E  ;110 DEC
0182   00A0           00283         MOVWF TMP0
0183   0BA0           00284         DECFSZ TMP0,F
0184   2983           00285         GOTO $-1
0185   0BA1           00286         DECFSZ TMP1,F
0186   2983           00287         GOTO $-3
0187   0BA3           00288         DECFSZ TMP2,F
0188   2983           00289         GOTO $-5
0189   0008           00290                 RETURN
                      00291 ;**********************************************************
018A                  00292 ZPOZ_2MS
                      00293 ;Variables: TMP1, TMP0
                      00294 ;Delay 10001 cycles
018A   3010           00295         MOVLW 0x10  ;16 DEC
018B   00A1           00296         MOVWF TMP1
018C   30CF           00297         MOVLW 0x0CF  ;207 DEC
018D   00A0           00298         MOVWF TMP0
018E   0BA0           00299         DECFSZ TMP0,F
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

018F   298E           00300         GOTO $-1
0190   0BA1           00301         DECFSZ TMP1,F
0191   298C           00302         GOTO $-5
                      00303 ;End of Delay
0192   0008           00304                 RETURN
                      00305 ;**********************************************************
0193                  00306 ZPOZ_300MS
                      00307 ;Variables: TMP2, TMP1, TMP0
                      00308 ;Delay 1 500 001 cycles
0193   3008           00309         MOVLW 0x08  ;8 DEC
0194   00A3           00310         MOVWF TMP2
0195   309D           00311         MOVLW 0x9D  ;157 DEC
0196   00A1           00312         MOVWF TMP1
0197   3006           00313         MOVLW 0x06  ;6 DEC
0198   00A0           00314         MOVWF TMP0
0199   0BA0           00315         DECFSZ TMP0,F
019A   2999           00316         GOTO $-1
019B   0BA1           00317         DECFSZ TMP1,F
019C   2999           00318         GOTO $-3
019D   0BA3           00319         DECFSZ TMP2,F
019E   2999           00320         GOTO $-5
                      00321 ;End of Delay
019F   0008           00322                 RETURN
                      00323 ;**********************************************************
01A0                  00324 ZPOZ_20MS
                      00325 ;Variables: TMP1, TMP0
                      00326 ;Delay 100001 cycles
01A0   30A0           00327         MOVLW 0x0A0  ;160 DEC
01A1   00A1           00328         MOVWF TMP1
01A2   30CF           00329         MOVLW 0x0CF  ;207 DEC
01A3   00A0           00330         MOVWF TMP0
01A4   0BA0           00331         DECFSZ TMP0,F
01A5   29A4           00332         GOTO $-1
01A6   0BA1           00333         DECFSZ TMP1,F
01A7   29A2           00334         GOTO $-5
                      00335 ;End of Delay
01A8   0008           00336         return
                      00337 ;**********************************************************
01A9                  00338 ZPOZ_100US ;Delay 500 cycles
01A9   3001           00339         MOVLW 0x01  ;1 DEC
01AA   00A1           00340         MOVWF TMP1
01AB   30A5           00341         MOVLW 0x0A5  ;165 DEC
01AC   00A0           00342         MOVWF TMP0
01AD   0BA0           00343         DECFSZ TMP0,F
01AE   29AD           00344         GOTO $-1
01AF   0BA1           00345         DECFSZ TMP1,F
01B0   29AD           00346         GOTO $-3
01B1   0008           00347                 RETURN
                      00348 ;**********************************************************
01B2                  00349 ZPOZ_50US
                      00350 ;Variable: TMP0
                      00351 ;Delay 250 cycles
01B2   3053           00352         MOVLW 0x53  ;83 DEC
01B3   00A0           00353         MOVWF TMP0
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01B4   0BA0           00354         DECFSZ TMP0,F
01B5   29B4           00355         GOTO $-1
                      00356 ;End of Delay
01B6   0008           00357                 RETURN
                      00358 ;**********************************************************
01B7                  00359 WR_USART                        ; odesle slovo ve workingu po USARTu
                      00360         BANK_1  
01B7   1303               M                 bcf     STATUS,RP1              ; BANK1  RP1:RP0 = 01
01B8   1683               M                 bsf     STATUS,RP0    
01B9   1C98           00361         btfss TXSTA,1 
01BA   29B7           00362         goto WR_USART   ; cekame do chvile nez bude pripraven transmit buffer 
                      00363         BANK_0  
01BB   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
01BC   1283               M                 bcf     STATUS,RP0    
01BD   0099           00364         movwf TXREG
01BE   0008           00365         return
                      00366 ;**********************************************************
01BF                  00367 RD_USART                                ; pocka nez prijde dato po usartu a pote ho umisti do Workingu
01BF   1E8C           00368         btfss PIR1,RCIF
01C0   29BF           00369         goto RD_USART           ; Pokud nejde o preruseni od USARTU, tak koncime...
01C1   081A           00370         movfw RCREG                     ; !!! vynulovat pøíznak !!!     
01C2   0008           00371         return  
                      00372 ;**********************************************************¨
01C3                  00373 USART_PRESKOC                   ; precte tolik bytu z usartu, jaka je hodnota v TMP1
01C3   21BF           00374         CALL RD_USART
01C4   0BA1           00375     decfsz TMP1,f
01C5   29C3           00376     GOTO $-2
01C6   0008           00377         return  
                      00378 ;**********************************************************¨
01C7                  00379 NACTIODDILY
                      00380 ; nacte seznam oddilu do bufferu2
                      00381         PROG_PAGE_1
01C7   158A               M                         bsf PCLATH,3
01C8   120A               M                         bcf PCLATH,4
01C9   2000           00382         call CLEAR_BUFFER2
                      00383         PROG_PAGE_0
01CA   118A               M                         bcf PCLATH,3
01CB   120A               M                         bcf PCLATH,4
                      00384 
01CC   13A8           00385         bcf STAV,7
01CD   01A4           00386         clrf TMP3                       ; kolikaty oddil ted prozkoumavame
01CE   01A5           00387         clrf TMP4                       ; kolik oddilu obsahuje disk
                      00388         INDF_BANK_2
01CF   1783               M                         bsf STATUS,IRP    
01D0   3010           00389         movlw 0x10
01D1   0084           00390         movwf FSR
                      00391 
01D2                  00392 NACTIODDILY_JEDENODDIL
01D2   3002           00393         movlw h'02'                     ; prikaz vrat oddil s FAT32
01D3   21B7           00394         call WR_USART
01D4   0824           00395         movfw TMP3
01D5   21B7           00396         call WR_USART
01D6   21BF           00397         call RD_USART
01D7   0080           00398         movwf INDF
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01D8   1C00           00399         btfss INDF,0
01D9   29E4           00400         goto NACTIODDILY_NEPLATNY
                      00401         ; prohlizeny zaznam obsahuje oddil s FATkou     
01DA   0A84           00402         incf FSR,f
                      00403 
01DB   300F           00404         movlw .15
01DC   00A3           00405         movwf TMP2
01DD   21BF           00406         call RD_USART
01DE   0080           00407         movwf INDF
01DF   0A84           00408         incf FSR,f
01E0   0BA3           00409         decfsz TMP2,f
01E1   29DD           00410         goto $-4
                      00411         
01E2   0AA5           00412         incf TMP4,f
01E3   29E7           00413         goto NACTIODDILY_DALSI
01E4                  00414 NACTIODDILY_NEPLATNY
                      00415         ; prohlizeny zaznam NEobsahuje oddil s FATkou   
01E4   300F           00416         movlw .15
01E5   00A1           00417         movwf TMP1
01E6   21C3           00418         call USART_PRESKOC
01E7                  00419 NACTIODDILY_DALSI
01E7   0AA4           00420         incf TMP3,f
01E8   0824           00421         movfw TMP3
01E9   3C04           00422         sublw .4
01EA   1D03           00423         btfss STATUS,Z
01EB   29D2           00424         goto NACTIODDILY_JEDENODDIL
01EC   0008           00425         return
                      00426 ;**********************************************************¨
01ED                  00427 NASTAVODDIL
                      00428         ;ODDIL 1
01ED   3003           00429         movlw .3
01EE   21B7           00430         CALL WR_USART
                      00431         INDF_BANK_2
01EF   1783               M                         bsf STATUS,IRP    
01F0   3011           00432         movlw h'11'
01F1   0084           00433         movwf FSR
01F2   0800           00434         movfw INDF
01F3   21B7           00435         CALL WR_USART
01F4   0A84           00436         incf FSR,f
01F5   0800           00437         movfw INDF
01F6   21B7           00438         CALL WR_USART
01F7   0A84           00439         incf FSR,f
01F8   0800           00440         movfw INDF
01F9   21B7           00441         CALL WR_USART
01FA   0A84           00442         incf FSR,f
01FB   0800           00443         movfw INDF
01FC   21B7           00444         CALL WR_USART
                      00445 
01FD   21BF           00446         CALL RD_USART
01FE   00A6           00447         movwf TMP5
01FF   13A8           00448         BcF     STAV,7
0200   1A26           00449         BTFSC TMP5,4
0201   17A8           00450         BSF     STAV,7
0202   0008           00451         RETURN
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00452 ;**********************************************************¨
0203                  00453 PREVED_ZNAK
                      00454 ; prevede znaky pred vypsanim na LCD (snaky s diakritikou a pod.)
                      00455 ; prevodni tabulka je pro jednoduchost umistena v EEPROMe
                      00456 
                      00457         BANK_2
0203   1703               M                 bsf     STATUS,RP1              ; BANK2  RP1:RP0 = 10
0204   1283               M                 bcf     STATUS,RP0    
0205   008D           00458         MOVWF EEADR             ; Address to read
                      00459         BANK_3
0206   1703               M                 bsf     STATUS,RP1              ; BANK3  RP1:RP0 = 11
0207   1683               M                 bsf     STATUS,RP0    
0208   138C           00460         BCF EECON1,EEPGD        ; Point to Data memory
0209   140C           00461         BSF EECON1,RD           ; EE Read
                      00462         BANK_2
020A   1703               M                 bsf     STATUS,RP1              ; BANK2  RP1:RP0 = 10
020B   1283               M                 bcf     STATUS,RP0    
020C   080C           00463         MOVFW EEDATA            ; W = EEDATA
                      00464         BANK_0
020D   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
020E   1283               M                 bcf     STATUS,RP0    
                      00465 
020F   0008           00466         return
                      00467 ;**********************************************************
                      00035         include "menu.asm"              ; soubor s definici hlasek na LCD
                      00001 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00002 ; menu a hlaseni prehravace
                      00003 
0210                  00004 HLASKA_PREPRCAVAC
0210   2032           00005     call LCD_1RADEK
0211   303C           00006         MOVLW '<'
0212   20A8           00007         CALL ZAPISD
0213   303C           00008         MOVLW '<'
0214   20A8           00009         CALL ZAPISD
0215   303C           00010     MOVLW '<'
0216   20A8           00011         CALL ZAPISD
0217   304D           00012         MOVLW 'M'
0218   20A8           00013         CALL ZAPISD
0219   3050           00014         MOVLW 'P'
021A   20A8           00015         CALL ZAPISD
021B   3033           00016         MOVLW '3'
021C   20A8           00017         CALL ZAPISD
021D   3020           00018         MOVLW ' '
021E   20A8           00019     CALL ZAPISD
021F   3020           00020         MOVLW ' '
0220   20A8           00021     CALL ZAPISD
0221   3070           00022         MOVLW 'p'
0222   20A8           00023         CALL ZAPISD
0223   3005           00024         MOVLW h'05'                     ; znak5 = 68h   r s hackem
0224   20A8           00025         CALL ZAPISD
0225   3065           00026         MOVLW 'e'
0226   20A8           00027         CALL ZAPISD
0227   3068           00028         MOVLW 'h'
0228   20A8           00029         CALL ZAPISD
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0229   3072           00030         MOVLW 'r'
022A   20A8           00031         CALL ZAPISD
022B   3000           00032         MOVLW h'00'
022C   20A8           00033         CALL ZAPISD
022D   3076           00034         MOVLW 'v'                       ; znak0 = 40h   á
022E   20A8           00035         CALL ZAPISD
022F   3061           00036         MOVLW 'a'
0230   20A8           00037         CALL ZAPISD
0231   3004           00038         MOVLW h'04'     ; znak4 = 60h   c s hackem
0232   20A8           00039         CALL ZAPISD             
0233   303E           00040         MOVLW '>'
0234   20A8           00041         CALL ZAPISD
0235   303E           00042         MOVLW '>'
0236   20A8           00043         CALL ZAPISD
0237   303E           00044     MOVLW '>'
0238   20A8           00045         CALL ZAPISD
0239   0008           00046         RETURN
                      00047 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
023A                  00048 HLASKA_AUTORI
023A   2038           00049         call LCD_3RADEK
023B   3020           00050         MOVLW ' '
023C   20A8           00051         CALL ZAPISD
023D   3020           00052         MOVLW ' '
023E   20A8           00053         CALL ZAPISD
023F   3020           00054         MOVLW ' '
0240   20A8           00055         CALL ZAPISD
0241   304B           00056         MOVLW 'K'
0242   20A8           00057         CALL ZAPISD
0243   3061           00058         MOVLW 'a'
0244   20A8           00059         CALL ZAPISD
0245   3072           00060         MOVLW 'r'
0246   20A8           00061         CALL ZAPISD
0247   3072           00062         MOVLW 'r'
0248   20A8           00063         CALL ZAPISD
0249   3079           00064         MOVLW 'y'
024A   20A8           00065         CALL ZAPISD
024B   3020           00066         MOVLW ' '
024C   20A8           00067         CALL ZAPISD
024D   3020           00068         MOVLW ' '
024E   20A8           00069         CALL ZAPISD
024F   3026           00070         MOVLW '&'
0250   20A8           00071         CALL ZAPISD
0251   3020           00072         MOVLW ' '
0252   20A8           00073         CALL ZAPISD
0253   3020           00074         MOVLW ' '
0254   20A8           00075         CALL ZAPISD
0255   3042           00076         MOVLW 'B'
0256   20A8           00077         CALL ZAPISD
0257   306F           00078         MOVLW 'o'
0258   20A8           00079         CALL ZAPISD
0259   3067           00080         MOVLW 'g'
025A   20A8           00081         CALL ZAPISD
025B   3061           00082         MOVLW 'a'
025C   20A8           00083         CALL ZAPISD
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

025D   0008           00084         RETURN
                      00085 
                      00086 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
025E                  00087 HLASKA_DISK
025E   2035           00088         call LCD_2RADEK
025F   3004           00089         MOVLW h'04'             ; c
0260   20A8           00090         CALL ZAPISD
0261   3065           00091         MOVLW 'e'
0262   20A8           00092         CALL ZAPISD
0263   306B           00093     MOVLW 'k'
0264   20A8           00094         CALL ZAPISD
0265   3000           00095         MOVLW h'00'             ; a
0266   20A8           00096         CALL ZAPISD
0267   306D           00097         MOVLW 'm'
0268   20A8           00098         CALL ZAPISD
0269   3020           00099         MOVLW ' '
026A   20A8           00100         CALL ZAPISD
026B   306E           00101         MOVLW 'n'
026C   20A8           00102     CALL ZAPISD
026D   3061           00103         MOVLW 'a'
026E   20A8           00104         CALL ZAPISD
026F   3020           00105         MOVLW ' '
0270   20A8           00106         CALL ZAPISD
0271   3064           00107         MOVLW 'd'
0272   20A8           00108         CALL ZAPISD
0273   3069           00109         MOVLW 'i'
0274   20A8           00110         CALL ZAPISD
0275   3073           00111         MOVLW 's'
0276   20A8           00112         CALL ZAPISD
0277   306B           00113         MOVLW 'k'
0278   20A8           00114         CALL ZAPISD
0279   302E           00115         MOVLW '.'
027A   20A8           00116         CALL ZAPISD
027B   2193           00117     call ZPOZ_300MS
027C   302E           00118         MOVLW '.'
027D   20A8           00119         CALL ZAPISD
027E   2193           00120     call ZPOZ_300MS
027F   302E           00121         MOVLW '.'
0280   20A8           00122         CALL ZAPISD
0281   2193           00123     call ZPOZ_300MS
0282   0008           00124         RETURN
                      00125 
                      00126 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
0283                  00127 HLASKA_DISKOK
0283   2038           00128         call LCD_3RADEK
0284   3044           00129         MOVLW 'D'
0285   20A8           00130         CALL ZAPISD
0286   3049           00131         MOVLW 'I'
0287   20A8           00132         CALL ZAPISD
0288   3053           00133         MOVLW 'S'
0289   20A8           00134         CALL ZAPISD
028A   304B           00135         MOVLW 'K'
028B   20A8           00136         CALL ZAPISD
028C   3020           00137         MOVLW ' '
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

028D   20A8           00138         CALL ZAPISD
028E   304F           00139         MOVLW 'O'
028F   20A8           00140         CALL ZAPISD
0290   304B           00141         MOVLW 'K'
0291   20A8           00142         CALL ZAPISD
0292   0008           00143     RETURN
                      00144 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
0293                  00145 HLASKA_NEPODPOROVANY_HDD
0293   2038           00146         call LCD_3RADEK
0294   304E           00147         MOVLW 'N'
0295   20A8           00148         CALL ZAPISD
0296   3045           00149         MOVLW 'E'
0297   20A8           00150         CALL ZAPISD
0298   3050           00151         MOVLW 'P'
0299   20A8           00152         CALL ZAPISD
029A   304F           00153         MOVLW 'O'
029B   20A8           00154         CALL ZAPISD
029C   3044           00155         MOVLW 'D'
029D   20A8           00156         CALL ZAPISD
029E   3050           00157         MOVLW 'P'
029F   20A8           00158         CALL ZAPISD
02A0   304F           00159         MOVLW 'O'
02A1   20A8           00160         CALL ZAPISD
02A2   3052           00161         MOVLW 'R'
02A3   20A8           00162         CALL ZAPISD
02A4   304F           00163         MOVLW 'O'
02A5   20A8           00164         CALL ZAPISD
02A6   3056           00165         MOVLW 'V'
02A7   20A8           00166         CALL ZAPISD
02A8   3041           00167         MOVLW 'A'
02A9   20A8           00168         CALL ZAPISD
02AA   304E           00169         MOVLW 'N'
02AB   20A8           00170         CALL ZAPISD
02AC   3059           00171         MOVLW 'Y'
02AD   20A8           00172         CALL ZAPISD
02AE   3020           00173         MOVLW ' '
02AF   20A8           00174         CALL ZAPISD
02B0   3044           00175         MOVLW 'D'
02B1   20A8           00176         CALL ZAPISD
02B2   3049           00177         MOVLW 'I'
02B3   20A8           00178         CALL ZAPISD
02B4   3053           00179         MOVLW 'S'
02B5   20A8           00180         CALL ZAPISD
02B6   304B           00181         MOVLW 'K'
02B7   20A8           00182         CALL ZAPISD
02B8   0008           00183     RETURN              
                      00184 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
02B9                  00185 HLASKA_VICODDILU        
02B9   2032           00186         call LCD_1RADEK
02BA   3064           00187         MOVLW 'd'
02BB   20A8           00188         CALL ZAPISD
02BC   3069           00189         MOVLW 'i'
02BD   20A8           00190         CALL ZAPISD
02BE   3073           00191         MOVLW 's'
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02BF   20A8           00192         CALL ZAPISD
02C0   306B           00193         MOVLW 'k'
02C1   20A8           00194         CALL ZAPISD
02C2   3020           00195         MOVLW ' '
02C3   20A8           00196         CALL ZAPISD
02C4   306F           00197         MOVLW 'o'
02C5   20A8           00198         CALL ZAPISD
02C6   3062           00199         MOVLW 'b'
02C7   20A8           00200         CALL ZAPISD
02C8   3073           00201         MOVLW 's'
02C9   20A8           00202         CALL ZAPISD
02CA   3061           00203         MOVLW 'a'
02CB   20A8           00204         CALL ZAPISD
02CC   3068           00205         MOVLW 'h'
02CD   20A8           00206         CALL ZAPISD
02CE   3075           00207         MOVLW 'u'
02CF   20A8           00208         CALL ZAPISD
02D0   306A           00209         MOVLW 'j'
02D1   20A8           00210         CALL ZAPISD
02D2   3065           00211         MOVLW 'e'
02D3   20A8           00212         CALL ZAPISD
02D4   2035           00213         call LCD_2RADEK
                      00214 
02D5   3076           00215         MOVLW 'v'
02D6   20A8           00216         CALL ZAPISD
02D7   3001           00217         MOVLW h'01'             ; i
02D8   20A8           00218         CALL ZAPISD
02D9   3063           00219         MOVLW 'c'
02DA   20A8           00220         CALL ZAPISD
02DB   3065           00221         MOVLW 'e'
02DC   20A8           00222         CALL ZAPISD
02DD   3020           00223         MOVLW ' '
02DE   20A8           00224         CALL ZAPISD
02DF   306F           00225         MOVLW 'o'
02E0   20A8           00226         CALL ZAPISD
02E1   3064           00227         MOVLW 'd'
02E2   20A8           00228         CALL ZAPISD
02E3   3064           00229         MOVLW 'd'
02E4   20A8           00230         CALL ZAPISD
02E5   3001           00231         MOVLW h'01'             ; i
02E6   20A8           00232         CALL ZAPISD
02E7   306C           00233         MOVLW 'l'
02E8   20A8           00234         CALL ZAPISD
02E9   3075           00235         MOVLW 'u'
02EA   20A8           00236         CALL ZAPISD
02EB   3021           00237         MOVLW '!'
02EC   20A8           00238         CALL ZAPISD
02ED   0000           00239         nop
02EE   2AED           00240         goto $-1
02EF   0008           00241     RETURN      
                      00242 
                      00243 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00244 
02F0                  00245 HLASKA_CHYBAODDILU
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

02F0   2021           00246         call SMAZ_LCD
02F1   2032           00247         call LCD_1RADEK
02F2   304E           00248         MOVLW 'N'
02F3   20A8           00249         CALL ZAPISD
02F4   3045           00250         MOVLW 'E'
02F5   20A8           00251         CALL ZAPISD
02F6   3050           00252         MOVLW 'P'
02F7   20A8           00253         CALL ZAPISD
02F8   304C           00254         MOVLW 'L'
02F9   20A8           00255         CALL ZAPISD
02FA   3041           00256         MOVLW 'A'
02FB   20A8           00257         CALL ZAPISD
02FC   3054           00258         MOVLW 'T'
02FD   20A8           00259         CALL ZAPISD
02FE   304E           00260         MOVLW 'N'
02FF   20A8           00261         CALL ZAPISD
0300   3059           00262         MOVLW 'Y'
0301   20A8           00263         CALL ZAPISD
0302   3020           00264         MOVLW ' '
0303   20A8           00265         CALL ZAPISD
0304   3044           00266         MOVLW 'D'
0305   20A8           00267         CALL ZAPISD
0306   3044           00268         MOVLW 'D'
0307   20A8           00269         CALL ZAPISD
0308   3049           00270         MOVLW 'I'
0309   20A8           00271         CALL ZAPISD
030A   304C           00272         MOVLW 'L'
030B   20A8           00273         CALL ZAPISD
030C   0008           00274         return   
                      00275 
                      00276 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
030D                  00277 JMENODISKU
030D   3001           00278         movlw .1
030E   21B7           00279         CALL WR_USART
030F   21BF           00280         CALL RD_USART
0310   00A3           00281         movwf TMP2
0311   1BA3           00282         BTFSC TMP2,7
0312   2283           00283         CALL HLASKA_DISKOK
0313   1FA3           00284         BTFSS TMP2,7
0314   2293           00285         CALL HLASKA_NEPODPOROVANY_HDD
                      00286 
0315   203B           00287         call LCD_4RADEK
0316   3014           00288         movlw .20             ;prijem jmena disku
0317   00A1           00289         movwf TMP1
0318   21BF           00290         CALL RD_USART
0319   20A8           00291         CALL ZAPISD
031A   0BA1           00292     decfsz TMP1,f
031B   2B18           00293     GOTO $-3
                      00294     
031C   3014           00295         movlw .20   
031D   00A1           00296         movwf TMP1
031E   21C3           00297         call USART_PRESKOC       
                      00298 
031F   1BA3           00299         BTFSC TMP2,7
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0320   0008           00300         RETURN
0321   0000           00301         NOP
0322   2B21           00302         GOTO $-1    
                      00303 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00036         include "prehravani.asm"; programova smycka pro prehravani
                      00001 
                      00002 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00003 ; smycka prehravani (zobrazuje nazev souboru a slozky, odehrany cas a dalsi blbosti...)
                      00004 
0323                  00005 PREHRAVANI
0323   3081           00006         movlw h'81'    ;vraci stav prehravani
0324   21B7           00007         CALL WR_USART
0325   21BF           00008     CALL RD_USART
0326   00A9           00009         MOVWF PREH_STAV0
0327   21BF           00010         CALL RD_USART
0328   00AA           00011         MOVWF PREH_STAV1
0329   21BF           00012         CALL RD_USART
032A   21BF           00013         CALL RD_USART
032B   1429           00014         bsf PREH_STAV0,0
032C   102A           00015         bcf PREH_STAV1,0
                      00016         ;bcf PREH_STAV1,4
032D   24F4           00017         call NASTAV_STAV
                      00018 
032E   3083           00019         movlw h'83'             ; vraci informace o prehravanem souboru
032F   21B7           00020         CALL WR_USART
0330   3006           00021         MOVLW .6
0331   00A1           00022         MOVWF TMP1
0332   21C3           00023         CALL USART_PRESKOC
0333   21BF           00024     CALL RD_USART
0334   00AB           00025         MOVWF PREH_ADR_CL1      ; cl1,cl2,cl3,cl4....4bitove cislo,ktere urcuje 1. cluster adresare
0335   00E7           00026         movwf ADRESAR1
0336   21BF           00027         CALL RD_USART
0337   00AC           00028     MOVWF PREH_ADR_CL2
0338   00E8           00029         movwf ADRESAR2
0339   21BF           00030         CALL RD_USART
033A   00AD           00031     MOVWF PREH_ADR_CL3
033B   00E9           00032         movwf ADRESAR3
033C   21BF           00033         CALL RD_USART
033D   00AE           00034         MOVWF PREH_ADR_CL4
033E   00EA           00035         movwf ADRESAR4
033F   21BF           00036         CALL RD_USART
0340   00AF           00037         MOVWF PREH_SOUB_1   ; PREH_SOUB_1,PREH_SOUB_2.....cislo zaznamu obsahujici prehravany soubor
0341   00EB           00038         movwf ZAZNAM1
0342   21BF           00039         CALL RD_USART
0343   00B0           00040         MOVWF PREH_SOUB_2
0344   00EC           00041         movwf ZAZNAM2
                      00042         
                      00043         
                      00044         PROG_PAGE_1
0345   158A               M                         bsf PCLATH,3
0346   120A               M                         bcf PCLATH,4
0347   2032           00045         call NACTI_DLOUHY_NAZEV
                      00046         PROG_PAGE_0
0348   118A               M                         bcf PCLATH,3
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0349   120A               M                         bcf PCLATH,4
                      00047         
                      00048                 
034A   3011           00049         movlw h'11'
034B   00C2           00050         movwf ZAC_ZOB_SOUB
034C   3091           00051         movlw h'91'
034D   00C3           00052         movwf ZAC_ZOB_ADR
034E   3064           00053         movlw .100
034F   00B1           00054         movwf CASOVAC                   ; casovac je dekrementovan v preruseni kazdy 5ms, 
                      00055                                                         ; timto tedy dosahneme presne 500ms smycky
0350   01C4           00056         clrf TLACITKA
0351   15A8           00057         bsf STAV,3                                      ; 3. bit = 1 => pri zmene hlasitosti se vypise h
                            lasitost na LCD 
                      00058 
0352   2021           00059         call SMAZ_LCD
                      00060 
0353                  00061 PREHRAVANI_SMYCKA
0353   2032           00062         call LCD_1RADEK
0354   202B           00063         call LCD_SMAZ_RADEK
0355   2032           00064         call LCD_1RADEK
0356   3000           00065         movlw h'00'
0357   00A5           00066         movwf TMP4
0358   2381           00067         call ROLUJ                              ; TMP4 = 0 -> rolujeme nazev adresare 
                      00068 
0359   2035           00069         call LCD_2RADEK
035A   202B           00070         call LCD_SMAZ_RADEK
035B   2035           00071         call LCD_2RADEK
035C   3001           00072         movlw h'01'
035D   00A5           00073         movwf TMP4
035E   2381           00074         call ROLUJ                              ; TMP4 = 1 -> rolujeme nazev souboru
                      00075 
035F   23F3           00076         CALL CAS_MP3
                      00077         PROG_PAGE_1
0360   158A               M                         bsf PCLATH,3
0361   120A               M                         bcf PCLATH,4
0362   20DC           00078         call INFO
                      00079         PROG_PAGE_0
0363   118A               M                         bcf PCLATH,3
0364   120A               M                         bcf PCLATH,4
0365   23B8           00080         call ZOBRAZ_HLASITOST
0366   1929           00081         BTFSC PREH_STAV0,2
0367   2B23           00082         GOTO  PREHRAVANI                ; pokud byla zmenena prehravana mp3 (automaticky), nactemem si j
                            eji jmeno
                      00083         
0368                  00084 PREHRAVANI_SMYCKA_DELAY
0368   24A8           00085         CALL TEST_TLAC
0369   245D           00086         CALL PREH_OBSLUHA_TLACITEK
036A   0831           00087         movfw CASOVAC
036B   39FF           00088         andlw h'FF'
036C   1D03           00089         btfss STATUS,Z
036D   2B68           00090         goto PREHRAVANI_SMYCKA_DELAY
                      00091 
036E   3064           00092         movlw .100
036F   00B1           00093         movwf CASOVAC                   ; casovac je dekrementovan v preruseni kazdy 5ms, 
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00094                                                         ; timto tedy dosahneme presne 500ms smycky
                      00095  
0370   1929           00096         BTFSC PREH_STAV0,2
0371   2B23           00097         GOTO  PREHRAVANI                ; pokud byla zmenena prehravana mp3 (tlacitkem), nactemem si jej
                            i jmeno
                      00098 
0372   1D44           00099         btfss TLACITKA,2
0373   2B78           00100         goto PREHRAVANI_NOMENU
0374   1144           00101         bcf TLACITKA,2
                      00102         PROG_PAGE_1
0375   158A               M                         bsf PCLATH,3
0376   120A               M                         bcf PCLATH,4
0377   29A2           00103         goto MENU
0378                  00104 PREHRAVANI_NOMENU
                      00105 
0378   1844           00106         btfsc TLACITKA,0
0379   2B7D           00107         goto $+4
037A   18C4           00108         btfsc TLACITKA,1
037B   2B7D           00109         goto $+2
037C   2B80           00110         goto $+4
037D   1044           00111         bcf TLACITKA,0
037E   10C4           00112         bcf TLACITKA,1
037F   2D8F           00113         goto PRUZKUMNIK
                      00114 
0380   2B53           00115         GOTO PREHRAVANI_SMYCKA          
                      00116 
                      00117 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
0381                  00118 ROLUJ
0381   01A6           00119         clrf TMP5
                      00120 
0382   3013           00121         movlw .19
0383   00A1           00122         movwf TMP1
                      00123         INDF_BANK_2
0384   1783               M                         bsf STATUS,IRP    
                      00124 
0385   0842           00125         movfw ZAC_ZOB_SOUB
0386   1C25           00126         btfss TMP4,0
0387   0843           00127         movfw ZAC_ZOB_ADR
                      00128 
0388   0084           00129         movwf FSR
                      00130 
0389   0800           00131         movfw INDF
038A   3CFF           00132         sublw h'FF'
038B   1903           00133         btfsc STATUS,Z
038C   1426           00134         bsf TMP5,0      
038D   1903           00135         btfsc STATUS,Z
038E   2B9D           00136         goto ROLUJ_KONVYP
038F   0800           00137         movfw INDF
0390   20A8           00138         CALL ZAPISD
0391   0A84           00139         INCF FSR,F 
                      00140         
0392                  00141 ROLUJ_ZACVYP
0392   0800           00142         movfw INDF
0393   3CFF           00143         sublw h'FF'
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0394   1903           00144         btfsc STATUS,Z
0395   14A6           00145         bsf TMP5,1
0396   1903           00146         btfsc STATUS,Z
0397   2B9D           00147         goto ROLUJ_KONVYP
                      00148                 
0398   0800           00149         movfw INDF
0399   20A8           00150         CALL ZAPISD
039A   0A84           00151         INCF FSR,F 
039B   0BA1           00152         DECFSZ TMP1,F
039C   2B92           00153         GOTO ROLUJ_ZACVYP
039D                  00154 ROLUJ_KONVYP
                      00155         ; pokud byl na prvni zobrazovane pozici znak h'FF' (konec retezce), 
                      00156         ; je nastaven bit 0 TMP5, pokud byl jinde, je nastaven bit 1 TMP5
                      00157 
039D   0826           00158         movfw TMP5
039E   39FF           00159         andlw h'FF'
039F   1903           00160         btfsc STATUS,Z
03A0   2BB2           00161         goto ROLUJ_INCREMENTUJ
                      00162 
03A1   1C26           00163         btfss TMP5,0
03A2   2BAB           00164         goto ROLUJ_KRATKE               ; konec retezce byl vypsan ale ne na prvni pozici...
                      00165 
03A3   1C25           00166         btfss TMP4,0
03A4   2BA8           00167         goto $+4        
03A5   3011           00168         movlw h'11'
03A6   00C2           00169         movwf ZAC_ZOB_SOUB
03A7   0008           00170         return
03A8   3091           00171         movlw h'91'
03A9   00C3           00172         movwf ZAC_ZOB_ADR
03AA   0008           00173         return
03AB                  00174 ROLUJ_KRATKE                            ; ...proto se podivame zda neni retezec dost kratky (takovy nero
                            luje)
03AB   0842           00175         movfw ZAC_ZOB_SOUB
03AC   1C25           00176         btfss TMP4,0
03AD   0843           00177         movfw ZAC_ZOB_ADR
03AE   397F           00178         andlw b'01111111'
03AF   3C11           00179         sublw b'00010001'
03B0   1903           00180         btfsc STATUS,Z
03B1   0008           00181         return
03B2                  00182 ROLUJ_INCREMENTUJ
03B2   1C25           00183         btfss TMP4,0
03B3   2BB6           00184         goto $+3
03B4   0AC2           00185         incf ZAC_ZOB_SOUB,f
03B5   0008           00186         return
                      00187 
03B6   0AC3           00188         incf ZAC_ZOB_ADR,f
03B7   0008           00189         return
                      00190 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00191 ; zobrazi aktualni hlasitost na LCD
03B8                  00192 ZOBRAZ_HLASITOST
03B8   1DA8           00193         btfss STAV,3
03B9   0008           00194         return
                      00195 
03BA   30A1           00196         movlw h'A1'
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03BB   208B           00197         call ZAPISI
                      00198         ; kurzor vlevo na 3. radek
03BC   1A2A           00199         btfsc PREH_STAV1,4      ; je-li tento bit 1 => MUTE
03BD   2BE4           00200         goto ZOBRAZ_HLASITOST_MUTE      
                      00201 
03BE   3056           00202         movlw 'V'
03BF   20A8           00203         call ZAPISD
03C0   304F           00204         movlw 'O'
03C1   20A8           00205         call ZAPISD
03C2   304C           00206         movlw 'L'
03C3   20A8           00207         call ZAPISD
03C4   3020           00208         movlw ' '
03C5   20A8           00209         call ZAPISD
                      00210 
03C6   0827           00211         movfw AKTUAL_HLAS       
03C7   00A6           00212         movwf TMP5
03C8   1003           00213         bcf STATUS,C
03C9   0CA6           00214         rrf TMP5,f                      ; hlasitost menime po 2, proto ji upravime do rozsahu 0-128
03CA   01A3           00215         clrf TMP2
03CB   3064           00216         movlw .100
                      00217 
03CC   0AA3           00218         incf TMP2,f     
03CD   02A6           00219         subwf TMP5,f            ; TMP5 := TMP5 - 100
03CE   1803           00220         btfsc STATUS,C
03CF   2BCC           00221         goto $-3
                      00222 
03D0   07A6           00223         addwf TMP5,f
03D1   03A3           00224         decf TMP2,f
03D2   3030           00225         movlw .48
03D3   0723           00226         addwf TMP2,w
03D4   20A8           00227         call ZAPISD                     ; stovky
03D5   01A3           00228         clrf TMP2
03D6   300A           00229         movlw .10
                      00230 
03D7   0AA3           00231         incf TMP2,f     
03D8   02A6           00232         subwf TMP5,f            ; TMP5 := TMP5 - 10
03D9   1803           00233         btfsc STATUS,C
03DA   2BD7           00234         goto $-3
                      00235 
03DB   07A6           00236         addwf TMP5,f
03DC   03A3           00237         decf TMP2,f
03DD   3030           00238         movlw .48
03DE   0723           00239         addwf TMP2,w
03DF   20A8           00240         call ZAPISD                     ; desitky
                      00241 
03E0   3030           00242         movlw .48
03E1   0726           00243         addwf TMP5,w
03E2   20A8           00244         call ZAPISD                     ; jednotky
                      00245 
03E3   0008           00246         return
03E4                  00247 ZOBRAZ_HLASITOST_MUTE
03E4   304D           00248         movlw 'M'
03E5   20A8           00249         call ZAPISD
03E6   3055           00250         movlw 'U'
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03E7   20A8           00251         call ZAPISD
03E8   3054           00252         movlw 'T'
03E9   20A8           00253         call ZAPISD
03EA   3045           00254         movlw 'E'
03EB   20A8           00255         call ZAPISD
03EC   3020           00256         movlw ' '
03ED   20A8           00257         call ZAPISD
03EE   3020           00258         movlw ' '
03EF   20A8           00259         call ZAPISD
03F0   3020           00260         movlw ' '
03F1   20A8           00261         call ZAPISD
                      00262 
03F2   0008           00263         return
                      00264 
                      00265 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00266 ; zobrazi cas prehravani MP3 na LCD (cas od casu dochazi chybam v dekodovani
                      00267 ; a tim i k udavanemu casu, proto je potreba brat tento udaj pouze informacne)
03F3                  00268 CAS_MP3
03F3   3081           00269         movlw h'81'    ;vraci stav prehravani
03F4   21B7           00270         CALL WR_USART
03F5   21BF           00271     CALL RD_USART
03F6   00A9           00272         MOVWF PREH_STAV0
03F7   21BF           00273         CALL RD_USART
03F8   00AA           00274         MOVWF PREH_STAV1
03F9   21BF           00275         CALL RD_USART
03FA   00B2           00276         MOVWF VTERINY1
03FB   21BF           00277         CALL RD_USART
03FC   00B3           00278         MOVWF VTERINY2
                      00279 
03FD   2038           00280         call LCD_3RADEK
03FE   1CA9           00281         btfss PREH_STAV0,1              ; je-li pripraven soubor...
03FF   2C04           00282         goto CAS_MP3_ZOBRAZ_CAS
0400   1829           00283         btfsc PREH_STAV0,0              ; ...a presto se nic neprehrava
0401   2C04           00284         goto CAS_MP3_ZOBRAZ_CAS
0402   1928           00285         btfsc STAV,2
0403   2C2A           00286         goto CAS_MP3_SHOVEJ_CAS
0404                  00287 CAS_MP3_ZOBRAZ_CAS
0404   1528           00288         bsf STAV,2
                      00289 
0405   244B           00290         CALL PREVOD                     ;vypocet  minut a sekund
                      00291         ; MINUTY := VTERINY div 60
                      00292         ; VTERINY := VTERINY mod 60
0406   0834           00293         movfw MINUTY1
0407   00C0           00294         movwf POMOCNA1
0408   0835           00295         movfw MINUTY2
0409   00C1           00296         movwf POMOCNA2
040A   2438           00297         call DELENO10
                      00298         ; preteceni := pomocna mod 10
                      00299         ; pomocna := pomocna div 10
040B   0837           00300         movfw PRETECENI
040C   00A1           00301         movwf TMP1                      ; zaloha jednotek minut
040D   2438           00302         call DELENO10
040E   0840           00303         movfw POMOCNA1  
040F   39FF           00304         andlw h'FF'
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00305 
0410   1903           00306         btfsc STATUS,Z
0411   2C14           00307         goto $+3
0412   3E30           00308         addlw .48
0413   2C15           00309         goto $+2
0414   3020           00310         movlw ' '
0415   20A8           00311         call ZAPISD                     ; stovky minut
                      00312 
0416   0837           00313         movfw PRETECENI
0417   3E30           00314         addlw .48
0418   20A8           00315         call ZAPISD                     ; desitky minut
                      00316 
0419   0821           00317         movfw TMP1
041A   3E30           00318         addlw .48
041B   20A8           00319         call ZAPISD                     ; jednotky minut
                      00320         
                      00321 
041C   303A           00322         movlw ':'
041D   20A8           00323         call ZAPISD
                      00324 
041E   0832           00325         movfw VTERINY1
041F   00C0           00326         movwf POMOCNA1
0420   0833           00327         movfw VTERINY2
0421   00C1           00328         movwf POMOCNA2
0422   2438           00329         call DELENO10
                      00330         ; preteceni := pomocna mod 10
                      00331         ; pomocna := pomocna div 10
0423   0840           00332         movfw POMOCNA1
0424   3E30           00333         addlw .48
0425   20A8           00334         call ZAPISD
0426   0837           00335         movfw PRETECENI
0427   3E30           00336         addlw .48
0428   20A8           00337         call ZAPISD      
                      00338 
0429   0008           00339         RETURN
042A                  00340 CAS_MP3_SHOVEJ_CAS
042A   1128           00341         bcf STAV,2
                      00342 
042B   3020           00343         movlw ' '
042C   20A8           00344         call ZAPISD
042D   3020           00345         movlw ' '
042E   20A8           00346         call ZAPISD
042F   3020           00347         movlw ' '
0430   20A8           00348         call ZAPISD
0431   303A           00349         movlw ':'
0432   20A8           00350         call ZAPISD
0433   3020           00351         movlw ' '
0434   20A8           00352         call ZAPISD
0435   3020           00353         movlw ' '
0436   20A8           00354         call ZAPISD
0437   0008           00355         return
                      00356 
                      00357 ;**********************************************************
                      00358 ;----------------------------------------------------------------------------
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0438                  00359 DELENO10
                      00360         ; preteceni := pomocna mod 10
                      00361         ; pomocna := pomocna div 10
                      00362         ; zpusob deleni je podobny jako u PREVOD
0438   01B7           00363         CLRF  PRETECENI                 ; PRETECENI := 0
0439   3010           00364         MOVLW .16                               ; // pomocna ma 16bitu
043A   00B6           00365         MOVWF COUNTER
043B                  00366 DELENO10_LOOP
043B   0DC0           00367         RLF POMOCNA1,f
043C   0DC1           00368         RLF POMOCNA2,f
043D   0DB7           00369         RLF PRETECENI,f
043E   300A           00370         MOVLW .10
043F   0237           00371         SUBWF PRETECENI,W
0440   1803           00372         BTFSc STATUS,C
0441   00B7           00373         MOVWF PRETECENI
                      00374 
0442   0DB8           00375         RLF   VYSLEDEK1,f
0443   0DB9           00376         RLF   VYSLEDEK2,f
                      00377 
0444   0BB6           00378         DECFSZ COUNTER,f
0445   2C3B           00379         GOTO  DELENO10_LOOP
                      00380 
0446   0838           00381         movfw VYSLEDEK1
0447   00C0           00382         movwf POMOCNA1
0448   0839           00383         movfw VYSLEDEK2
0449   00C1           00384         movwf POMOCNA2
044A   0008           00385         RETURN
                      00386 
                      00387 ;**************************************************************************
044B                  00388 PREVOD  ; z poctu odehranych vterin vypocita pocet odehranych minut a vterin
                      00389         ; MINUTY := VTERINY div 60      // div je celociselne deleni se zbytkem
                      00390         ; VTERINY := VTERINY mod 60     // mod je zbytek po deleni
044B   01B7           00391         CLRF  PRETECENI                 ; PRETECENI := 0
044C   3010           00392         MOVLW .16
044D   00B6           00393         MOVWF COUNTER                           
044E                  00394 PREVOD_LOOP                                     ; for (COUNTER:=0 ; COUNTER<16 ; COUNTER++):
044E   0DB2           00395         RLF   VTERINY1,1
044F   0DB3           00396         RLF   VTERINY2,1                ;       PRETECENI := (PRETECENI * 2) + (VTERINY mod 2)
0450   0DB7           00397         RLF   PRETECENI,1               ;       VTERINY := VTERINY div 2
0451   303C           00398         MOVLW .60
0452   0237           00399         SUBWF PRETECENI,W
0453   1803           00400         BTFSc STATUS,C                  ;       if (PRETECENI - 60 > 0):
0454   00B7           00401         MOVWF PRETECENI                 ;               PRETECENI := PRETECENI - 60
                      00402                                                         ;               MINUTY := (MINUTY * 2) + 1
0455   0DB4           00403         RLF   MINUTY1,1                 ;       else:
0456   0DB5           00404         RLF   MINUTY2,1                 ;               MINUTY := (MINUTY * 2)
                      00405                                                         ;       endif;
0457   0BB6           00406         DECFSZ COUNTER,1                ; endfor;
0458   2C4E           00407         GOTO  PREVOD_LOOP
                      00408 
0459   0837           00409         movfw PRETECENI
045A   00B2           00410         movwf VTERINY1
045B   01B3           00411         clrf VTERINY2
045C   0008           00412         RETURN
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00413 ;*********************************************************************
                      00414 
                      00415 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00416 ;OVLADANI
                      00417 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00418 ; 7. bit - play
                      00419 ; 6. bit - stop
                      00420 ; 5. bit - previjeni dopredu
                      00421 ; 4. bit - previjeni dozadu
                      00422 ; 3. bit - [nepouzit]
                      00423 ; 2. bit - menu
                      00424 ; 1. bit - menu up
                      00425 ; 0. bit - menu down
                      00426 
045D                  00427 PREH_OBSLUHA_TLACITEK
                      00428 ; obsluhuje udalosti jednotlivych tlacitek pri prehravani
045D   1BC4           00429         btfsc TLACITKA,7
045E   24BA           00430         CALL PLAY
045F   13C4           00431         bcf TLACITKA,7
                      00432 
0460   1EC4           00433         btfss TLACITKA,5                                ; pokud bylo stisknuto tlacitko previjeni...
0461   2C6F           00434         goto PREH_OBSLUHA_NOREWIND
0462   2193           00435         call ZPOZ_300MS
0463   12C4           00436         bcf TLACITKA,5
0464   1D85           00437         btfss TL_DOPREDU                                ; ...koukneme se zda je stale drzeno...
0465   2C76           00438         goto PREH_OBSLUHA_DALSI_MP3
                      00439 
0466   142A           00440         bsf PREH_STAV1,0                                ; ..a pokud ano, dame mp3 previjet...
0467   1429           00441         bsf PREH_STAV0,0
0468   24F4           00442         call NASTAV_STAV
                      00443 
0469   23F3           00444         call CAS_MP3
046A   2193           00445         call ZPOZ_300MS                                 ; /nebudeme to s tim vypisovanim casu prehanet/
046B   1985           00446         btfsc TL_DOPREDU
046C   2C69           00447         goto $-3
                      00448 
046D   102A           00449         bcf PREH_STAV1,0                                ; ..do okamziku, nez tlacitko pusti
046E   24F4           00450         call NASTAV_STAV        
046F                  00451 PREH_OBSLUHA_NOREWIND
046F   1A44           00452         btfsc TLACITKA,4
0470   2C72           00453         goto PREH_OBSLUHA_PREDCHOZI_MP3
                      00454 ;       CALL STOP
                      00455 ;       CALL PAUSE
0471   0008           00456         return
                      00457 ;---------------------------
0472                  00458 PREH_OBSLUHA_PREDCHOZI_MP3
0472   1244           00459         bcf TLACITKA,4
0473   3016           00460         movlw b'00010110'
0474   00A6           00461         movwf TMP5                                      ; do TMP5 dame parametry hledani
0475   2C78           00462         goto $+3
0476                  00463 PREH_OBSLUHA_DALSI_MP3
0476   3006           00464         movlw b'00000110'
0477   00A6           00465         movwf TMP5                                      ; do TMP5 dame parametry hledani
                      00466 
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0478   3009           00467         movlw h'09'
0479   21B7           00468         call WR_USART
047A   082B           00469         movfw PREH_ADR_CL1
047B   21B7           00470         call WR_USART
047C   082C           00471         movfw PREH_ADR_CL2
047D   21B7           00472         call WR_USART
047E   082D           00473         movfw PREH_ADR_CL3
047F   21B7           00474         call WR_USART
0480   082E           00475         movfw PREH_ADR_CL4
0481   21B7           00476         call WR_USART
0482   082F           00477         movfw PREH_SOUB_1
0483   21B7           00478         call WR_USART
0484   0830           00479         movfw PREH_SOUB_2
0485   21B7           00480         call WR_USART
0486   0826           00481         movfw TMP5                                      ; parametry hledani
0487   21B7           00482         call WR_USART
                      00483 
                      00484 
0488   21BF           00485         call RD_USART
0489   3C06           00486         sublw h'06'
048A   1D03           00487         btfss STATUS,Z
048B   2CA4           00488         goto PREH_OBSLUHA_NENALEZENO
                      00489         ; nasli jsme mp3
048C   300F           00490         movlw .15
048D   00A1           00491         movwf TMP1
048E   21C3           00492         call USART_PRESKOC
048F   21BF           00493         call RD_USART
0490   00AF           00494         movwf PREH_SOUB_1
0491   21BF           00495         call RD_USART
0492   00B0           00496         movwf PREH_SOUB_2
                      00497 
0493   3080           00498         movlw h'80'             ; prikaz pro hrani mp3
0494   21B7           00499         CALL WR_USART
0495   082B           00500         movfw PREH_ADR_CL1
0496   21B7           00501     CALL WR_USART
0497   082C           00502         movfw PREH_ADR_CL2
0498   21B7           00503         CALL WR_USART
0499   082D           00504         movfw PREH_ADR_CL3
049A   21B7           00505     CALL WR_USART
049B   082E           00506         movfw PREH_ADR_CL4
049C   21B7           00507     CALL WR_USART
049D   082F           00508         movfw PREH_SOUB_1
049E   21B7           00509     CALL WR_USART
049F   0830           00510         movfw PREH_SOUB_2
04A0   21B7           00511     CALL WR_USART
04A1   21BF           00512         CALL RD_USART
                      00513 
04A2   1529           00514         bsf PREH_STAV0,2                        ; nastavime tento bit, protoze se zmenila prehravana mp3
                                    
04A3   0008           00515         return
04A4                  00516 PREH_OBSLUHA_NENALEZENO
04A4   3011           00517         movlw .17
04A5   00A1           00518         movwf TMP1
04A6   21C3           00519         call USART_PRESKOC
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04A7   0008           00520         return
                      00521 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00522 
04A8                  00523 TEST_TLAC
                      00524 
04A8   1E05           00525         btfss TL_VOLUME_UP              
04A9   2CB5           00526         goto TEST_TLAC_NO_MUTE  
04AA   1E85           00527         btfss TL_VOLUME_DOWN
04AB   2CB5           00528         goto TEST_TLAC_NO_MUTE          ; jeslize jsou stisknuta obe tlatitka hlasitosti, dame MUTE
04AC                  00529 TEST_TLAC_MUTE
04AC   162A           00530         bsf PREH_STAV1,4
04AD   24F4           00531         call NASTAV_STAV
04AE   19A8           00532         btfsc STAV,3
04AF   23B8           00533         call ZOBRAZ_HLASITOST
04B0   21A0           00534         call ZPOZ_20MS
04B1   21A0           00535         call ZPOZ_20MS
04B2   21A0           00536         call ZPOZ_20MS
04B3   21A0           00537         call ZPOZ_20MS                          ; protoze se nikdy nepovede pustit tlacitka soucasne, pr
                            oto tato prodleva
04B4   2CB9           00538         goto TEST_TLAC_KONHLAS
                      00539 
04B5                  00540 TEST_TLAC_NO_MUTE
04B5   1A05           00541         BTFSC TL_VOLUME_UP              
04B6   24C2           00542         CALL VOLUME_UP
                      00543 
04B7   1A85           00544         BTFSC TL_VOLUME_DOWN            
04B8   24DB           00545         CALL VOLUME_DOWN
04B9                  00546 TEST_TLAC_KONHLAS
                      00547 
04B9   0008           00548         RETURN
                      00549 
                      00550 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
04BA                  00551 PLAY
04BA   1C29           00552         btfss PREH_STAV0,0
04BB   2CBE           00553         goto $+3
04BC   1029           00554         bcf PREH_STAV0,0
04BD   2CBF           00555         goto $+2
04BE   1429           00556         bsf PREH_STAV0,0
                      00557 
04BF   102A           00558         bcf PREH_STAV1,0
04C0   24F4           00559         CALL NASTAV_STAV
04C1   0008           00560         return
                      00561 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00562 ;PAUSE
                      00563 ;       btfss PREH_STAV0,0
                      00564 ;       goto  $+5
                      00565 ;       bcf       PREH_STAV0,0
                      00566 ;       MOVFW PREH_STAV0
                      00567 ;       CALL WR_USART
                      00568 ;       return
                      00569 ;       bsf       PREH_STAV0,0
                      00570 ;       MOVFW PREH_STAV0
                      00571 ;       CALL WR_USART
                      00572 ;       CALL RD_USART
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00573 ;       RETURN
                      00574 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00575 
04C2                  00576 VOLUME_UP
04C2   1E2A           00577         btfss PREH_STAV1,4
04C3   2CC6           00578         goto $+3
04C4   122A           00579         bcf PREH_STAV1,4
04C5   24F4           00580         call NASTAV_STAV                        ; jestli predtim bylo mute, vypneme
                      00581 
04C6   3002           00582         movlw .2
04C7   0727           00583         addwf AKTUAL_HLAS,w
04C8   1C03           00584         btfss STATUS,C
04C9   2CCB           00585         goto VOLUME_UP_OK
04CA   0008           00586         return                                          ; pokud je jiz hlasitost maximalni, nemuzeme ji 
                            zvetsovat
                      00587 
04CB                  00588 VOLUME_UP_OK
04CB   3082           00589         MOVLW h'82'
04CC   21B7           00590         CALL WR_USART
04CD   0AA7           00591         incf AKTUAL_HLAS,f
04CE   0AA7           00592         incf AKTUAL_HLAS,f                      ; protoze hlasitost ma pomeren dost kroku, pricitame po 
                            2
04CF   0827           00593         MOVFW AKTUAL_HLAS
04D0   3CFF           00594         sublw h'FF'
04D1   21B7           00595         CALL WR_USART
04D2   0827           00596         MOVFW AKTUAL_HLAS
04D3   3CFF           00597         sublw h'FF'
04D4   21B7           00598         CALL WR_USART
04D5   21A0           00599         call ZPOZ_20MS                          ; kdyz se neprehrava mp3 je odezva obsluzneho procesoru 
                            temer okamzita
04D6   21A0           00600         call ZPOZ_20MS                          ; proto tady cekame, aby zmena hlasitosti nebyla moc ryc
                            hla (kdyz se neprehrava)
04D7   21BF           00601         CALL RD_USART
04D8   19A8           00602         btfsc STAV,3
04D9   23B8           00603         call ZOBRAZ_HLASITOST
04DA   0008           00604         RETURN
                      00605 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
04DB                  00606 VOLUME_DOWN
04DB   1E2A           00607         btfss PREH_STAV1,4
04DC   2CDF           00608         goto $+3
04DD   122A           00609         bcf PREH_STAV1,4
04DE   24F4           00610         call NASTAV_STAV                        ; jestli predtim bylo mute, vypneme
                      00611 
04DF   3002           00612         movlw .2
04E0   0227           00613         subwf AKTUAL_HLAS,w
04E1   1803           00614         btfsc STATUS,C
04E2   2CE4           00615         goto VOLUME_DOWN_OK
04E3   0008           00616         return                                          ; pokud je jiz hlasitost minimalni, nemuzeme ji 
                            zmensovat
                      00617 
04E4                  00618 VOLUME_DOWN_OK
04E4   3082           00619     MOVLW h'82'
04E5   21B7           00620         CALL WR_USART
04E6   03A7           00621         decf AKTUAL_HLAS,f
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04E7   03A7           00622         decf AKTUAL_HLAS,f                      ; protoze hlasitost ma pomeren dost kroku, odecitame po 
                            2
04E8   0827           00623     MOVFW AKTUAL_HLAS
04E9   3CFF           00624         sublw h'FF'
04EA   21B7           00625     CALL WR_USART
04EB   0827           00626     MOVFW AKTUAL_HLAS
04EC   3CFF           00627         sublw h'FF'
04ED   21B7           00628     CALL WR_USART
04EE   21A0           00629         call ZPOZ_20MS                          ; kdyz se neprehrava mp3 je odezva obsluzneho procesoru 
                            temer okamzita
04EF   21A0           00630         call ZPOZ_20MS                          ; proto tady cekame, aby zmena hlasitosti nebyla moc ryc
                            hla (kdyz se neprehrava)
04F0   21BF           00631     CALL RD_USART
04F1   19A8           00632         btfsc STAV,3
04F2   23B8           00633         call ZOBRAZ_HLASITOST
04F3   0008           00634         RETURN
                      00635 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
04F4                  00636 NASTAV_STAV
04F4   3084           00637         movlw h'84'
04F5   21B7           00638         call WR_USART
04F6   0829           00639         movfw PREH_STAV0
04F7   21B7           00640         call WR_USART
04F8   082A           00641         movfw PREH_STAV1
04F9   21B7           00642         call WR_USART
04FA   21BF           00643         call RD_USART
04FB   0008           00644         return
                      00645 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
04FC                  00646 ZAKLADNI_NASTAVENI       
                      00647 ; nastavy vychozi hodnoty po zapnuti
04FC   3081           00648         movlw h'81'             ; vraci stav prehravani
04FD   21B7           00649         CALL WR_USART
04FE   21BF           00650     CALL RD_USART
04FF   00A9           00651         MOVWF PREH_STAV0
0500   21BF           00652         CALL RD_USART
0501   00AA           00653         MOVWF PREH_STAV1
0502   21BF           00654         CALL RD_USART
0503   21BF           00655         CALL RD_USART
0504   122A           00656         bcf PREH_STAV1,4        ; vypneme mute
0505   24F4           00657         call NASTAV_STAV
                      00658 
0506   3082           00659     MOVLW h'82'
0507   21B7           00660         CALL WR_USART
0508   0827           00661     MOVFW AKTUAL_HLAS
0509   3CFF           00662         sublw h'FF'
050A   21B7           00663     CALL WR_USART
050B   0827           00664     MOVFW AKTUAL_HLAS
050C   3CFF           00665         sublw h'FF'
050D   21B7           00666     CALL WR_USART
050E   21BF           00667     CALL RD_USART               ; nastavime hlasitost
050F   0008           00668         return
                      00669 
                      00670 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00037         include "pruzkumnik.asm"; programova smycka pro vyber souboru a oddilu
                      00001 ;*******************************************************************************************************
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            *************
                      00002 ; necha uzivatele, aby si vybral jeden z oddilu ze seznamu v bance 2 
                      00003 ; obsluzny procesor sice vycita az 4 oddily, mi ale pro jednoduchost davame na vyber
                      00004 ; pouze z prvnich tri
0510                  00005 VYBER_ODDILU
0510   2021           00006         call SMAZ_LCD
0511   2032           00007         call LCD_1RADEK
0512   01C4           00008         clrf TLACITKA
                      00009 
0513   3056           00010         movlw 'V'
0514   20A8           00011         call ZAPISD
0515   3059           00012         movlw 'Y'
0516   20A8           00013         call ZAPISD
0517   3042           00014         movlw 'B'
0518   20A8           00015         call ZAPISD
0519   3045           00016         movlw 'E'
051A   20A8           00017         call ZAPISD
051B   3052           00018         movlw 'R'
051C   20A8           00019         call ZAPISD
051D   3020           00020         movlw ' '
051E   20A8           00021         call ZAPISD
051F   304F           00022         movlw 'O'
0520   20A8           00023         call ZAPISD
0521   3044           00024         movlw 'D'
0522   20A8           00025         call ZAPISD
0523   3044           00026         movlw 'D'
0524   20A8           00027         call ZAPISD
0525   3049           00028         movlw 'I'
0526   20A8           00029         call ZAPISD
0527   304C           00030         movlw 'L'
0528   20A8           00031         call ZAPISD
                      00032 
0529   01A4           00033         clrf TMP3                       ; kolikaty oddil ted prozkoumavame
052A   01A5           00034         clrf TMP4                       ; kolik oddilu obsahuje disk
052B   01A6           00035         clrf TMP5                       ; na ktery ukazuje sipka
                      00036         INDF_BANK_2
052C   1783               M                         bsf STATUS,IRP    
                      00037 
052D                  00038 VYBER_ODDILU_VYPIS
052D   0824           00039         movfw TMP3
052E   39FF           00040         andlw h'FF'
052F   1903           00041         btfsc STATUS,Z
0530   2035           00042         call LCD_2RADEK
0531   3C01           00043         sublw .1
0532   1903           00044         btfsc STATUS,Z
0533   2038           00045         call LCD_3RADEK
0534   0824           00046         movfw TMP3
0535   3C02           00047         sublw .2
0536   1903           00048         btfsc STATUS,Z
0537   203B           00049         call LCD_4RADEK
                      00050 
0538   300B           00051         movlw .11
0539   00A1           00052         movwf TMP1
053A   0E24           00053         swapf TMP3,w            ; w := TMP3 * 16
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

053B   3E10           00054         addlw h'10'
053C   0084           00055         movwf FSR
053D   0800           00056         movfw INDF
053E   39FF           00057         andlw h'FF'
053F   1903           00058         btfsc STATUS,Z
0540   2D57           00059         goto VYBER_ODDILU_POSLEDNI      ; stavovy byte byl nula, vice oddilu tu neni
                      00060         
0541   3020           00061         movlw ' '                       ; odsazeni pro sipku
0542   20A8           00062         call ZAPISD
0543   0824           00063         movfw TMP3
0544   3E31           00064         addlw .49                       ; cislo oddilu
0545   20A8           00065         call ZAPISD
0546   302E           00066         movlw '.'
0547   20A8           00067         call ZAPISD
0548   3020           00068         movlw ' '
0549   20A8           00069         call ZAPISD
                      00070 
054A   0804           00071         movfw FSR
054B   3E05           00072         addlw .5
054C   0084           00073         movwf FSR
054D                  00074 VYBER_ODDILU_JMENO
054D   0800           00075         movfw INDF
054E   20A8           00076         call ZAPISD
054F   0A84           00077         incf FSR,f
                      00078         
0550   0BA1           00079         decfsz TMP1,f
0551   2D4D           00080         goto VYBER_ODDILU_JMENO 
                      00081 
0552   0AA4           00082         incf TMP3,f
0553   0824           00083         movfw TMP3
0554   3C03           00084         sublw .3
0555   1D03           00085         btfss STATUS,Z
0556   2D2D           00086         goto VYBER_ODDILU_VYPIS
                      00087 
0557                  00088 VYBER_ODDILU_POSLEDNI
0557   03A4           00089         decf TMP3,f
                      00090 
0558                  00091 VYBER_ODDILU_SIPKY
0558   0826           00092         movfw TMP5
0559   39FF           00093         andlw h'FF'     
055A   1903           00094         btfsc STATUS,Z
055B   2729           00095         call SIPKA_2RADEK
055C   3C01           00096         sublw .1
055D   1903           00097         btfsc STATUS,Z
055E   2733           00098         call SIPKA_3RADEK
055F   0826           00099         movfw TMP5
0560   3C02           00100         sublw .2
0561   1903           00101         btfsc STATUS,Z
0562   273D           00102         call SIPKA_4RADEK
                      00103 
0563                  00104 VYBER_ODDILU_CEKEJ
0563   18C4           00105         btfsc TLACITKA,1
0564   2D83           00106         goto VYBER_ODDILU_SIPKA_UP
0565   1844           00107         btfsc TLACITKA,0
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0566   2D89           00108         goto VYBER_ODDILU_SIPKA_DOWN
                      00109         
0567   1EC4           00110         btfss TLACITKA,5
0568   2D63           00111         goto VYBER_ODDILU_CEKEJ
0569   12C4           00112         bcf TLACITKA,5
                      00113 
056A   3003           00114         movlw h'03'                             ; nasvavime ten oddil, na ktery ukazuje sipka
056B   21B7           00115         call WR_USART
056C   0E26           00116         swapf TMP5,w            ; w := TMP3 * 16
056D   3E11           00117         addlw h'11'
056E   0084           00118         movwf FSR
056F   0800           00119         movfw INDF      
0570   21B7           00120         call WR_USART
0571   0A84           00121         incf FSR,f
0572   0800           00122         movfw INDF      
0573   21B7           00123         call WR_USART
0574   0A84           00124         incf FSR,f
0575   0800           00125         movfw INDF      
0576   21B7           00126         call WR_USART
0577   0A84           00127         incf FSR,f
0578   0800           00128         movfw INDF      
0579   21B7           00129         call WR_USART
                      00130 
057A   21BF           00131         call RD_USART
057B   00A1           00132         movwf TMP1
057C   1A21           00133         btfsc TMP1,4            ; Pokud je nastaven 4. bit vráceného bytu, znamená to, že spouštìcí 
                      00134                                                 ; záznam svazku byl korektnì naèten.    
057D   0008           00135         return
057E   22F0           00136         call HLASKA_CHYBAODDILU
057F   217D           00137         call ZPOZ_1S
0580   217D           00138         call ZPOZ_1S
0581   217D           00139         call ZPOZ_1S
0582   2D10           00140         goto VYBER_ODDILU
                      00141         
0583                  00142 VYBER_ODDILU_SIPKA_UP
0583   10C4           00143         bcf TLACITKA,1
0584   0826           00144         movfw TMP5
0585   39FF           00145         andlw h'FF'
0586   1D03           00146         btfss STATUS,Z
0587   03A6           00147         decf TMP5,f
0588   2D58           00148         goto VYBER_ODDILU_SIPKY
0589                  00149 VYBER_ODDILU_SIPKA_DOWN
0589   1044           00150         bcf TLACITKA,0
058A   0824           00151         movfw TMP3
058B   0226           00152         subwf TMP5,w
058C   1C03           00153         btfss STATUS,C
058D   0AA6           00154         incf TMP5,f                             ; if (TMP3 > TMP5){ TMP5++ }
058E   2D58           00155         goto VYBER_ODDILU_SIPKY
                      00156 ;*******************************************************************************************************
                            *************
058F                  00157 PRUZKUMNIK
                      00158 ; v bufferu2 (bance 2) je dlouhy nazev adresare, ktery prave prochazime
                      00159 ; v bufferu1 (bance 3) je dlouhy nazev adresare, ktery se prave prehrava
                      00160 ; to znamena, ze pokud vybereme nejakou mp3, musime nakopirovat obsah bufferu2 do bufferu1      
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00161         PROG_PAGE_1
058F   158A               M                         bsf PCLATH,3
0590   120A               M                         bcf PCLATH,4
0591   2018           00162         call COPY_BUFFER1_TO_2
                      00163         PROG_PAGE_0
0592   118A               M                         bcf PCLATH,3
0593   120A               M                         bcf PCLATH,4
0594   082B           00164         movfw PREH_ADR_CL1
0595   00C6           00165         movwf PROCHAZENY_ADR1
0596   082C           00166         movfw PREH_ADR_CL2
0597   00C7           00167         movwf PROCHAZENY_ADR2
0598   082D           00168         movfw PREH_ADR_CL3
0599   00C8           00169         movwf PROCHAZENY_ADR3
059A   082E           00170         movfw PREH_ADR_CL4
059B   00C9           00171         movwf PROCHAZENY_ADR4
                      00172 
059C                  00173 PRUZKUMNIK_ZMENA_SLOZKY
059C   2021           00174         call SMAZ_LCD
059D   2032           00175         call LCD_1RADEK
                      00176 
059E   3014           00177         movlw .20
059F   00A1           00178         movwf TMP1
05A0   3011           00179         movlw h'11'
05A1   0084           00180         movwf FSR
05A2                  00181 PRUZKUMNIK_JM_ADRESARE
05A2   0800           00182         movfw INDF
05A3   3CFF           00183         sublw h'FF'
05A4   1903           00184         btfsc STATUS,Z
05A5   2DAB           00185         goto PRUZKUMNIK_JM_ADRESARE_K
05A6   0800           00186         movfw INDF
05A7   20A8           00187         call ZAPISD
05A8   0A84           00188         incf FSR,f
05A9   0BA1           00189         decfsz TMP1,f
05AA   2DA2           00190         goto PRUZKUMNIK_JM_ADRESARE
05AB                  00191 PRUZKUMNIK_JM_ADRESARE_K
05AB   3009           00192         movlw h'09'
05AC   21B7           00193         call WR_USART
05AD   0846           00194         movfw PROCHAZENY_ADR1
05AE   21B7           00195         call WR_USART
05AF   0847           00196         movfw PROCHAZENY_ADR2
05B0   21B7           00197         call WR_USART
05B1   0848           00198         movfw PROCHAZENY_ADR3
05B2   21B7           00199         call WR_USART
05B3   0849           00200         movfw PROCHAZENY_ADR4
05B4   21B7           00201         call WR_USART
05B5   21B7           00202         call WR_USART
05B6   21B7           00203         call WR_USART                   ; hledame prvni zaznam, proto na techto bytech nezalezi
05B7   3008           00204         movlw b'00001000'               ; hledame prvni zaznam
05B8   21B7           00205         call WR_USART
                      00206         
05B9   2035           00207         call LCD_2RADEK
05BA   01CC           00208         clrf ZPUSOB
05BB   01A4           00209         clrf TMP3                               ; kolik zaznamu je vypsano
05BC   01A3           00210         clrf TMP2                               ; kolikaty zaznam vypisujeme na LCD
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

05BD   01A5           00211         clrf TMP4                               ; na kolikaty zaznam na LCD ukazuje sipka
05BE   01D0           00212         clrf ZAZNAM1_TYP
05BF   01D8           00213         clrf ZAZNAM2_TYP
05C0   01E0           00214         clrf ZAZNAM3_TYP
05C1   2DDF           00215         goto PRUZKUMNIK_VYPIS_PRIJEM
05C2                  00216 PRUZKUMNIK_VYPIS
05C2   0823           00217         movfw TMP2
05C3   39FF           00218         andlw h'FF'
05C4   1903           00219         btfsc STATUS,Z
05C5   2035           00220         call LCD_2RADEK
05C6   3C01           00221         sublw .1
05C7   1903           00222         btfsc STATUS,Z
05C8   2038           00223         call LCD_3RADEK
05C9   0823           00224         movfw TMP2
05CA   3C02           00225         sublw .2
05CB   1903           00226         btfsc STATUS,Z
05CC   203B           00227         call LCD_4RADEK
                      00228 
05CD   3009           00229         movlw h'09'
05CE   21B7           00230         call WR_USART
05CF   0846           00231         movfw PROCHAZENY_ADR1
05D0   21B7           00232         call WR_USART
05D1   0847           00233         movfw PROCHAZENY_ADR2
05D2   21B7           00234         call WR_USART
05D3   0848           00235         movfw PROCHAZENY_ADR3
05D4   21B7           00236         call WR_USART
05D5   0849           00237         movfw PROCHAZENY_ADR4
05D6   21B7           00238         call WR_USART
05D7   084A           00239         movfw AKTUALNI_ZAZNAM1
05D8   21B7           00240         call WR_USART
05D9   084B           00241         movfw AKTUALNI_ZAZNAM2
05DA   21B7           00242         call WR_USART
                      00243         
05DB   3010           00244         movlw b'00010000'               ; hledame predchozi zaznam
05DC   1C4C           00245         btfss ZPUSOB,0
05DD   3000           00246         movlw b'00000000'               ; hledame nasledujici zaznam
05DE   21B7           00247         call WR_USART
05DF                  00248 PRUZKUMNIK_VYPIS_PRIJEM
                      00249         ; USERTem nam ted prijde odpoved na prikaz 09h
                      00250         INDF_BANK_0
05DF   1383               M                         bcf STATUS,IRP    
05E0   0823           00251         movfw TMP2                              ; kolikaty zaznam vypisujeme na LCD
05E1   00A1           00252         movwf TMP1
05E2   1003           00253         bcf STATUS,C
05E3   0DA1           00254         rlf TMP1,f                              ; * 2
05E4   0DA1           00255         rlf TMP1,f                              ; * 4
05E5   0D21           00256         rlf TMP1,w                              ; * 8
05E6   3E50           00257         addlw h'50'
05E7   0084           00258         movwf FSR                               ; ZAZNAM X _TYP
                      00259 
05E8   3020           00260         movlw ' '
05E9   20A8           00261         call ZAPISD                             ; odsazeni pro sipku
05EA   21BF           00262         call RD_USART
05EB   00A6           00263         movwf TMP5
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

05EC   0080           00264         movwf INDF
05ED   0A84           00265         incf FSR,f
05EE   39FF           00266         andlw h'FF'
05EF   1903           00267         btfsc STATUS,Z
05F0   2E82           00268         goto PRUZKUMNIK_VYPIS_KONCIME
                      00269 
05F1   3C06           00270         sublw .6
05F2   302F           00271         movlw '/'
05F3   1903           00272         btfsc STATUS,Z
05F4   3020           00273         movlw ' '
05F5   20A8           00274         call ZAPISD                             ; prvni znak podle typu (slozka lomitko, mp3 mezera)
                      00275 
05F6   3008           00276         movlw .8
05F7   00A1           00277         movwf TMP1
05F8   21BF           00278         call RD_USART
05F9   2203           00279         call PREVED_ZNAK
05FA   20A8           00280         call ZAPISD
05FB   0BA1           00281         decfsz TMP1,f
05FC   2DF8           00282         goto $-4                                ; vypis jmena
                      00283 
05FD   3020           00284         movlw ' '
05FE   1C26           00285         btfss TMP5,0
05FF   302E           00286         movlw '.'                               ; tecka mezi jmenem a priponou
0600   20A8           00287         call ZAPISD
                      00288 
0601   3003           00289         movlw .3
0602   00A1           00290         movwf TMP1
0603   21BF           00291         call RD_USART
0604   2203           00292         call PREVED_ZNAK
0605   20A8           00293         call ZAPISD
0606   0BA1           00294         decfsz TMP1,f
0607   2E03           00295         goto $-4                                ; vypis pripony 
                      00296 
0608   21BF           00297         call RD_USART
0609   0080           00298         movwf INDF
060A   0A84           00299         incf FSR,f
060B   21BF           00300         call RD_USART
060C   0080           00301         movwf INDF
060D   0A84           00302         incf FSR,f
060E   21BF           00303         call RD_USART
060F   0080           00304         movwf INDF
0610   0A84           00305         incf FSR,f
0611   21BF           00306         call RD_USART
0612   0080           00307         movwf INDF
0613   0A84           00308         incf FSR,f
                      00309 
0614   21BF           00310         call RD_USART
0615   00CA           00311         movwf AKTUALNI_ZAZNAM1
0616   0080           00312         movwf INDF
0617   0A84           00313         incf FSR,f
0618   21BF           00314         call RD_USART
0619   00CB           00315         movwf AKTUALNI_ZAZNAM2
061A   0080           00316         movwf INDF
061B   0A84           00317         incf FSR,f
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00318 
061C   0AA4           00319         incf TMP3,f                             ; kolik zaznamu je vypsano
                      00320 
061D   1C4C           00321         btfss ZPUSOB,0
061E   2E25           00322         goto PRUZKUMNIK_VYPIS_INC
061F   0823           00323         movfw TMP2
0620   39FF           00324         andlw h'FF'
0621   1903           00325         btfsc STATUS,Z
0622   2E2B           00326         goto PRUZKUMNIK_SIPKY
0623   03A3           00327         decf TMP2,f
0624   2DC2           00328         goto PRUZKUMNIK_VYPIS
0625                  00329 PRUZKUMNIK_VYPIS_INC
0625   0AA3           00330         incf TMP2,f
0626   0823           00331         movfw TMP2
0627   3C03           00332         sublw .3
0628   1D03           00333         btfss STATUS,Z
0629   2DC2           00334         goto PRUZKUMNIK_VYPIS
062A   03A3           00335         decf TMP2,f
                      00336         
062B                  00337 PRUZKUMNIK_SIPKY
062B   0825           00338         movfw TMP4
062C   39FF           00339         andlw h'FF'     
062D   1903           00340         btfsc STATUS,Z
062E   2729           00341         call SIPKA_2RADEK
062F   3C01           00342         sublw .1
0630   1903           00343         btfsc STATUS,Z
0631   2733           00344         call SIPKA_3RADEK
0632   0825           00345         movfw TMP4
0633   3C02           00346         sublw .2
0634   1903           00347         btfsc STATUS,Z
0635   273D           00348         call SIPKA_4RADEK
                      00349 
0636                  00350 PRUZKUMNIK_VYBER
0636   11A8           00351         bcf STAV,3                                              ; 3. bit = 1 => pri zmene hlasitosti se 
                            vypise hlasitost na LCD 
0637   24A8           00352         CALL TEST_TLAC                                  ; aby v teto casti programu chodila hlasitost
                      00353 
0638   18C4           00354         btfsc TLACITKA,1
0639   2E86           00355         goto PRUZKUMNIK_SIPKA_UP
063A   1844           00356         btfsc TLACITKA,0
063B   2EA1           00357         goto PRUZKUMNIK_SIPKA_DOWN
                      00358 
063C   1AC4           00359         btfsc TLACITKA,5
063D   2E41           00360         goto PRUZKUMNIK_TLAC_VYBER
063E   1A44           00361         btfsc TLACITKA,4
063F   2E7E           00362         goto PRUZKUMNIK_TLAC_ZPET
0640   2E36           00363         goto PRUZKUMNIK_VYBER
                      00364 
                      00365 
0641                  00366 PRUZKUMNIK_TLAC_VYBER
                      00367         INDF_BANK_0
0641   1383               M                         bcf STATUS,IRP    
0642   12C4           00368         bcf TLACITKA,5
0643   0825           00369         movfw TMP4                              ; kam ukazuje sipka
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0644   00A1           00370         movwf TMP1
0645   1003           00371         bcf STATUS,C
0646   0DA1           00372         rlf TMP1,f                              ; * 2
0647   0DA1           00373         rlf TMP1,f                              ; * 4
0648   0D21           00374         rlf TMP1,w                              ; * 8
0649   3E50           00375         addlw h'50'
064A   0084           00376         movwf FSR                               ; ZAZNAM X _TYP
064B   0800           00377         movfw INDF
064C   0A84           00378         incf FSR,f
064D   3C01           00379         sublw .1
064E   1D03           00380         btfss STATUS,Z
064F   2E65           00381         goto PRUZKUMNIK_VYBRANA_MP3
0650                  00382 PRUZKUMNIK_VYBRANA_SLOZKA
                      00383 ;       movfw PROCHAZENY_ADR1
                      00384 ;       movwf ADRESAR1
                      00385 ;       movfw PROCHAZENY_ADR2
                      00386 ;       movwf ADRESAR2
                      00387 ;       movfw PROCHAZENY_ADR3
                      00388 ;       movwf ADRESAR3
                      00389 ;       movfw PROCHAZENY_ADR4
                      00390 ;       movwf ADRESAR4
                      00391 
0650   0800           00392         movfw INDF
0651   00C6           00393         movwf PROCHAZENY_ADR1
0652   00E7           00394         movwf ADRESAR1
0653   0A84           00395         incf FSR,f
0654   0800           00396         movfw INDF
0655   00C7           00397         movwf PROCHAZENY_ADR2
0656   00E8           00398         movwf ADRESAR2
0657   0A84           00399         incf FSR,f
0658   0800           00400         movfw INDF
0659   00C8           00401         movwf PROCHAZENY_ADR3
065A   00E9           00402         movwf ADRESAR3
065B   0A84           00403         incf FSR,f
065C   0800           00404         movfw INDF
065D   00C9           00405         movwf PROCHAZENY_ADR4
065E   00EA           00406         movwf ADRESAR4
                      00407 ;       incf FSR,f
                      00408 
                      00409 ;       movfw INDF
                      00410 ;       movwf ZAZNAM1
                      00411 ;       incf FSR,f
                      00412 ;       movfw INDF
                      00413 ;       movwf ZAZNAM2
                      00414 ;       incf FSR,f
                      00415         
                      00416         PROG_PAGE_1
065F   158A               M                         bsf PCLATH,3
0660   120A               M                         bcf PCLATH,4
                      00417 ;       call NACTI_DLOUHY_NAZEV
0661   209F           00418         call ZJISTI_NAZEV_SLOZKY
                      00419         PROG_PAGE_0
0662   118A               M                         bcf PCLATH,3
0663   120A               M                         bcf PCLATH,4
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0664   2D9C           00420         goto PRUZKUMNIK_ZMENA_SLOZKY
                      00421 
0665                  00422 PRUZKUMNIK_VYBRANA_MP3
0665   3080           00423         movlw h'80'             ; prikaz pro hrani mp3
0666   21B7           00424         CALL WR_USART
0667   0846           00425         movfw PROCHAZENY_ADR1
0668   21B7           00426         CALL WR_USART
0669   0847           00427         movfw PROCHAZENY_ADR2
066A   21B7           00428         CALL WR_USART
066B   0848           00429         movfw PROCHAZENY_ADR3
066C   21B7           00430         CALL WR_USART
066D   0849           00431         movfw PROCHAZENY_ADR4
066E   21B7           00432         CALL WR_USART
                      00433 
066F   0804           00434         movfw FSR
0670   3E04           00435         addlw .4
0671   0084           00436         movwf FSR
0672   0800           00437         movfw INDF
0673   21B7           00438         CALL WR_USART
0674   0A84           00439         incf FSR,f
0675   0800           00440         movfw INDF
0676   21B7           00441         CALL WR_USART
0677   21BF           00442         CALL RD_USART
                      00443 
                      00444         PROG_PAGE_1
0678   158A               M                         bsf PCLATH,3
0679   120A               M                         bcf PCLATH,4
067A   2025           00445         call COPY_BUFFER2_TO_1                  ; bufferu1 je nazev prehravaneho adresare, proto si tam 
                            nakopirujeme jmeno
                      00446         PROG_PAGE_0                                             ; aktualni prochazene slozky...
067B   118A               M                         bcf PCLATH,3
067C   120A               M                         bcf PCLATH,4
067D   2B23           00447         goto PREHRAVANI
                      00448 
067E                  00449 PRUZKUMNIK_TLAC_ZPET
067E   1244           00450         bcf TLACITKA,4
067F   1CA9           00451         btfss PREH_STAV0,1
0680   2E36           00452         goto PRUZKUMNIK_VYBER
0681   2B23           00453         goto PREHRAVANI                                 ; pokud je nejaky soubor k prehravani, muzeme se
                             vratit k prehravani
                      00454 
0682                  00455 PRUZKUMNIK_VYPIS_KONCIME
0682   3011           00456         movlw .17
0683   00A1           00457         movwf TMP1
0684   21C3           00458         call USART_PRESKOC
0685   2E2B           00459         goto PRUZKUMNIK_SIPKY
0686                  00460 PRUZKUMNIK_SIPKA_UP
0686   10C4           00461         bcf TLACITKA,1
0687   0825           00462         movfw TMP4
0688   39FF           00463         andlw h'FF'
0689   1903           00464         btfsc STATUS,Z
068A   2E8D           00465         goto $+3
068B   03A5           00466         decf TMP4,f
068C   2E2B           00467         goto PRUZKUMNIK_SIPKY
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00468 
                      00469         ; jdeme o stranku nahoru
068D   26F2           00470         call PREDCHOZI_ZAZNAM   ; pokud existuje predchozi zaznam, da do TMP1 1, pokud ne, da do TMP1 0
068E   0821           00471         movfw TMP1
068F   39FF           00472         andlw h'FF'
0690   1903           00473         btfsc STATUS,Z
0691   2E2B           00474         goto PRUZKUMNIK_SIPKY
                      00475 
0692   144C           00476         bsf ZPUSOB,0                    ; hledame nahoru
0693   01A4           00477         clrf TMP3                               ; kolik zaznamu je vypsano
0694   3002           00478         movlw .2
0695   00A3           00479         movwf TMP2                              ; kolikaty zaznam vypisujeme na LCD
0696   00A5           00480         movwf TMP4                              ; na kolikaty zaznam na LCD ukazuje sipka
0697   2035           00481         call LCD_2RADEK
0698   202B           00482         call LCD_SMAZ_RADEK
0699   2038           00483         call LCD_3RADEK
069A   202B           00484         call LCD_SMAZ_RADEK
069B   203B           00485         call LCD_4RADEK
069C   202B           00486         call LCD_SMAZ_RADEK
069D   01D0           00487         clrf ZAZNAM1_TYP
069E   01D8           00488         clrf ZAZNAM2_TYP
069F   01E0           00489         clrf ZAZNAM3_TYP
06A0   2DC2           00490         goto PRUZKUMNIK_VYPIS
                      00491 
06A1                  00492 PRUZKUMNIK_SIPKA_DOWN
06A1   1044           00493         bcf TLACITKA,0
06A2   0324           00494         decf TMP3,w
                      00495 ;       movlw .3
06A3   0225           00496         subwf TMP4,w
06A4   1803           00497         btfsc STATUS,C
06A5   2EA8           00498         goto $+3
06A6   0AA5           00499         incf TMP4,f                             ; if (TMP3 > TMP4){ TMP4++ }
06A7   2E2B           00500         goto PRUZKUMNIK_SIPKY
                      00501 
                      00502         ; jdeme o stranku dolu
06A8   26BB           00503         call DALSI_ZAZNAM               ; pokud existuje dalsi zaznam, da do TMP1 1, pokud ne, da do TMP
                            1 0
06A9   0821           00504         movfw TMP1
06AA   39FF           00505         andlw h'FF'
06AB   1903           00506         btfsc STATUS,Z
06AC   2E2B           00507         goto PRUZKUMNIK_SIPKY
                      00508 
06AD   01CC           00509         clrf ZPUSOB                             ; hledame dolu
06AE   01A4           00510         clrf TMP3                               ; kolik zaznamu je vypsano
06AF   01A3           00511         clrf TMP2                               ; kolikaty zaznam vypisujeme na LCD
06B0   01A5           00512         clrf TMP4                               ; na kolikaty zaznam na LCD ukazuje sipka
06B1   2035           00513         call LCD_2RADEK
06B2   202B           00514         call LCD_SMAZ_RADEK
06B3   2038           00515         call LCD_3RADEK
06B4   202B           00516         call LCD_SMAZ_RADEK
06B5   203B           00517         call LCD_4RADEK
06B6   202B           00518         call LCD_SMAZ_RADEK
06B7   01D0           00519         clrf ZAZNAM1_TYP
06B8   01D8           00520         clrf ZAZNAM2_TYP
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

06B9   01E0           00521         clrf ZAZNAM3_TYP
06BA   2DC2           00522         goto PRUZKUMNIK_VYPIS
                      00523 ;*******************************************************************************************************
                            *************
06BB                  00524 DALSI_ZAZNAM
                      00525 ; pokud existuje dalsi zaznam, da do TMP1 1, pokud ne, da do TMP1 0
                      00526 ; do AKTUALNI_ZAZNAM1 da cislo posledniho zaznamu na strance
06BB   01A1           00527         clrf TMP1
06BC   0850           00528         movfw ZAZNAM1_TYP
06BD   0458           00529         iorwf ZAZNAM2_TYP,w
06BE   0460           00530         iorwf ZAZNAM3_TYP,w
06BF   1903           00531         btfsc STATUS,Z
06C0   0008           00532         return                                          ; poud je stranka prazda, dalsi zaznam neexistuj
                            e
                      00533 
06C1   3009           00534         movlw h'09'
06C2   21B7           00535         call WR_USART
06C3   0846           00536         movfw PROCHAZENY_ADR1
06C4   21B7           00537         call WR_USART
06C5   0847           00538         movfw PROCHAZENY_ADR2
06C6   21B7           00539         call WR_USART
06C7   0848           00540         movfw PROCHAZENY_ADR3
06C8   21B7           00541         call WR_USART
06C9   0849           00542         movfw PROCHAZENY_ADR4
06CA   21B7           00543         call WR_USART
                      00544 
06CB   0850           00545         movfw ZAZNAM1_TYP
06CC   39FF           00546         andlw h'FF'
06CD   1903           00547         btfsc STATUS,Z
06CE   2ED1           00548         goto $+3
06CF   3055           00549         movlw h'55'
06D0   0084           00550         movwf FSR
                      00551 
06D1   0858           00552         movfw ZAZNAM2_TYP
06D2   39FF           00553         andlw h'FF'
06D3   1903           00554         btfsc STATUS,Z
06D4   2ED7           00555         goto $+3
06D5   305D           00556         movlw h'5D'
06D6   0084           00557         movwf FSR
                      00558 
06D7   0860           00559         movfw ZAZNAM3_TYP
06D8   39FF           00560         andlw h'FF'
06D9   1903           00561         btfsc STATUS,Z
06DA   2EDD           00562         goto $+3
06DB   3065           00563         movlw h'65'
06DC   0084           00564         movwf FSR
                      00565 
06DD   0800           00566         movfw INDF
06DE   00CA           00567         movwf AKTUALNI_ZAZNAM1
06DF   21B7           00568         call WR_USART
06E0   0A84           00569         incf FSR,f
06E1   0800           00570         movfw INDF
06E2   00CB           00571         movwf AKTUALNI_ZAZNAM2
06E3   21B7           00572         call WR_USART
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00573         
                      00574         ;movlw b'00010000'              ; hledame predchozi zaznam
06E4   3000           00575         movlw b'00000000'               ; hledame nasledujici zaznam
06E5   21B7           00576         call WR_USART
                      00577 
06E6   21BF           00578         call RD_USART
06E7   00A6           00579         movwf TMP5
                      00580 
06E8   3011           00581         movlw .17
06E9   00A1           00582         movwf TMP1
06EA   21C3           00583         call USART_PRESKOC
                      00584 
06EB   01A1           00585         clrf TMP1
06EC   0826           00586         movfw TMP5
06ED   39FF           00587         andlw h'FF'
06EE   1903           00588         btfsc STATUS,Z
06EF   0008           00589         return
06F0   1421           00590         bsf TMP1,0
06F1   0008           00591         return
                      00592 ;*******************************************************************************************************
                            *************
06F2                  00593 PREDCHOZI_ZAZNAM
                      00594 ; pokud existuje predchozi zaznam, da do TMP1 1, pokud ne, da do TMP1 0
                      00595 ; do AKTUALNI_ZAZNAM1 da cislo prvniho zaznamu na strance
06F2   01A1           00596         clrf TMP1
06F3   0850           00597         movfw ZAZNAM1_TYP
06F4   0458           00598         iorwf ZAZNAM2_TYP,w
06F5   0460           00599         iorwf ZAZNAM3_TYP,w
06F6   1903           00600         btfsc STATUS,Z
06F7   0008           00601         return                                          ; poud je stranka prazda, dalsi zaznam neexistuj
                            e
                      00602 
06F8   3009           00603         movlw h'09'
06F9   21B7           00604         call WR_USART
06FA   0846           00605         movfw PROCHAZENY_ADR1
06FB   21B7           00606         call WR_USART
06FC   0847           00607         movfw PROCHAZENY_ADR2
06FD   21B7           00608         call WR_USART
06FE   0848           00609         movfw PROCHAZENY_ADR3
06FF   21B7           00610         call WR_USART
0700   0849           00611         movfw PROCHAZENY_ADR4
0701   21B7           00612         call WR_USART
                      00613 
0702   0860           00614         movfw ZAZNAM3_TYP
0703   39FF           00615         andlw h'FF'
0704   1903           00616         btfsc STATUS,Z
0705   2F08           00617         goto $+3
0706   3065           00618         movlw h'65'
0707   0084           00619         movwf FSR
                      00620 
0708   0858           00621         movfw ZAZNAM2_TYP
0709   39FF           00622         andlw h'FF'
070A   1903           00623         btfsc STATUS,Z
070B   2F0E           00624         goto $+3
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

070C   305D           00625         movlw h'5D'
070D   0084           00626         movwf FSR
                      00627 
070E   0850           00628         movfw ZAZNAM1_TYP
070F   39FF           00629         andlw h'FF'
0710   1903           00630         btfsc STATUS,Z
0711   2F14           00631         goto $+3
0712   3055           00632         movlw h'55'
0713   0084           00633         movwf FSR
                      00634 
0714   0800           00635         movfw INDF
0715   00CA           00636         movwf AKTUALNI_ZAZNAM1
0716   21B7           00637         call WR_USART
0717   0A84           00638         incf FSR,f
0718   0800           00639         movfw INDF
0719   00CB           00640         movwf AKTUALNI_ZAZNAM2
071A   21B7           00641         call WR_USART
                      00642         
071B   3010           00643         movlw b'00010000'               ; hledame predchozi zaznam
                      00644         ;movlw b'00000000'              ; hledame nasledujici zaznam
071C   21B7           00645         call WR_USART
                      00646 
071D   21BF           00647         call RD_USART
071E   00A6           00648         movwf TMP5
                      00649 
071F   3011           00650         movlw .17
0720   00A1           00651         movwf TMP1
0721   21C3           00652         call USART_PRESKOC
                      00653 
0722   01A1           00654         clrf TMP1
0723   0826           00655         movfw TMP5
0724   39FF           00656         andlw h'FF'
0725   1903           00657         btfsc STATUS,Z
0726   0008           00658         return
0727   1421           00659         bsf TMP1,0
0728   0008           00660         return
                      00661 ;*******************************************************************************************************
                            *************
0729                  00662 SIPKA_2RADEK
0729   2035           00663         call LCD_2RADEK
072A   303E           00664         MOVLW '>'
072B   20A8           00665         CALL ZAPISD
072C   2038           00666         call LCD_3RADEK
072D   3020           00667         MOVLW ' '
072E   20A8           00668         CALL ZAPISD
072F   203B           00669         call LCD_4RADEK
0730   3020           00670         MOVLW ' '
0731   20A8           00671         CALL ZAPISD
0732   0008           00672         return
                      00673 ;*******************************************************************************************************
                            *************
0733                  00674 SIPKA_3RADEK
0733   2035           00675         call LCD_2RADEK
0734   3020           00676         MOVLW ' '
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0735   20A8           00677         CALL ZAPISD
0736   2038           00678         call LCD_3RADEK
0737   303E           00679         MOVLW '>'
0738   20A8           00680         CALL ZAPISD
0739   203B           00681         call LCD_4RADEK
073A   3020           00682         MOVLW ' '
073B   20A8           00683         CALL ZAPISD
073C   0008           00684         return
                      00685 ;*******************************************************************************************************
                            *************
073D                  00686 SIPKA_4RADEK
073D   2035           00687         call LCD_2RADEK
073E   3020           00688         MOVLW ' '
073F   20A8           00689         CALL ZAPISD
0740   2038           00690         call LCD_3RADEK
0741   3020           00691         MOVLW ' '
0742   20A8           00692         CALL ZAPISD
0743   203B           00693         call LCD_4RADEK
0744   303E           00694         MOVLW '>'
0745   20A8           00695         CALL ZAPISD
0746   0008           00696         return
                      00697 ;*******************************************************************************************************
                            *************
                      00038 ;**********************************************************
0000                  00039  org 0x0000
0000   28C4           00040         goto START
0004                  00041  org 0x0004
0004   00F0           00042         movwf TEMP_WORKING
0005   0803           00043         movfw STATUS
0006   00F1           00044         movwf TEMP_STATUS
0007   0804           00045         movfw FSR
0008   00F2           00046         movwf TEMP_FSR
0009   080A           00047         movfw PCLATH
000A   00F3           00048         movwf TEMP_PCLATH
000B   018A           00049         clrf PCLATH
                      00050         BANK_0
000C   1303               M                 bcf     STATUS,RP1              ; BANK0  RP1:RP0 = 00
000D   1283               M                 bcf     STATUS,RP0    
                      00051         INDF_BANK_0
000E   1383               M                         bcf STATUS,IRP    
000F   292B           00052         goto INTERRUPT
0800                  00053  org 0x0800                                     ; PAGE 1
                      00054         include "ostatni.asm"   ; par podprogramu, ktere se casto nepouzivaji a v prvni strance by zabir
                            ali misto
                      00001 ;**********************************************************
                      00002 ; protoze vlastni program zabira temer celou nultou stranku programu, 
                      00003 ; umistil jsem nektere mene dulezite podprogramy do stranky prvni
                      00004 ;**********************************************************
0800                  00005 CLEAR_BUFFER2           ; BUFFER2 je 64bytu dat v bance 2 na adrese 0x110 - 0x14F
                      00006                                         ; pouziva TEMP1
0800   3040           00007         movlw .64
0801   00A1           00008         movwf TMP1
                      00009         INDF_BANK_2             ; neprime adresovani na banku 2
0802   1783               M                         bsf STATUS,IRP    
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0803   3010           00010         movlw 0x10
0804   0084           00011         movwf FSR
0805   3000           00012         movlw .0
                      00013 
0806                  00014 CLEAR_BEFFER2__CLEAR
0806   0080           00015         movwf INDF
0807   0A84           00016         incf FSR,F
0808   0BA1           00017         decfsz TMP1,F
0809   2806           00018         goto CLEAR_BEFFER2__CLEAR
                      00019 
                      00020         INDF_BANK_0             ; neprime adresovani na banku 0
080A   1383               M                         bcf STATUS,IRP    
080B   0008           00021         return
                      00022 ;**********************************************************
080C                  00023 CLEAR_BUFFER1           ; BUFFER1 je 64bytu dat v bance 3 na adrese 0x190 - 0x1CF
                      00024                                         ; pouziva TEMP1
080C   3040           00025         movlw .64
080D   00A1           00026         movwf TMP1
                      00027         INDF_BANK_3             ; neprime adresovani na banku 3
080E   1783               M                         bsf STATUS,IRP    
080F   3090           00028         movlw 0x90
0810   0084           00029         movwf FSR
0811   3000           00030         movlw .0
                      00031 
0812                  00032 CLEAR_BEFFER1__CLEAR
0812   0080           00033         movwf INDF
0813   0A84           00034         incf FSR,F
0814   0BA1           00035         decfsz TMP1,F
0815   2812           00036         goto CLEAR_BEFFER1__CLEAR
                      00037 
                      00038         INDF_BANK_0             ; neprime adresovani na banku 0
0816   1383               M                         bcf STATUS,IRP    
0817   0008           00039         return
                      00040 ;**************************************************************************
0818                  00041 COPY_BUFFER1_TO_2
                      00042         INDF_BANK_2             ; neprime adresovani na banku 2
0818   1783               M                         bsf STATUS,IRP    
0819   3043           00043         movlw .67
081A   00A1           00044         movwf TMP1
081B   3090           00045         movlw h'90'
081C   0084           00046         movwf FSR
081D                  00047 COPY_BUFFER1_TO_2_BYTE
081D   0800           00048         movfw INDF
081E   1384           00049         bcf FSR,7
081F   0080           00050         movwf INDF
0820   1784           00051         bsf FSR,7
0821   0A84           00052         incf FSR,f
                      00053 
0822   0BA1           00054         decfsz TMP1,f
0823   281D           00055         goto COPY_BUFFER1_TO_2_BYTE
                      00056 
0824   0008           00057         return
                      00058 ;**************************************************************************
0825                  00059 COPY_BUFFER2_TO_1
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00060         INDF_BANK_2             ; neprime adresovani na banku 2
0825   1783               M                         bsf STATUS,IRP    
0826   3043           00061         movlw .67
0827   00A1           00062         movwf TMP1
0828   3010           00063         movlw h'10'
0829   0084           00064         movwf FSR
082A                  00065 COPY_BUFFER2_TO_1_BYTE
082A   0800           00066         movfw INDF
082B   1784           00067         bsf FSR,7
082C   0080           00068         movwf INDF
082D   1384           00069         bcf FSR,7
082E   0A84           00070         incf FSR,f
                      00071 
082F   0BA1           00072         decfsz TMP1,f
0830   282A           00073         goto COPY_BUFFER2_TO_1_BYTE
                      00074 
0831   0008           00075         return
                      00076 ;**************************************************************************
0832                  00077 NACTI_DLOUHY_NAZEV
                      00078 ; k souboru ADRESAR[1-4], ZAZNAM[1-2] vycte dlouhy nazev a umisti jej do BUFFERU2
                      00079         PROG_PAGE_0
0832   118A               M                         bcf PCLATH,3
0833   120A               M                         bcf PCLATH,4
0834   300A           00080         MOVLW h'0A'             ; zjisteni dlouheho nazvu souboru....
0835   21B7           00081     CALL WR_USART
0836   0867           00082         MOVFW ADRESAR1
0837   21B7           00083         CALL WR_USART
0838   0868           00084         MOVFW ADRESAR2
0839   21B7           00085         CALL WR_USART
083A   0869           00086         MOVFW ADRESAR3
083B   21B7           00087         CALL WR_USART
083C   086A           00088         MOVFW ADRESAR4
083D   21B7           00089         CALL WR_USART
083E   086B           00090         MOVFW ZAZNAM1
083F   21B7           00091         CALL WR_USART
0840   086C           00092         MOVFW ZAZNAM2
0841   21B7           00093         CALL WR_USART
                      00094 
                      00095         INDF_BANK_2
0842   1783               M                         bsf STATUS,IRP    
0843   3010           00096         MOVLW h'10'
0844   0084           00097         MOVWF FSR
0845   3042           00098         MOVLW .66
0846   00A1           00099         MOVWF TMP1
                      00100 
0847                  00101 DLNAZEV_PRIJEM
                      00102         PROG_PAGE_0
0847   118A               M                         bcf PCLATH,3
0848   120A               M                         bcf PCLATH,4
0849   21BF           00103         CALL RD_USART
084A   2203           00104         call PREVED_ZNAK
                      00105         PROG_PAGE_1
084B   158A               M                         bsf PCLATH,3
084C   120A               M                         bcf PCLATH,4
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

084D   0080           00106         MOVWF INDF
084E   0A84           00107         INCF FSR,F
084F   0BA1           00108         DECFSZ TMP1,F
0850   2847           00109         GOTO DLNAZEV_PRIJEM
                      00110 
0851   3010           00111         movlw h'10'
0852   0084           00112         movwf FSR
0853   0800           00113         movfw INDF
0854   3C01           00114         sublw .1
0855   1D03           00115         btfss STATUS,Z
0856   285C           00116         goto DLNAZEV_NENIDLOUHYNAZEV            ; pokud stavovy byte na prikaz 0Ah neni 01h nebyl precte
                            n dlouhy nazev
0857   0A84           00117         incf FSR,f
0858   0800           00118         movfw INDF
0859   3CFF           00119         sublw h'FF'                                                     ; kdyz prvni znak nazvu je 0 (po
                             prevodu FFh) neni take dlouhy nazev
085A   1D03           00120         btfss STATUS,Z
085B   289A           00121         goto DLNAZEV_JEDLOUHYNAZEV
085C                  00122 DLNAZEV_NENIDLOUHYNAZEV                                 ; budeme si muset vystacit s kratkym nazvem
                      00123         PROG_PAGE_0
085C   118A               M                         bcf PCLATH,3
085D   120A               M                         bcf PCLATH,4
085E   3005           00124         movlw h'05'
085F   21B7           00125         call WR_USART
0860   0867           00126         MOVFW ADRESAR1
0861   21B7           00127         CALL WR_USART
0862   0868           00128         MOVFW ADRESAR2
0863   21B7           00129         CALL WR_USART
0864   0869           00130         MOVFW ADRESAR3
0865   21B7           00131         CALL WR_USART
0866   086A           00132         MOVFW ADRESAR4
0867   21B7           00133         CALL WR_USART
0868   086B           00134         MOVFW ZAZNAM1
0869   21B7           00135         CALL WR_USART
086A   086C           00136         MOVFW ZAZNAM2
086B   21B7           00137         CALL WR_USART
                      00138 
086C   3010           00139         MOVLW h'10'
086D   0084           00140         MOVWF FSR
086E   3009           00141         MOVLW .9
086F   00A1           00142         MOVWF TMP1
                      00143 
0870                  00144 DLNAZEV_PRIJEM_2
                      00145         PROG_PAGE_0
0870   118A               M                         bcf PCLATH,3
0871   120A               M                         bcf PCLATH,4
0872   21BF           00146         CALL RD_USART
0873   2203           00147         call PREVED_ZNAK
                      00148         PROG_PAGE_1
0874   158A               M                         bsf PCLATH,3
0875   120A               M                         bcf PCLATH,4
0876   0080           00149         MOVWF INDF
0877   0A84           00150         INCF FSR,F
0878   0BA1           00151         DECFSZ TMP1,F
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0879   2870           00152         GOTO DLNAZEV_PRIJEM_2                           ; prijem 8 znaku kratkeho jmena
                      00153         
087A   3010           00154         MOVLW h'10'
087B   0084           00155         MOVWF FSR
087C   0800           00156         movfw INDF
087D   3C06           00157         sublw h'06'
087E   302E           00158         movlw '.'
087F   1D03           00159         btfss STATUS,Z                          
0880   3020           00160         movlw ' '                                                       ; jestli soubor nebyla mp3, nebu
                            deme vkladat tecku
0881   00A1           00161         movwf TMP1
                      00162 
0882   3019           00163         MOVLW h'19'
0883   0084           00164         MOVWF FSR
0884   0821           00165         movfw TMP1
0885   0080           00166         MOVWF INDF
0886   0A84           00167         INCF FSR,F
                      00168 
0887   3003           00169         MOVLW .3
0888   00A1           00170         MOVWF TMP1
0889                  00171 DLNAZEV_PRIJEM_3
                      00172         PROG_PAGE_0
0889   118A               M                         bcf PCLATH,3
088A   120A               M                         bcf PCLATH,4
088B   21BF           00173         CALL RD_USART
088C   2203           00174         call PREVED_ZNAK
                      00175         PROG_PAGE_1
088D   158A               M                         bsf PCLATH,3
088E   120A               M                         bcf PCLATH,4
088F   0080           00176         MOVWF INDF
0890   0A84           00177         INCF FSR,F
0891   0BA1           00178         DECFSZ TMP1,F
0892   2889           00179         GOTO DLNAZEV_PRIJEM_3                           ; prijem 3 znaku pripony kratkeho jmena
                      00180 
0893   3004           00181         MOVLW .4
0894   00A1           00182         MOVWF TMP1
                      00183         PROG_PAGE_0
0895   118A               M                         bcf PCLATH,3
0896   120A               M                         bcf PCLATH,4
0897   21C3           00184         call USART_PRESKOC                                      ; prvni sektor je nam ted k ...
                      00185         PROG_PAGE_1
0898   158A               M                         bsf PCLATH,3
0899   120A               M                         bcf PCLATH,4
089A                  00186 DLNAZEV_JEDLOUHYNAZEV
089A   3052           00187         movlw h'52'
089B   0084           00188         movwf FSR       
089C   30FF           00189         movlw h'FF'
089D   0080           00190         movwf INDF                                                      ; protoze pokud je nazev delsi j
                            ak 65 znaku, tak neobsahuje ukoncovaci byte, 
089E   0008           00191         return                                                          ; proto ho tam ted umistime (pro
                             jistotu)
                      00192 ;**************************************************************************
089F                  00193 ZJISTI_NAZEV_SLOZKY
                      00194 ; v ADRESAR prijme cislo prvniho clusteru slozky. do BUFFERU2 da jeji dlouhy nazev
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00195         PROG_PAGE_0
089F   118A               M                         bcf PCLATH,3
08A0   120A               M                         bcf PCLATH,4
08A1   300C           00196         movlw h'0C'
08A2   21B7           00197         call WR_USART
08A3   0867           00198         movfw ADRESAR1
08A4   21B7           00199         call WR_USART
08A5   0868           00200         movfw ADRESAR2
08A6   21B7           00201         call WR_USART
08A7   0869           00202         movfw ADRESAR3
08A8   21B7           00203         call WR_USART
08A9   086A           00204         movfw ADRESAR4
08AA   21B7           00205         call WR_USART
                      00206                 
08AB   21BF           00207         call RD_USART           ; 1 byte – pøíznak úspìchu
                      00208                                                 ;       00h => povedlo se
                      00209                                                 ;       01h => tento pøíkaz nelze použít pro koøenový ad
                            resáø
                      00210                                                 ;       81h => zadaný cluster neobsahuje zaèátek adresáø
                            e (následující data jsou neplatná)
                      00211         PROG_PAGE_1
08AC   158A               M                         bsf PCLATH,3
08AD   120A               M                         bcf PCLATH,4
08AE   39FF           00212         andlw h'FF'
08AF   1D03           00213         btfss STATUS,Z
08B0   28C3           00214         goto ZJISTI_NAZEV_SLOZKY_ROOT
                      00215 
                      00216         PROG_PAGE_0
08B1   118A               M                         bcf PCLATH,3
08B2   120A               M                         bcf PCLATH,4
08B3   21BF           00217         call RD_USART
08B4   00E7           00218         movwf ADRESAR1
08B5   21BF           00219         call RD_USART
08B6   00E8           00220         movwf ADRESAR2
08B7   21BF           00221         call RD_USART
08B8   00E9           00222         movwf ADRESAR3
08B9   21BF           00223         call RD_USART
08BA   00EA           00224         movwf ADRESAR4
08BB   21BF           00225         call RD_USART
08BC   00EB           00226         movwf ZAZNAM1
08BD   21BF           00227         call RD_USART
08BE   00EC           00228         movwf ZAZNAM2
                      00229         PROG_PAGE_1
08BF   158A               M                         bsf PCLATH,3
08C0   120A               M                         bcf PCLATH,4
                      00230 
08C1   2032           00231         call NACTI_DLOUHY_NAZEV
                      00232 
08C2   0008           00233         return
08C3                  00234 ZJISTI_NAZEV_SLOZKY_ROOT
08C3   3006           00235         movlw .6
08C4   00A1           00236         movwf TMP1      
                      00237         PROG_PAGE_0
08C5   118A               M                         bcf PCLATH,3
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

08C6   120A               M                         bcf PCLATH,4
08C7   21C3           00238         call USART_PRESKOC
                      00239         PROG_PAGE_1
08C8   158A               M                         bsf PCLATH,3
08C9   120A               M                         bcf PCLATH,4
                      00240 
                      00241         INDF_BANK_2
08CA   1783               M                         bsf STATUS,IRP    
08CB   3011           00242         movlw 0x11
08CC   0084           00243         movwf FSR
08CD   3052           00244         movlw 'R'
08CE   0080           00245         movwf INDF
08CF   0A84           00246         incf FSR,f
08D0   304F           00247         movlw 'O'
08D1   0080           00248         movwf INDF
08D2   0A84           00249         incf FSR,f
08D3   304F           00250         movlw 'O'
08D4   0080           00251         movwf INDF
08D5   0A84           00252         incf FSR,f
08D6   3054           00253         movlw 'T'
08D7   0080           00254         movwf INDF
08D8   0A84           00255         incf FSR,f
08D9   30FF           00256         movlw h'FF'
08DA   0080           00257         movwf INDF
                      00258         ; nastaveni jmena zakladniho adresare
                      00259 
08DB   0008           00260         return  
                      00261 ;**************************************************************************
08DC                  00262 INFO
08DC   3083           00263         movlw h'83'             ; vraci informace o prehravanem souboru
                      00264         PROG_PAGE_0
08DD   118A               M                         bcf PCLATH,3
08DE   120A               M                         bcf PCLATH,4
08DF   21B7           00265         CALL WR_USART
08E0   21BF           00266         CALL RD_USART
08E1   00ED           00267         MOVWF AUDATA1
08E2   21BF           00268         CALL RD_USART
08E3   00EE           00269         MOVWF AUDATA2
08E4   300A           00270         MOVLW .10
08E5   00A1           00271         MOVWF TMP1
08E6   21C3           00272         CALL USART_PRESKOC
08E7   203B           00273         call LCD_4RADEK
08E8   202B           00274         call LCD_SMAZ_RADEK
08E9   203B           00275         call LCD_4RADEK
                      00276         PROG_PAGE_1
08EA   158A               M                         bsf PCLATH,3
08EB   120A               M                         bcf PCLATH,4
                      00277         
08EC   304D           00278         MOVLW 'M'         ;MONO
08ED   1BEE           00279         BTFSC AUDATA2,7
08EE   3053           00280         MOVLW 'S'          ;STEREO
08EF   2370           00281         call ZAPISD2
08F0   3020           00282         MOVLW ' '       
08F1   2370           00283         call ZAPISD2
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00284         
                      00285         PROG_PAGE_0
08F2   118A               M                         bcf PCLATH,3
08F3   120A               M                         bcf PCLATH,4
08F4   086D           00286         movfw AUDATA1
08F5   00C0           00287         movwf POMOCNA1
08F6   086E           00288         movfw AUDATA2           ; AUDATA obsahuje na bitech 0-9 aktualni vzorkovaci frekvenci
08F7   3901           00289         andlw b'00000001'
08F8   00C1           00290         movwf POMOCNA2
08F9   2438           00291         call DELENO10
                      00292         ; preteceni := pomocna mod 10
                      00293         ; pomocna := pomocna div 10
08FA   0837           00294         movfw PRETECENI
08FB   00A1           00295         movwf TMP1                      ; zaloha jednotek
08FC   2438           00296         call DELENO10
                      00297 
                      00298         PROG_PAGE_1
08FD   158A               M                         bsf PCLATH,3
08FE   120A               M                         bcf PCLATH,4
08FF   0840           00299         movfw POMOCNA1
0900   39FF           00300         andlw h'FF'
0901   1903           00301         btfsc STATUS,Z
0902   2905           00302         goto $+3
0903   3E30           00303         addlw .48
0904   2906           00304         goto $+2
0905   3020           00305         movlw ' '                       ; pokud stovky = 0, tak zobrazime mezeru, ne nulu...
                      00306         PROG_PAGE_0     
0906   118A               M                         bcf PCLATH,3
0907   120A               M                         bcf PCLATH,4
                      00307 
0908   20A8           00308         call ZAPISD                     ; stovky
                      00309 
0909   0837           00310         movfw PRETECENI
090A   3E30           00311         addlw .48
090B   20A8           00312         call ZAPISD                     ; desitky minut
                      00313 
090C   0821           00314         movfw TMP1
090D   3E30           00315         addlw .48
090E   20A8           00316         call ZAPISD                     ; jednotky minut
                      00317         
                      00318         PROG_PAGE_1
090F   158A               M                         bsf PCLATH,3
0910   120A               M                         bcf PCLATH,4
0911   306B           00319         MOVLW 'k'
0912   2370           00320         CALL ZAPISD2
0913   3062           00321         MOVLW 'b'
0914   2370           00322         CALL ZAPISD2
0915   3070           00323         MOVLW 'p'
0916   2370           00324         CALL ZAPISD2
0917   3073           00325         MOVLW 's'
0918   2370           00326         CALL ZAPISD2
0919   302F           00327         MOVLW '/'
091A   2370           00328         CALL ZAPISD2
                      00329         
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

091B   086E           00330         MOVFW AUDATA2
091C   391E           00331         ANDLW b'00011110'
091D   00A1           00332         MOVWF TMP1
091E   3C02           00333         SUBLW .2
091F   1903           00334         BTFSC STATUS,Z
0920   2166           00335         CALL FREK_44.1
0921   086E           00336         MOVFW AUDATA2
0922   391E           00337         ANDLW b'00011110'
0923   00A1           00338         MOVWF TMP1
0924   3C04           00339         SUBLW .4
0925   1903           00340         BTFSC STATUS,Z
0926   216F           00341         CALL FREK_48
0927   086E           00342         MOVFW AUDATA2
0928   391E           00343         ANDLW b'00011110'
0929   00A1           00344         MOVWF TMP1
092A   3C06           00345         SUBLW .6
092B   1903           00346         BTFSC STATUS,Z
092C   2174           00347         CALL FREK_32
092D   086E           00348         MOVFW AUDATA2
092E   391E           00349         ANDLW b'00011110'
092F   00A1           00350         MOVWF TMP1
0930   3C08           00351         SUBLW .8
0931   1903           00352         BTFSC STATUS,Z
0932   2179           00353         CALL FREK_22
0933   086E           00354         MOVFW AUDATA2
0934   391E           00355         ANDLW b'00011110'
0935   00A1           00356         MOVWF TMP1
0936   3C0A           00357         SUBLW .10
0937   1903           00358         BTFSC STATUS,Z
0938   217E           00359         CALL FREK_24
0939   086E           00360         MOVFW AUDATA2
093A   391E           00361         ANDLW b'00011110'
093B   00A1           00362         MOVWF TMP1
093C   3C0C           00363         SUBLW .12
093D   1903           00364         BTFSC STATUS,Z
093E   2183           00365         CALL FREK_16
093F   086E           00366         MOVFW AUDATA2
0940   391E           00367         ANDLW b'00011110'
0941   00A1           00368         MOVWF TMP1
0942   3C0E           00369         SUBLW .14
0943   1903           00370         BTFSC STATUS,Z
0944   2188           00371         CALL FREK_11
0945   086E           00372         MOVFW AUDATA2
0946   391E           00373         ANDLW b'00011110'
0947   00A1           00374         MOVWF TMP1
0948   3C10           00375         SUBLW .16
0949   1903           00376         BTFSC STATUS,Z
094A   218D           00377         CALL FREK_12
094B   086E           00378         MOVFW AUDATA2
094C   391E           00379         ANDLW b'00011110'
094D   00A1           00380         MOVWF TMP1
094E   3C12           00381         SUBLW .18
094F   1903           00382         BTFSC STATUS,Z
0950   2192           00383         CALL FREK_8
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00384 
0951   2195           00385         CALL FREK_KHZ
                      00386         
0952   1E29           00387         BTFSS PREH_STAV0,4
0953   295C           00388         goto INFO_NR
0954   1EA9           00389         BTFSS PREH_STAV0,5
0955   2961           00390         goto INFO_RD
0956   2957           00391         goto INFO_R1
0957                  00392 INFO_R1
0957   3052           00393         MOVLW 'R'
0958   2370           00394         CALL ZAPISD2
0959   3031           00395         MOVLW '1'
095A   2370           00396         CALL ZAPISD2
095B   0008           00397         return
095C                  00398 INFO_NR
095C   304E           00399         MOVLW 'N'
095D   2370           00400         CALL ZAPISD2
095E   3052           00401         MOVLW 'R'
095F   2370           00402         CALL ZAPISD2
0960   0008           00403         return
0961                  00404 INFO_RD
0961   3052           00405         MOVLW 'R'
0962   2370           00406         CALL ZAPISD2
0963   3044           00407         MOVLW 'D'
0964   2370           00408         CALL ZAPISD2
0965   0008           00409         return
                      00410 ;**************************************************************************
0966                  00411 FREK_44.1
0966   3034           00412         MOVLW '4'
0967   2370           00413         CALL ZAPISD2
0968   3034           00414         MOVLW '4'
0969   2370           00415         CALL ZAPISD2
096A   302E           00416         MOVLW '.'
096B   2370           00417         CALL ZAPISD2
096C   3031           00418         MOVLW '1'
096D   2370           00419         CALL ZAPISD2
096E   0008           00420         return
                      00421 
                      00422 
096F                  00423 FREK_48
096F   3034           00424         MOVLW '4'
0970   2370           00425         CALL ZAPISD2
0971   3038           00426         MOVLW '8'
0972   2370           00427         CALL ZAPISD2
0973   0008           00428         return
                      00429 
0974                  00430 FREK_32
0974   3033           00431         MOVLW '3'
0975   2370           00432         CALL ZAPISD2
0976   3032           00433         MOVLW '2'
0977   2370           00434         CALL ZAPISD2
0978   0008           00435         return
                      00436 
0979                  00437 FREK_22
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0979   3032           00438         MOVLW '2'
097A   2370           00439         CALL ZAPISD2
097B   3032           00440         MOVLW '2'
097C   2370           00441         CALL ZAPISD2
097D   0008           00442         return
                      00443 
097E                  00444 FREK_24
097E   3032           00445         MOVLW '2'
097F   2370           00446         CALL ZAPISD2
0980   3034           00447         MOVLW '4'
0981   2370           00448         CALL ZAPISD2
0982   0008           00449         return
                      00450 
0983                  00451 FREK_16
0983   3031           00452         MOVLW '1'
0984   2370           00453         CALL ZAPISD2
0985   3036           00454         MOVLW '6'
0986   2370           00455         CALL ZAPISD2
0987   0008           00456         return
                      00457 
0988                  00458 FREK_11
0988   3031           00459         MOVLW '1'
0989   2370           00460         CALL ZAPISD2
098A   3031           00461         MOVLW '1'
098B   2370           00462         CALL ZAPISD2
098C   0008           00463         return
                      00464 
098D                  00465 FREK_12
098D   3031           00466         MOVLW '1'
098E   2370           00467         CALL ZAPISD2
098F   3032           00468         MOVLW '2'
0990   2370           00469         CALL ZAPISD2
0991   0008           00470         return
                      00471 
0992                  00472 FREK_8
0992   3038           00473         MOVLW '8'
0993   2370           00474         CALL ZAPISD2
0994   0008           00475         return
                      00476 
0995                  00477 FREK_KHZ
0995   306B           00478         MOVLW 'k'
0996   2370           00479         CALL ZAPISD2
0997   3048           00480         MOVLW 'H'
0998   2370           00481         CALL ZAPISD2
0999   307A           00482         MOVLW 'z'
099A   2370           00483         CALL ZAPISD2
099B   3020           00484         MOVLW ' '
099C   2370           00485         CALL ZAPISD2
099D   0008           00486         return
                      00487 ;**************************************************************************
                      00055         include "menu2.asm"             ; menu
099E                  00001 NAVRAT_Z_MENU
099E   01C4           00002         clrf TLACITKA
                      00003         PROG_PAGE_0
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

099F   118A               M                         bcf PCLATH,3
09A0   120A               M                         bcf PCLATH,4
09A1   2B23           00004         goto PREHRAVANI 
                      00005 ;---------------------------------------------------------------
09A2                  00006 MENU
09A2   01A6           00007         clrf TMP5                       ; na kterou polozku v menu ukazuje sipka
                      00008 
09A3                  00009 MENU_SIPKY                              ; podle toho, kde je sipka, tak zobrazi informace na lcd a sipku
                            ...
09A3   0826           00010         movfw TMP5
09A4   39FF           00011         andlw h'FF'     
09A5   1903           00012         btfsc STATUS,Z
09A6   2A17           00013         goto MENU_1POLOZKA      
09A7   0826           00014         movfw TMP5
09A8   3C01           00015         sublw .1
09A9   1903           00016         btfsc STATUS,Z
09AA   2A1E           00017         goto MENU_2POLOZKA      
09AB   0826           00018         movfw TMP5
09AC   3C02           00019         sublw .2
09AD   1903           00020         btfsc STATUS,Z
09AE   2A25           00021         goto MENU_3POLOZKA      
09AF   0826           00022         movfw TMP5
09B0   3C03           00023         sublw .3
09B1   1903           00024         btfsc STATUS,Z
09B2   2A2C           00025         goto MENU_4POLOZKA      
09B3   0826           00026         movfw TMP5
09B4   3C04           00027         sublw .4
09B5   1903           00028         btfsc STATUS,Z
09B6   2A33           00029         goto MENU_5POLOZKA
09B7   0826           00030         movfw TMP5
09B8   3C05           00031         sublw .5
09B9   1903           00032         btfsc STATUS,Z
09BA   2A3A           00033         goto MENU_6POLOZKA      
                      00034         
                      00035 
09BB                  00036 MENU_ROLOVANI                           ; reseni tlacitek v menu...
09BB   11A8           00037         bcf STAV,3                              ; 3. bit = 1 => pri zmene hlasitosti se vypise hlasitost
                             na LCD 
                      00038         PROG_PAGE_0
09BC   118A               M                         bcf PCLATH,3
09BD   120A               M                         bcf PCLATH,4
09BE   24A8           00039         CALL TEST_TLAC                  ; aby v teto casti programu chodila hlasitost
                      00040         PROG_PAGE_1
09BF   158A               M                         bsf PCLATH,3
09C0   120A               M                         bcf PCLATH,4
                      00041 
09C1   18C4           00042         btfsc TLACITKA,1
09C2   2A0B           00043         goto MENU_SIPKA_UP
09C3   1844           00044         btfsc TLACITKA,0
09C4   2A11           00045         goto MENU_SIPKA_DOWN
09C5   1A44           00046         btfsc TLACITKA,4
09C6   299E           00047         goto NAVRAT_Z_MENU
                      00048 
09C7   1AC4           00049         btfsc TLACITKA,5
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

09C8   29CA           00050         goto ZMENA_STAVU        
                      00051 
09C9   29BB           00052         goto MENU_ROLOVANI
                      00053 ;---------------------------------------------------------------
09CA                  00054 ZMENA_STAVU
09CA   12C4           00055         bcf TLACITKA,5
                      00056         ; podle toho, kde je sipka, se zmeni stav nejake polozky...
09CB   0826           00057         movfw TMP5
09CC   39FF           00058         andlw h'FF'     
09CD   1903           00059         btfsc STATUS,Z
09CE   29DC           00060         goto M_ZMENA_1POLOZKY
09CF   0826           00061         movfw TMP5
09D0   3C01           00062         sublw .1
09D1   1903           00063         btfsc STATUS,Z
09D2   29E9           00064         goto M_ZMENA_2POLOZKY
                      00065 
09D3   0826           00066         movfw TMP5
09D4   3C02           00067         sublw .2
09D5   1903           00068         btfsc STATUS,Z
09D6   29EF           00069         goto M_ZMENA_3POLOZKY
                      00070 
09D7   0826           00071         movfw TMP5
09D8   3C04           00072         sublw .4
09D9   1903           00073         btfsc STATUS,Z
09DA   29FA           00074         goto M_ZMENA_5POLOZKY
                      00075 
                      00076 
09DB   29A3           00077         goto MENU_SIPKY
                      00078 ;---------------------------------------------------------------
09DC                  00079 M_ZMENA_1POLOZKY
                      00080                 ; 5:4   => nastaveni podsviceni
                      00081                 ;       00      - podsviceni vypnuto
                      00082                 ;       01      - podsviceni zapnuto porad
                      00083                 ;       11      - podsviceni blika 50Hz
09DC   1E28           00084         btfss STAV,4
09DD   29E6           00085         goto M_ZMENA_1POLOZKY_OFF
09DE   1EA8           00086         btfss STAV,5
09DF   29E3           00087         goto M_ZMENA_1POLOZKY_SV
09E0   1628           00088         bsf STAV,4
09E1   12A8           00089         bcf STAV,5
09E2   29A3           00090         goto MENU_SIPKY
09E3                  00091 M_ZMENA_1POLOZKY_SV
09E3   1228           00092         bcf STAV,4
09E4   12A8           00093         bcf STAV,5
09E5   29A3           00094         goto MENU_SIPKY
09E6                  00095 M_ZMENA_1POLOZKY_OFF    ;0
09E6   1628           00096         bsf STAV,4
09E7   16A8           00097         bsf STAV,5
09E8   29A3           00098         goto MENU_SIPKY
                      00099 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
09E9                  00100 M_ZMENA_2POLOZKY
09E9   1E07           00101         btfss TL_PODSVICENI
09EA   29ED           00102         goto M_ZMENA_2POLOZKY_ZAPNI
09EB   1207           00103         bcf TL_PODSVICENI
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

09EC   29A3           00104         goto MENU_SIPKY
09ED                  00105 M_ZMENA_2POLOZKY_ZAPNI
09ED   1607           00106         bsf TL_PODSVICENI
09EE   29A3           00107         goto MENU_SIPKY
                      00108 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
09EF                  00109 M_ZMENA_3POLOZKY
09EF   1DAA           00110         btfss PREH_STAV1,3
09F0   29F3           00111         goto M_ZMENA_3POLOZKY_ZAPNI
09F1   11AA           00112         bcf PREH_STAV1,3
09F2   29F4           00113         goto M_ZMENA_3POLOZKY_NASTAV
09F3                  00114 M_ZMENA_3POLOZKY_ZAPNI
09F3   15AA           00115         bsf PREH_STAV1,3        
09F4                  00116 M_ZMENA_3POLOZKY_NASTAV
                      00117         PROG_PAGE_0
09F4   118A               M                         bcf PCLATH,3
09F5   120A               M                         bcf PCLATH,4
09F6   24F4           00118         call NASTAV_STAV
                      00119         PROG_PAGE_1
09F7   158A               M                         bsf PCLATH,3
09F8   120A               M                         bcf PCLATH,4
09F9   29A3           00120         goto MENU_SIPKY 
                      00121 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
09FA                  00122 M_ZMENA_5POLOZKY
09FA   083A           00123         movfw EKVALIZER
09FB   3C0C           00124         sublw .12
09FC   1D03           00125         btfss STATUS,Z
09FD   2A00           00126         goto M_ZMENA_5POLOZKY_INC
09FE   01BA           00127         clrf EKVALIZER
09FF   2A01           00128         goto M_ZMENA_5POLOZKY_NASTAV
0A00                  00129 M_ZMENA_5POLOZKY_INC
0A00   0ABA           00130         incf EKVALIZER,f
0A01                  00131 M_ZMENA_5POLOZKY_NASTAV
0A01   3085           00132         movlw h'85'
                      00133         PROG_PAGE_0
0A02   118A               M                         bcf PCLATH,3
0A03   120A               M                         bcf PCLATH,4
0A04   21B7           00134         call WR_USART
0A05   083A           00135         movfw EKVALIZER
0A06   21B7           00136         call WR_USART
0A07   21BF           00137         call RD_USART
                      00138         PROG_PAGE_1
0A08   158A               M                         bsf PCLATH,3
0A09   120A               M                         bcf PCLATH,4
0A0A   29A3           00139         goto MENU_SIPKY 
                      00140 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00141 ;---------------------------------------------------------------
0A0B                  00142 MENU_SIPKA_UP
0A0B   10C4           00143         bcf TLACITKA,1
0A0C   0826           00144         movfw TMP5
0A0D   3C00           00145         sublw .0
0A0E   1D03           00146         btfss STATUS,Z
0A0F   03A6           00147         decf TMP5,f
0A10   29A3           00148         goto MENU_SIPKY
0A11                  00149 MENU_SIPKA_DOWN
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0A11   1044           00150         bcf TLACITKA,0
0A12   0826           00151         movfw TMP5
0A13   3C05           00152         sublw .5                                ; maximalni polozka menu 0-5
0A14   1D03           00153         btfss STATUS,Z
0A15   0AA6           00154         incf TMP5,f
0A16   29A3           00155         goto MENU_SIPKY
                      00156 ;---------------------------------------------------------------
0A17                  00157 MENU_1POLOZKA
0A17   2241           00158         call MENU_1
                      00159         PROG_PAGE_0
0A18   118A               M                         bcf PCLATH,3
0A19   120A               M                         bcf PCLATH,4
0A1A   2729           00160         call SIPKA_2RADEK
                      00161         PROG_PAGE_1
0A1B   158A               M                         bsf PCLATH,3
0A1C   120A               M                         bcf PCLATH,4
0A1D   29BB           00162         goto MENU_ROLOVANI
0A1E                  00163 MENU_2POLOZKA
0A1E   2241           00164         call MENU_1
                      00165         PROG_PAGE_0
0A1F   118A               M                         bcf PCLATH,3
0A20   120A               M                         bcf PCLATH,4
0A21   2733           00166         call SIPKA_3RADEK
                      00167         PROG_PAGE_1
0A22   158A               M                         bsf PCLATH,3
0A23   120A               M                         bcf PCLATH,4
0A24   29BB           00168         goto MENU_ROLOVANI
0A25                  00169 MENU_3POLOZKA
0A25   2241           00170         call MENU_1
                      00171         PROG_PAGE_0
0A26   118A               M                         bcf PCLATH,3
0A27   120A               M                         bcf PCLATH,4
0A28   273D           00172         call SIPKA_4RADEK
                      00173         PROG_PAGE_1
0A29   158A               M                         bsf PCLATH,3
0A2A   120A               M                         bcf PCLATH,4
0A2B   29BB           00174         goto MENU_ROLOVANI
0A2C                  00175 MENU_4POLOZKA
0A2C   22D2           00176         call MENU_2
                      00177         PROG_PAGE_0
0A2D   118A               M                         bcf PCLATH,3
0A2E   120A               M                         bcf PCLATH,4
0A2F   2729           00178         call SIPKA_2RADEK
                      00179         PROG_PAGE_1
0A30   158A               M                         bsf PCLATH,3
0A31   120A               M                         bcf PCLATH,4
0A32   29BB           00180         goto MENU_ROLOVANI
0A33                  00181 MENU_5POLOZKA
0A33   22D2           00182         call MENU_2
                      00183         PROG_PAGE_0
0A34   118A               M                         bcf PCLATH,3
0A35   120A               M                         bcf PCLATH,4
0A36   2733           00184         call SIPKA_3RADEK
                      00185         PROG_PAGE_1
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0A37   158A               M                         bsf PCLATH,3
0A38   120A               M                         bcf PCLATH,4
0A39   29BB           00186         goto MENU_ROLOVANI
0A3A                  00187 MENU_6POLOZKA
0A3A   22D2           00188         call MENU_2
                      00189         PROG_PAGE_0
0A3B   118A               M                         bcf PCLATH,3
0A3C   120A               M                         bcf PCLATH,4
0A3D   273D           00190         call SIPKA_4RADEK
                      00191         PROG_PAGE_1
0A3E   158A               M                         bsf PCLATH,3
0A3F   120A               M                         bcf PCLATH,4
0A40   29BB           00192         goto MENU_ROLOVANI
                      00193 
                      00194 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00195 ; 1. STRANKA MENU
                      00196 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
0A41                  00197 MENU_1
                      00198         PROG_PAGE_0
0A41   118A               M                         bcf PCLATH,3
0A42   120A               M                         bcf PCLATH,4
0A43   2021           00199         call SMAZ_LCD
0A44   2032           00200         call LCD_1RADEK
                      00201         PROG_PAGE_1
0A45   158A               M                         bsf PCLATH,3
0A46   120A               M                         bcf PCLATH,4
                      00202         PROG_PAGE_1
0A47   158A               M                         bsf PCLATH,3
0A48   120A               M                         bcf PCLATH,4
0A49   304D           00203         MOVLW 'M'
0A4A   2370           00204         CALL ZAPISD2
0A4B   3045           00205         MOVLW 'E'
0A4C   2370           00206         CALL ZAPISD2
0A4D   304E           00207         MOVLW 'N'
0A4E   2370           00208         CALL ZAPISD2
0A4F   3055           00209         MOVLW 'U'
0A50   2370           00210         CALL ZAPISD2
0A51   3020           00211         MOVLW ' '
0A52   2370           00212         CALL ZAPISD2
0A53   3031           00213         MOVLW '1'
0A54   2370           00214         CALL ZAPISD2
0A55   302F           00215         MOVLW '/'
0A56   2370           00216         CALL ZAPISD2
0A57   3032           00217         MOVLW '2'
0A58   2370           00218         CALL ZAPISD2
                      00219 ;;;;;;;;;;;;;;;;;;;;
                      00220         PROG_PAGE_0
0A59   118A               M                         bcf PCLATH,3
0A5A   120A               M                         bcf PCLATH,4
0A5B   2035           00221         call LCD_2RADEK
                      00222         PROG_PAGE_1
0A5C   158A               M                         bsf PCLATH,3
0A5D   120A               M                         bcf PCLATH,4
0A5E   3020           00223         MOVLW ' '
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0A5F   2370           00224         CALL ZAPISD2
0A60   3070           00225         MOVLW 'p'
0A61   2370           00226         CALL ZAPISD2
0A62   306F           00227         MOVLW 'o'
0A63   2370           00228         CALL ZAPISD2
0A64   3064           00229         MOVLW 'd'
0A65   2370           00230         CALL ZAPISD2
0A66   3073           00231         MOVLW 's'
0A67   2370           00232         CALL ZAPISD2
0A68   3076           00233         MOVLW 'v'
0A69   2370           00234         CALL ZAPISD2
0A6A   3001           00235         MOVLW h'01'
0A6B   2370           00236         CALL ZAPISD2
0A6C   3063           00237         MOVLW 'c'
0A6D   2370           00238         CALL ZAPISD2
0A6E   3065           00239         MOVLW 'e'
0A6F   2370           00240         CALL ZAPISD2
0A70   306E           00241         MOVLW 'n'
0A71   2370           00242         CALL ZAPISD2
0A72   3001           00243         MOVLW h'01'
0A73   2370           00244         CALL ZAPISD2
0A74   3020           00245         MOVLW ' '
0A75   2370           00246         CALL ZAPISD2
0A76   304C           00247         MOVLW 'L'
0A77   2370           00248         CALL ZAPISD2
0A78   3043           00249         MOVLW 'C'
0A79   2370           00250         CALL ZAPISD2
0A7A   3044           00251         MOVLW 'D'
0A7B   2370           00252         CALL ZAPISD2
0A7C   3020           00253         MOVLW ' '
0A7D   2370           00254         CALL ZAPISD2
0A7E   3020           00255         MOVLW ' '
0A7F   2370           00256         CALL ZAPISD2
0A80   2341           00257         call M_STAV_LCD
                      00258 ;;;;;;;;;;;;;;;;;;;
                      00259         PROG_PAGE_0
0A81   118A               M                         bcf PCLATH,3
0A82   120A               M                         bcf PCLATH,4
0A83   2038           00260         call LCD_3RADEK
                      00261         PROG_PAGE_1
0A84   158A               M                         bsf PCLATH,3
0A85   120A               M                         bcf PCLATH,4
0A86   3020           00262         MOVLW ' '
0A87   2370           00263         CALL ZAPISD2
0A88   3070           00264         MOVLW 'p'
0A89   2370           00265         CALL ZAPISD2
0A8A   306F           00266         MOVLW 'o'
0A8B   2370           00267         CALL ZAPISD2
0A8C   3064           00268         MOVLW 'd'
0A8D   2370           00269         CALL ZAPISD2
0A8E   3073           00270         MOVLW 's'
0A8F   2370           00271         CALL ZAPISD2
0A90   3076           00272         MOVLW 'v'
0A91   2370           00273         CALL ZAPISD2
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0A92   3001           00274         MOVLW h'01'
0A93   2370           00275         CALL ZAPISD2
0A94   3063           00276         MOVLW 'c'
0A95   2370           00277         CALL ZAPISD2
0A96   3065           00278         MOVLW 'e'
0A97   2370           00279         CALL ZAPISD2
0A98   306E           00280         MOVLW 'n'
0A99   2370           00281         CALL ZAPISD2
0A9A   3001           00282         MOVLW h'01'
0A9B   2370           00283         CALL ZAPISD2
0A9C   3020           00284         MOVLW ' '
0A9D   2370           00285         CALL ZAPISD2
0A9E   3074           00286         MOVLW 't'
0A9F   2370           00287         CALL ZAPISD2
0AA0   306C           00288         MOVLW 'l'
0AA1   2370           00289         CALL ZAPISD2
0AA2   3020           00290         MOVLW ' '
0AA3   2370           00291         CALL ZAPISD2
0AA4   3020           00292         MOVLW ' '
0AA5   2370           00293         CALL ZAPISD2
0AA6   3020           00294         MOVLW ' '
0AA7   2370           00295         CALL ZAPISD2
0AA8   234E           00296         call M_STAV_LT
                      00297 
                      00298 ;;;;;;;;;;;;;;;;;;;
                      00299         PROG_PAGE_0
0AA9   118A               M                         bcf PCLATH,3
0AAA   120A               M                         bcf PCLATH,4
0AAB   203B           00300         call LCD_4RADEK
                      00301         PROG_PAGE_1
0AAC   158A               M                         bsf PCLATH,3
0AAD   120A               M                         bcf PCLATH,4
0AAE   3020           00302         MOVLW ' '
0AAF   2370           00303         CALL ZAPISD2
0AB0   3062           00304         MOVLW 'b'
0AB1   2370           00305         CALL ZAPISD2
0AB2   3061           00306         MOVLW 'a'
0AB3   2370           00307         CALL ZAPISD2
0AB4   3073           00308         MOVLW 's'
0AB5   2370           00309         CALL ZAPISD2
0AB6   3079           00310         MOVLW 'y'
0AB7   2370           00311         CALL ZAPISD2
0AB8   3020           00312         MOVLW ' '
0AB9   2370           00313         CALL ZAPISD2
0ABA   3020           00314         MOVLW ' '
0ABB   2370           00315         CALL ZAPISD2
0ABC   3020           00316         MOVLW ' '
0ABD   2370           00317         CALL ZAPISD2
0ABE   3020           00318         MOVLW ' '
0ABF   2370           00319         CALL ZAPISD2
0AC0   3020           00320         MOVLW ' '
0AC1   2370           00321         CALL ZAPISD2
0AC2   3020           00322         MOVLW ' '
0AC3   2370           00323         CALL ZAPISD2
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0AC4   3020           00324         MOVLW ' '
0AC5   2370           00325         CALL ZAPISD2
0AC6   3020           00326         MOVLW ' '
0AC7   2370           00327         CALL ZAPISD2
0AC8   3020           00328         MOVLW ' '
0AC9   2370           00329         CALL ZAPISD2
0ACA   3020           00330         MOVLW ' '
0ACB   2370           00331         CALL ZAPISD2
0ACC   3020           00332         MOVLW ' '
0ACD   2370           00333         CALL ZAPISD2
0ACE   3020           00334         MOVLW ' '
0ACF   2370           00335         CALL ZAPISD2
0AD0   2353           00336         call M_STAV_BASY
                      00337 
0AD1   0008           00338         return
                      00339 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00340 ; 2. STRANKA MENU
0AD2                  00341 MENU_2
                      00342     PROG_PAGE_0
0AD2   118A               M                         bcf PCLATH,3
0AD3   120A               M                         bcf PCLATH,4
0AD4   2021           00343         call SMAZ_LCD
0AD5   2032           00344         call LCD_1RADEK
                      00345         PROG_PAGE_1
0AD6   158A               M                         bsf PCLATH,3
0AD7   120A               M                         bcf PCLATH,4
0AD8   304D           00346         MOVLW 'M'
0AD9   2370           00347         CALL ZAPISD2
0ADA   3045           00348         MOVLW 'E'
0ADB   2370           00349         CALL ZAPISD2
0ADC   304E           00350         MOVLW 'N'
0ADD   2370           00351         CALL ZAPISD2
0ADE   3055           00352         MOVLW 'U'
0ADF   2370           00353         CALL ZAPISD2
0AE0   3020           00354         MOVLW ' '
0AE1   2370           00355         CALL ZAPISD2
0AE2   3032           00356         MOVLW '2'
0AE3   2370           00357         CALL ZAPISD2
0AE4   302F           00358         MOVLW '/'
0AE5   2370           00359         CALL ZAPISD2
0AE6   3032           00360         MOVLW '2'
0AE7   2370           00361         CALL ZAPISD2
                      00362 ;;;;;;;;;;;;;;;;;;;;;;;
                      00363         PROG_PAGE_0
0AE8   118A               M                         bcf PCLATH,3
0AE9   120A               M                         bcf PCLATH,4
0AEA   2035           00364         call LCD_2RADEK
                      00365         PROG_PAGE_1
0AEB   158A               M                         bsf PCLATH,3
0AEC   120A               M                         bcf PCLATH,4
0AED   3020           00366         MOVLW ' '
0AEE   2370           00367         CALL ZAPISD2
0AEF   3076           00368         MOVLW 'v'
0AF0   2370           00369         CALL ZAPISD2
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0AF1   3079           00370         MOVLW 'y'
0AF2   2370           00371         CALL ZAPISD2
0AF3   3070           00372         MOVLW 'p'
0AF4   2370           00373         CALL ZAPISD2
0AF5   306E           00374         MOVLW 'n'
0AF6   2370           00375         CALL ZAPISD2
0AF7   3075           00376         MOVLW 'u'
0AF8   2370           00377         CALL ZAPISD2
0AF9   3074           00378         MOVLW 't'
0AFA   2370           00379         CALL ZAPISD2
0AFB   3001           00380         MOVLW h'01'
0AFC   2370           00381         CALL ZAPISD2
0AFD   3020           00382         MOVLW ' '
0AFE   2370           00383         CALL ZAPISD2
0AFF   3048           00384         MOVLW 'H'
0B00   2370           00385         CALL ZAPISD2
0B01   3044           00386         MOVLW 'D'
0B02   2370           00387         CALL ZAPISD2
0B03   3044           00388         MOVLW 'D'
0B04   2370           00389         CALL ZAPISD2
0B05   3020           00390         MOVLW ' '
0B06   2370           00391         CALL ZAPISD2
0B07   2358           00392         call M_STAV_HDD
                      00393 ;;;;;;;;;;;;;;;;;;;;;;;
                      00394         PROG_PAGE_0
0B08   118A               M                         bcf PCLATH,3
0B09   120A               M                         bcf PCLATH,4
0B0A   2038           00395         call LCD_3RADEK
                      00396         PROG_PAGE_1
0B0B   158A               M                         bsf PCLATH,3
0B0C   120A               M                         bcf PCLATH,4
0B0D   3020           00397         MOVLW ' '
0B0E   2370           00398         CALL ZAPISD2
0B0F   3065           00399         MOVLW 'e'
0B10   2370           00400         CALL ZAPISD2
0B11   306B           00401         MOVLW 'k'
0B12   2370           00402         CALL ZAPISD2
0B13   3076           00403         MOVLW 'v'
0B14   2370           00404         CALL ZAPISD2
0B15   3061           00405         MOVLW 'a'
0B16   2370           00406         CALL ZAPISD2
0B17   306C           00407         MOVLW 'l'
0B18   2370           00408         CALL ZAPISD2
0B19   3069           00409         MOVLW 'i'
0B1A   2370           00410         CALL ZAPISD2
0B1B   307A           00411         MOVLW 'z'
0B1C   2370           00412         CALL ZAPISD2
0B1D   3065           00413         MOVLW 'e'
0B1E   2370           00414         CALL ZAPISD2
0B1F   3072           00415         MOVLW 'r'
0B20   2370           00416         CALL ZAPISD2
0B21   3020           00417         MOVLW ' '
0B22   2370           00418         CALL ZAPISD2
0B23   3020           00419         MOVLW ' '
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0B24   2370           00420         CALL ZAPISD2
0B25   3020           00421         MOVLW ' '
0B26   2370           00422         CALL ZAPISD2
0B27   3020           00423         MOVLW ' '
0B28   2370           00424         CALL ZAPISD2
0B29   2359           00425         call M_STAV_EKV
                      00426 ;;;;;;;;;;;;;;;;;;;;;;;
                      00427         PROG_PAGE_0
0B2A   118A               M                         bcf PCLATH,3
0B2B   120A               M                         bcf PCLATH,4
0B2C   203B           00428         call LCD_4RADEK
                      00429         PROG_PAGE_1
0B2D   158A               M                         bsf PCLATH,3
0B2E   120A               M                         bcf PCLATH,4
0B2F   3020           00430         MOVLW ' '
0B30   2370           00431         CALL ZAPISD2
0B31   3072           00432         MOVLW 'r'
0B32   2370           00433         CALL ZAPISD2
0B33   3065           00434         MOVLW 'e'
0B34   2370           00435         CALL ZAPISD2
0B35   3070           00436         MOVLW 'p'
0B36   2370           00437         CALL ZAPISD2
0B37   3065           00438         MOVLW 'e'
0B38   2370           00439         CALL ZAPISD2
0B39   3061           00440         MOVLW 'a'
0B3A   2370           00441         CALL ZAPISD2
0B3B   3074           00442         MOVLW 't'
0B3C   2370           00443         CALL ZAPISD2
0B3D   3020           00444         MOVLW ' '
0B3E   2370           00445         CALL ZAPISD2
0B3F   236A           00446         call M_STAV_REPEAT
0B40   0008           00447         return
                      00448 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00449 ; PROCEDURY PRO VYPIS STAVU ZALOZEK V MENU
                      00450 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
0B41                  00451 M_STAV_LCD
                      00452                 ; 5:4   => nastaveni podsviceni
                      00453                 ;       00      - podsviceni vypnuto
                      00454                 ;       01      - podsviceni zapnuto porad
                      00455                 ;       11      - podsviceni blika 50Hz
0B41   1E28           00456         btfss STAV,4
0B42   2B4B           00457         goto M_STAV_LCD_OFF
0B43   1EA8           00458         btfss STAV,5
0B44   2B48           00459         goto M_STAV_LCD_SV
0B45   3031           00460         movlw '1'
0B46   2370           00461         call ZAPISD2
0B47   0008           00462         return
0B48                  00463 M_STAV_LCD_SV
0B48   3032           00464         movlw '2'
0B49   2370           00465         call ZAPISD2
0B4A   0008           00466         return
0B4B                  00467 M_STAV_LCD_OFF
0B4B   3030           00468         movlw '0'
0B4C   2370           00469         call ZAPISD2
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0B4D   0008           00470         return
                      00471 ;;;;;;;;;;;;;;;;;;;;;;;
0B4E                  00472 M_STAV_LT
0B4E   3031           00473         movlw '1'
0B4F   1E07           00474         btfss TL_PODSVICENI
0B50   3030           00475         movlw '0'
0B51   2370           00476         call ZAPISD2
0B52   0008           00477         return
                      00478 ;;;;;;;;;;;;;;;;;;;;;;;
0B53                  00479 M_STAV_BASY
0B53   3031           00480         movlw '1'
0B54   1DAA           00481         btfss PREH_STAV1,3
0B55   3030           00482         movlw '0'
0B56   2370           00483         call ZAPISD2
0B57   0008           00484         return
                      00485 ;;;;;;;;;;;;;;;;;;;;;;;
0B58                  00486 M_STAV_HDD
0B58   0008           00487         return
                      00488 ;;;;;;;;;;;;;;;;;;;;;;;
0B59                  00489 M_STAV_EKV
0B59   083A           00490         movfw EKVALIZER
0B5A   00A5           00491         movwf TMP4
0B5B   300A           00492         movlw .10
0B5C   01A3           00493         clrf TMP2
                      00494 
0B5D   0AA3           00495         incf TMP2,f     
0B5E   02A5           00496         subwf TMP4,f                    ; TMP4 := TMP4 - 10
0B5F   1803           00497         btfsc STATUS,C
0B60   2B5D           00498         goto $-3
                      00499 
0B61   07A5           00500         addwf TMP4,f
0B62   03A3           00501         decf TMP2,f
0B63   3030           00502         movlw .48
0B64   0723           00503         addwf TMP2,w
0B65   2370           00504         call ZAPISD2                    ; desitky
                      00505 
0B66   3030           00506         movlw .48
0B67   0725           00507         addwf TMP4,w
0B68   2370           00508         call ZAPISD2                    ; jednotky
0B69   0008           00509         return
                      00510 ;;;;;;;;;;;;;;;;;;;;;;;
0B6A                  00511 M_STAV_REPEAT
0B6A   0008           00512         return
                      00513 ;;;;;;;;;;;;;;;;;;;;;;;
                      00514 
0B6B   304F           00515         MOVLW 'O'
0B6C   2370           00516         CALL ZAPISD2
0B6D   304E           00517         MOVLW 'N' 
0B6E   2370           00518         CALL ZAPISD2
0B6F   0008           00519         return
                      00520 ;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
                      00521 
                      00522 ;**********************************************************
0B70                  00523 ZAPISD2  
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00524         ; krystal 20MHz => instrukce = 200ns
0B70   1506           00525         BSF LCD_RS                      ; RS na  RB2 je 1 - DATA
0B71   1086           00526         BCF LCD_RW                      ; R/W na RB1 je 0 - zapis
0B72   0000           00527         nop                                     ; Tas min 140ns
0B73   0088           00528         MOVWF   PORTD
0B74   0000           00529         nop
0B75   0000           00530         nop
0B76   0000           00531         nop
0B77   0000           00532         nop
0B78   0000           00533         nop
0B79   0000           00534         nop
0B7A   0000           00535         nop
0B7B   0000           00536         nop
0B7C   0000           00537         nop
0B7D   0000           00538         nop
0B7E   1406           00539         BSF LCD_ENABLE
0B7F   0000           00540         NOP
0B80   0000           00541         NOP
0B81   0000           00542         nop
0B82   0000           00543         nop
0B83   0000           00544         NOP                                     ; ENABLE slespon 450ns v log1
0B84   1006           00545         bcf LCD_ENABLE
0B85   0000           00546         NOP
0B86   0000           00547         NOP
0B87   0000           00548         nop
0B88   0000           00549         nop
0B89   0000           00550         NOP
                      00551         ;bsf LCD_ENABLE
                      00552         PROG_PAGE_0
0B8A   118A               M                         bcf PCLATH,3
0B8B   120A               M                         bcf PCLATH,4
0B8C   21B2           00553         CALL ZPOZ_50US      ; zpozdeni 50 uS na zapis data
                      00554         PROG_PAGE_1
0B8D   158A               M                         bsf PCLATH,3
0B8E   120A               M                         bcf PCLATH,4
0B8F   0008           00555         RETURN
                      00556 ;**********************************************************
1000                  00056  org 0x1000                                     ; PAGE 2
1000   0000           00057         nop                                             ; (aby nas prekladac varoval, az dosahneme teto 
                            stranky)
1800                  00058  org 0x1800                                     ; PAGE 3
1800   0000           00059         nop                                             ; (aby nas prekladac varoval, az dosahneme teto 
                            stranky)
                      00060 ;**********************************************************
                      00061         END
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 76


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESAR1                          00000067
ADRESAR2                          00000068
ADRESAR3                          00000069
ADRESAR4                          0000006A
ADRESH                            0000001E
ADRESL                            0000009E
AKTUALNI_ZAZNAM1                  0000004A
AKTUALNI_ZAZNAM2                  0000004B
AKTUAL_HLAS                       00000027
AUDATA1                           0000006D
AUDATA2                           0000006E
BANK_0                            
BANK_1                            
BANK_2                            
BANK_3                            
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CASOVAC                           00000031
CAS_MP3                           000003F3
CAS_MP3_SHOVEJ_CAS                0000042A
CAS_MP3_ZOBRAZ_CAS                00000404
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 77


SYMBOL TABLE
  LABEL                             VALUE 

CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
CLEAR_BEFFER1__CLEAR              00000812
CLEAR_BEFFER2__CLEAR              00000806
CLEAR_BUFFER1                     0000080C
CLEAR_BUFFER2                     00000800
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
COPY_BUFFER1_TO_2                 00000818
COPY_BUFFER1_TO_2_BYTE            0000081D
COPY_BUFFER2_TO_1                 00000825
COPY_BUFFER2_TO_1_BYTE            0000082A
COUNTER                           00000036
CREN                              00000004
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CZ_INI                            0000003E
CZ_INI_2                          00000041
D                                 00000005
DALSI_ZAZNAM                      000006BB
DATA_ADDRESS                      00000005
DC                                00000001
DELENO10                          00000438
DELENO10_LOOP                     0000043B
DLNAZEV_JEDLOUHYNAZEV             0000089A
DLNAZEV_NENIDLOUHYNAZEV           0000085C
DLNAZEV_PRIJEM                    00000847
DLNAZEV_PRIJEM_2                  00000870
DLNAZEV_PRIJEM_3                  00000889
D_A                               00000005
EEADR                             0000010D
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 78


SYMBOL TABLE
  LABEL                             VALUE 

EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EKVALIZER                         0000003A
END_OF_INTERRUPT                  00000175
F                                 00000001
FERR                              00000002
FREK_11                           00000988
FREK_12                           0000098D
FREK_16                           00000983
FREK_22                           00000979
FREK_24                           0000097E
FREK_32                           00000974
FREK_44.1                         00000966
FREK_48                           0000096F
FREK_8                            00000992
FREK_KHZ                          00000995
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
HLASKA_AUTORI                     0000023A
HLASKA_CHYBAODDILU                000002F0
HLASKA_DISK                       0000025E
HLASKA_DISKOK                     00000283
HLASKA_NEPODPOROVANY_HDD          00000293
HLASKA_PREPRCAVAC                 00000210
HLASKA_VICODDILU                  000002B9
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INDF_BANK_0                       
INDF_BANK_1                       
INDF_BANK_2                       
INDF_BANK_3                       
INFO                              000008DC
INFO_NR                           0000095C
INFO_R1                           00000957
INFO_RD                           00000961
INIT8B                            00000025
INIT_CONFIG                       00000106
INIT_LCD                          00000010
INIT_PORT                         000000F7
INTCON                            0000000B
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 79


SYMBOL TABLE
  LABEL                             VALUE 

INTE                              00000004
INTEDG                            00000006
INTERRUPT                         0000012B
INTERRUPT_PODSV_BLIK              0000016F
INTERRUPT_PODSV_OFF               0000016D
INTERRUPT_PODSV_ON                00000169
INTF                              00000001
IRP                               00000007
JMENODISKU                        0000030D
LCD_1RADEK                        00000032
LCD_2RADEK                        00000035
LCD_3RADEK                        00000038
LCD_4RADEK                        0000003B
LCD_ENABLE                        PORTB,0
LCD_PODSVICENI                    PORTC,5
LCD_RS                            PORTB,2
LCD_RW                            PORTB,1
LCD_SMAZ_RADEK                    0000002B
MENU                              000009A2
MENU_1                            00000A41
MENU_1POLOZKA                     00000A17
MENU_2                            00000AD2
MENU_2POLOZKA                     00000A1E
MENU_3POLOZKA                     00000A25
MENU_4POLOZKA                     00000A2C
MENU_5POLOZKA                     00000A33
MENU_6POLOZKA                     00000A3A
MENU_ROLOVANI                     000009BB
MENU_SIPKA_DOWN                   00000A11
MENU_SIPKA_UP                     00000A0B
MENU_SIPKY                        000009A3
MINUTY1                           00000034
MINUTY2                           00000035
M_STAV_BASY                       00000B53
M_STAV_EKV                        00000B59
M_STAV_HDD                        00000B58
M_STAV_LCD                        00000B41
M_STAV_LCD_OFF                    00000B4B
M_STAV_LCD_SV                     00000B48
M_STAV_LT                         00000B4E
M_STAV_REPEAT                     00000B6A
M_ZMENA_1POLOZKY                  000009DC
M_ZMENA_1POLOZKY_OFF              000009E6
M_ZMENA_1POLOZKY_SV               000009E3
M_ZMENA_2POLOZKY                  000009E9
M_ZMENA_2POLOZKY_ZAPNI            000009ED
M_ZMENA_3POLOZKY                  000009EF
M_ZMENA_3POLOZKY_NASTAV           000009F4
M_ZMENA_3POLOZKY_ZAPNI            000009F3
M_ZMENA_5POLOZKY                  000009FA
M_ZMENA_5POLOZKY_INC              00000A00
M_ZMENA_5POLOZKY_NASTAV           00000A01
NACTIODDILY                       000001C7
NACTIODDILY_DALSI                 000001E7
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 80


SYMBOL TABLE
  LABEL                             VALUE 

NACTIODDILY_JEDENODDIL            000001D2
NACTIODDILY_NEPLATNY              000001E4
NACTI_DLOUHY_NAZEV                00000832
NASTAVODDIL                       000001ED
NASTAV_STAV                       000004F4
NAVRAT_Z_MENU                     0000099E
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
ODDIL_JE_NACTEN                   000000E0
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PLAY                              000004BA
POMOCNA1                          00000040
POMOCNA2                          00000041
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PREDCHOZI_ZAZNAM                  000006F2
PREHRAVANI                        00000323
PREHRAVANI_NOMENU                 00000378
PREHRAVANI_SMYCKA                 00000353
PREHRAVANI_SMYCKA_DELAY           00000368
PREH_ADR_CL1                      0000002B
PREH_ADR_CL2                      0000002C
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 81


SYMBOL TABLE
  LABEL                             VALUE 

PREH_ADR_CL3                      0000002D
PREH_ADR_CL4                      0000002E
PREH_OBSLUHA_DALSI_MP3            00000476
PREH_OBSLUHA_NENALEZENO           000004A4
PREH_OBSLUHA_NOREWIND             0000046F
PREH_OBSLUHA_PREDCHOZI_MP3        00000472
PREH_OBSLUHA_TLACITEK             0000045D
PREH_SOUB_1                       0000002F
PREH_SOUB_2                       00000030
PREH_STAV0                        00000029
PREH_STAV1                        0000002A
PRETECENI                         00000037
PREVED_ZNAK                       00000203
PREVOD                            0000044B
PREVOD_LOOP                       0000044E
PROCHAZENY_ADR1                   00000046
PROCHAZENY_ADR2                   00000047
PROCHAZENY_ADR3                   00000048
PROCHAZENY_ADR4                   00000049
PROG_PAGE_0                       
PROG_PAGE_1                       
PROG_PAGE_2                       
PROG_PAGE_3                       
PRUZKUMNIK                        0000058F
PRUZKUMNIK_JM_ADRESARE            000005A2
PRUZKUMNIK_JM_ADRESARE_K          000005AB
PRUZKUMNIK_SIPKA_DOWN             000006A1
PRUZKUMNIK_SIPKA_UP               00000686
PRUZKUMNIK_SIPKY                  0000062B
PRUZKUMNIK_TLAC_VYBER             00000641
PRUZKUMNIK_TLAC_ZPET              0000067E
PRUZKUMNIK_VYBER                  00000636
PRUZKUMNIK_VYBRANA_MP3            00000665
PRUZKUMNIK_VYBRANA_SLOZKA         00000650
PRUZKUMNIK_VYPIS                  000005C2
PRUZKUMNIK_VYPIS_INC              00000625
PRUZKUMNIK_VYPIS_KONCIME          00000682
PRUZKUMNIK_VYPIS_PRIJEM           000005DF
PRUZKUMNIK_ZMENA_SLOZKY           0000059C
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 82


SYMBOL TABLE
  LABEL                             VALUE 

RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD_USART                          000001BF
READ_WRITE                        00000002
ROLUJ                             00000381
ROLUJ_INCREMENTUJ                 000003B2
ROLUJ_KONVYP                      0000039D
ROLUJ_KRATKE                      000003AB
ROLUJ_ZACVYP                      00000392
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_W                               00000002
S                                 00000003
SEN                               00000000
SIPKA_2RADEK                      00000729
SIPKA_3RADEK                      00000733
SIPKA_4RADEK                      0000073D
SMAZ_LCD                          00000021
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
START                             000000C4
STATUS                            00000003
STAV                              00000028
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 83


SYMBOL TABLE
  LABEL                             VALUE 

T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TAB_CZ                            0000004A
TEMP_FSR                          00000072
TEMP_PCLATH                       00000073
TEMP_STATUS                       00000071
TEMP_WORKING                      00000070
TEST_TLAC                         000004A8
TEST_TLAC_KONHLAS                 000004B9
TEST_TLAC_MUTE                    000004AC
TEST_TLAC_NO_MUTE                 000004B5
TLACITKA                          00000044
TLACITKA_PRED                     00000045
TL_DOPREDU                        PORTA,3
TL_DOZADU                         PORTA,0
TL_MENU                           PORTE,1
TL_MENU_DOWN                      PORTE,2
TL_MENU_UP                        PORTE,0
TL_PLAY                           PORTA,1
TL_PODSVICENI                     PORTC,4
TL_STOP                           PORTA,2
TL_VOLUME_DOWN                    PORTA,5
TL_VOLUME_UP                      PORTA,4
TMP0                              00000020
TMP1                              00000021
TMP2                              00000023
TMP3                              00000024
TMP4                              00000025
TMP5                              00000026
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 84


SYMBOL TABLE
  LABEL                             VALUE 

TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
USART_PRESKOC                     000001C3
VOLUME_DOWN                       000004DB
VOLUME_DOWN_OK                    000004E4
VOLUME_UP                         000004C2
VOLUME_UP_OK                      000004CB
VTERINY1                          00000032
VTERINY2                          00000033
VYBER_ODDILU                      00000510
VYBER_ODDILU_CEKEJ                00000563
VYBER_ODDILU_JMENO                0000054D
VYBER_ODDILU_POSLEDNI             00000557
VYBER_ODDILU_SIPKA_DOWN           00000589
VYBER_ODDILU_SIPKA_UP             00000583
VYBER_ODDILU_SIPKY                00000558
VYBER_ODDILU_VYPIS                0000052D
VYSLEDEK1                         00000038
VYSLEDEK2                         00000039
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WR_USART                          000001B7
Z                                 00000002
ZAC_ZOB_ADR                       00000043
ZAC_ZOB_SOUB                      00000042
ZAKLADNI_NASTAVENI                000004FC
ZAPISD                            000000A8
ZAPISD2                           00000B70
ZAPISI                            0000008B
ZAZNAM1                           0000006B
ZAZNAM1_CIS1                      00000055
ZAZNAM1_CIS2                      00000056
ZAZNAM1_CL1                       00000051
ZAZNAM1_CL2                       00000052
ZAZNAM1_CL3                       00000053
ZAZNAM1_CL4                       00000054
ZAZNAM1_TYP                       00000050
ZAZNAM2                           0000006C
ZAZNAM2_CIS1                      0000005D
ZAZNAM2_CIS2                      0000005E
ZAZNAM2_CL1                       00000059
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 85


SYMBOL TABLE
  LABEL                             VALUE 

ZAZNAM2_CL2                       0000005A
ZAZNAM2_CL3                       0000005B
ZAZNAM2_CL4                       0000005C
ZAZNAM2_TYP                       00000058
ZAZNAM3_CIS1                      00000065
ZAZNAM3_CIS2                      00000066
ZAZNAM3_CL1                       00000061
ZAZNAM3_CL2                       00000062
ZAZNAM3_CL3                       00000063
ZAZNAM3_CL4                       00000064
ZAZNAM3_TYP                       00000060
ZJISTI_NAZEV_SLOZKY               0000089F
ZJISTI_NAZEV_SLOZKY_ROOT          000008C3
ZMENA_STAVU                       000009CA
ZOBRAZ_HLASITOST                  000003B8
ZOBRAZ_HLASITOST_MUTE             000003E4
ZPOZ_100US                        000001A9
ZPOZ_1S                           0000017D
ZPOZ_20MS                         000001A0
ZPOZ_2MS                          0000018A
ZPOZ_300MS                        00000193
ZPOZ_50US                         000001B2
ZPUSOB                            0000004C
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 86


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0000 : X---XXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXX--------- ---------------- ---------------- ----------------
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX ---------------- ---------------- ----------------
1000 : X--------------- ---------------- ---------------- ----------------
1800 : X--------------- ---------------- ---------------- ----------------
MPASM  5.02                        HLAVNI.ASM   5-7-2006  15:02:12         PAGE 87


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


2000 : -------X-------- ---------------- ---------------- ----------------
2100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
21C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX

All other memory blocks unused.

Program Memory Words Used:  2774
Program Memory Words Free:  5418


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,    91 suppressed

